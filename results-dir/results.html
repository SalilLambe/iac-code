<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>KICS Scan Result</title><style>*{margin:0;padding:0;outline:0;box-sizing:border-box}body{font-family:sans-serif}.container{display:flex;align-items:center;flex-direction:column;margin:5px;border:1px solid #bebebe}.run-info{display:flex;flex-wrap:wrap;border:1px solid #bebebe;margin-top:10px;width:50vw}.run-info>span{flex-basis:50%;text-align:center}.counters{display:flex;flex-direction:row;margin:22px 0}.report-header-footer{display:flex;flex-direction:row;justify-content:space-between;border-bottom:1px solid #bebebe;width:100%;padding:15px 21px;background-color:#503e9e;height:50px;font-weight:700;font-size:14px;color:#fff;cursor:default;user-select:none}.report-header-footer>a{color:inherit;text-decoration:inherit}.report-header-footer>.title{font-size:18px}.report-header-footer>.title>span{color:#000}.report-header-footer>.timestamp{font-weight:400;font-style:italic;opacity:.5}.severity{display:flex;flex-direction:column;cursor:pointer;position:relative;margin:0 22px;align-items:center}.severity>.caption.selected{text-decoration:underline overline}.badge{color:#fff;border:2px solid #e8e8e8;border-radius:50%;cursor:default;user-select:none;padding:3px;font-size:10px;display:flex;align-items:center;justify-content:center;width:30px;height:30px;position:absolute;left:60%;top:50%}.kics-orange{color:#fc6e3a}.kics-orange>svg{fill:#fc6e3a}.kics-orange~.badge{background-color:#503e9e}.kics-purple{color:#503e9e}.kics-purple>svg{fill:#503e9e}.kics-purple~.badge{background-color:#fc6e3a}.severity>.icon>svg{width:80px;height:auto}.severity>.caption{font-size:16px;font-weight:bolder;user-select:none;cursor:default}.separator{border-top:1px solid #979797;opacity:.5;width:95%;margin:22px 0}.query{width:95vw}.query-title{display:flex;align-items:flex-start;flex-direction:column;width:100%}.query-title>h2{display:flex}.query-title>h2>div{width:20px;margin-right:12px;margin-left:-30px}.query>*{margin-left:30px}.query-info{display:flex;flex-direction:column;justify-content:space-between}.query-details{margin:12px 0;display:flex;flex-direction:column;text-align:justify}.query-details>span.query-description-title{font-size:18px;margin-top:5px}.query-details>span.cis-description-text{margin-top:5px}.query-details>span:last-child{font-size:14px}.vulnerable-info{border:1px #969696 solid;border-radius:2px;display:flex;flex-direction:column;margin:6px 9px}.vulnerable-info-header{display:flex;flex-direction:row;justify-content:space-between;margin:6px 9px}.vulnerable-info-details{display:flex;flex-direction:column;margin:6px 9px}.vulnerable-info-details>span>strong{width:5vw}.code-box{display:flex;flex-direction:column;background-color:#503e9e10}.code-line{display:flex;flex-direction:row;align-items:center;height:20px}.code-box>.error{background-color:#fc6e3a50}.code-line>.code-line-counter{font-size:10px;margin-left:9px;margin-right:10vw}.code-line>.code{font-family:monospace;font-size:16px}.kics-message{margin:24px 30vw;text-align:center}.love{color:#503e9d;font-style:italic}.social-networks{display:flex;flex-direction:row;align-items:center;justify-content:center;margin-bottom:24px}.social-networks>a{margin:0 15px}.social-networks>a>div>svg{width:20px;height:20px}.footer-text{font-style:italic;opacity:.5;font-weight:400;width:100%;display:flex;align-self:center;justify-content:center}a.checkmarx,a.checkmarx:visited,a.checkmarx:hover,a.checkmarx:active{cursor:pointer;font-weight:700;text-decoration:underline;color:#fff;opacity:.8}.hide{display:none}summary{cursor:pointer;user-select:none;font-size:18px;font-weight:700}</style><script>function filter(e){const t=document.querySelectorAll("[data-type='severity']");t.forEach(t=>e!=="TOTAL"&&e!==t.getAttribute("data-name")?t.classList.add("hide"):t.classList.remove("hide"));const n=document.querySelectorAll(".severity > .caption");n.forEach(t=>e&&e===t.innerText?t.classList.add("selected"):t.classList.remove("selected"))}</script></head><body><img src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAABAAAAACqCAYAAAAz1T0YAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAFiUAABYlAUlSJPAAAFLcSURBVHhe7b0LfFXVmffPyUlOEnIPIQn3BAuitpDYCtpRuamt9YZU27HWCrSd+lZnuMzbvjPv2xaw08//P1M/Ev5jp7VaLlVr59UiFNtqrVzEzihaCFgvgJCEaxIgObmR5IQk//Vbe+14iAFy2Wvtvc/5fXVz1lp7n5O99zl77/V71vM8axghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhJChEFCvJA5JzZo8LxBMzlZVR2lt2L+xu7M9rKqEEGIM3tsIIYQQQvqGBoA4pnDKgxVJydlFquooJ95/rPhspKFSVQkhxBj5E+/dmpxRNEtVHaX24NOz25urtqkqIYQQQoivSFCvhBBCCCGEEEIIiWFoACCEEEIIIYQQQuIAGgAIIYQQQgghhJA4gAYAQgghhBBCCCEkDojZJICJoawiZIFOSi0okfWkiye7O9sRrkR2567OtnBnpKEy1pPYMQkgISQWYRJAQgghhJC+8b0BIBBMyU5JHz9LCPwJyXhNKShxUtRGztSUd3aEKyOtNXvaW6q2RVpry7s722JiCigaAAghsQgNAIQQQgghfeNLAwCEfmrmpfOS0ybMDA23RvhN0t5Uua2t5fD21sZ9Gztaa8tVs++gAYAQEovQAEAIIYQQ0je+MQCEUgtKUjMn35GWd9WSYGJqtmp2nY72hsrW+j3rmuvfWd8ZCftK8NIAQAiJRWgAIIQQQkgskBlKyb7rE9Puvzy3sOTqURN6+jaNkbbw0eZw5R+r9m38zYd7ftk9bJj4v3943gCA0f6s/OuW6+rMOUlz3d51jTU7VvrFEEADACEkFqEBgBBCCCF+BsJ/0RUzFi+6fMaSzNCFB7+PNtdXPv/hnnWrd29/uD+GAM/OAgDhj05c/iX3aevIOU167tQFoy97sCJn3G1rgyE9wpoQQgghhBBCSGxyRe6o0t/f8Xe7l5TMWnEx8Q/GpucUYdvtdy0+OC49p1g1nxfPGQCQ1C+v6K4X/CT8e2MbArIKrluOmQhUMyGEEEIIIYQQ0icQ/8/efN8WiHrV1G/GZ2QXP/P5r716MSOApwwAaTlT7x815dsVqVmXzlNNviaz8PoVBZO+uZveAIQQQgghhBBCzoct/vsz6n8+bCPA2PTz609PGAAw6p8z+sZVueNvW+elBH9OkJScVWR7A6gmQgghhBBCCCFEglH7x+fevWEo4t8GRoBHrrt9rap+DNcNABgdz5/41a3pI6cvUU0xCbwBskffuEpVCSGEEEIIIYTEORD/g3X7Px/TC4tnXl3Ydzi9qwYAiP+RQvy7MZe/G2SMnL4ECQJVlRBCCCGEEEJInKJD/AMh8gOLS2b+QFXPwTUDgC3+4SKvmuICJAikEYAQQgghhBBC4pesUGqODvFvc9mIwhJMJ6iqPbhiAIhX8W9DIwAhhBBCCCGExCe6xT+A+O8rGaArBoC8CXe9EK/i3wZGACYGJIQQQgghhJD4ITAsEPj+9JsevTx3lPYweE94ACDbf7zE/F8MJAZMTp/QZ3IGQgghhBBCCCGxgxT/M2569K5JJQtUk3GMGgAy8qYvjvVs/wMlZ+xtawPB5Jia+pAQQgghhBBCyLksKZ25fNHlVxvTw0ebw5Wq2IMxAwDi/jMKrl2hqkSBUIgRzAdACCGEEEIIITHL0tJZKxaXzDQWAt4YaQu7agDIGX3DqmBiKke6+yA169J5DAUghBBCCCGEkNjDtPgH75+uLlfFczBiAEjLmboAIldVSR8gFEAVCSGEEEIIIYTEAHdPKl1gWvx3DRvW/fyHe9ap6jkYMQBkFFzPbPcXAaEAGXlXMT8CIYQQQgghhMQA1xQWz/7xtbcbH+g92hSu/M2H5b9U1XPQbgDA6H+8T/nXXzIKrlvOhICEEEIIIYQQ4m+uyB1V+vjcuzeoqjEw+r+6fPt5c+9pNwBw9L//IEcCDCaqSgghhBBCCCHEZ4xLzymG+M8Mmc2BB/G/5t03Vp9v9B8E1KsWIGZzx7sX2955tjXc0VpT3tZ0YOPZSEMVyl2dreGuzvaw2kQSSi0oCQRTssXrtNSMSfOSM4pcS8gXOVNTXnPgyVJV1UrhlAcrkpKztXhnnHj/sWJxzj+WdZIQQnSTP/Herbru47UHn57d3ly1TVUJIYQQQs4B4v/Zm+/bMjY9x6gXvIz7P1C+/ruvb1qomvpEqwGgcMpDQmCad/9va6rcBtHfUrdnfW+x3x8SgsnZSFqYkX/dcl0C+UKY6mDSAEAIiUVoACCEEEKIG7gp/jHy/y87X16qms6LthAAN2L/MeJfd2TzgpOHnpnddHLn6sGIf4D3tdTtXVf9wU+Kxect7Gj/+PyJOhmeM/V+VSSEEEIIIYQQ4nGyQqk5bon/1bu3reyP+AcaDQCfMipi4Tpfe+AXpUK4r1dNjgBDwKlDT8/uEJ+vmrSTmjlpnt+TAXL0nxBCCCGEEBIPuC3+V5dvX6maLooWA0AwlF1kMo4eoh9x87pEJz63Wny+08aF84FkgKmZl85TVd/R0U7xTwghhBBCCIl9AsMCge9Pv+nRy3NHlagmI0D8//DNl5cORPwDLQaAlLTxxsQ/Rv7h9q+qWsHfMeUJkJw+YaYq+o6uSD0NAIQQQgghhJCYRor/GTc9etekEqMzuUH8f2fHpoVr33tjtWrqN1oMAKbc/xGbf7rquTtV1Qi1CAcwkBMAYQCq6DsibbV7VJEQQgghhBDiMzJDKdl3fWLagh/M+FzZz+d+6YVf3/y1rVgeufaOtaL9/rHp5hOle5ElpTOXL7r86iWqaoRwpK3+nj+sn/2bD8sH5Z3u+CwAcP8ffdmDFaqqlVOVz93Z2rB/o6oaIzl9wqz8S766VVW1oTvbtK5ZAOqP/XFp86m3ylTVETBNYzCYnB0MZRUliHJfORI6VQgIXpmDwBkSxfnG64XOO7DPfVdnW7i7sz3M86+f/lwTIB6/G84CQJwilp890ceGRTWfg1+PzQvY5xe/Gfx2zneOQfR9+myksbJbvMoVJKZAn6o/v4f+0il+KzqeRxD+i66YsXjR5TOWXGwO++cPlK8rK9++8miz2YTpXmFp6awVi0tmLldVI9S3nam79+Wn5r5XVz1or3THDQCm5v5vrtu7rv7I5gvOcagTnR1Mm8bq11Y21OxYoaqOo8sAcKryuXmtDfs3qeqgSE4fPyslbcLMpNSCksSUgpLB7CfCQzo7wuLmeHhbpK16D17VKhIFOimh1PySUErhNPFAKhYPqAmDPefRwFOmKxKuhEeI6NxU4DuItNaWs2MzMJLEd4PrQHw/JTq/m1i6PmgAIIMB98IU8exJTpswK5SSPy1RXHfIyaNW9xs8e7o7W8NtLYe3t7dUbfPCfQ/Hlpo1aR7uI+L4ZgZDmUWDPTY+V88Foi4kfjeJSdlFwVD2hJC4Rw/2/EZj/47s+3RbS+X2DvFbUquJx8HvIjXz0jtwH3HqN9Gb9qbKbbWHnpmtqo5wdWHRLIz2X0z496asfNuKst0Di0P3O26I/8NN4YqvvLR+zlANLo4bAPKK7noBc+irqjbcnmfehBeAjgs7Gl0GgOr9T5QO5iEF0Y/kh8NzPnW/0zdJgOSE6Iydqd+zPt47Lfa5RifXZMJOgN81OjStjfs2svP4cexOA8KABitABkusfDfxYADAszYhQf9sMU2n3yobqkG3Nxj9ypvwxRdUddA48XyEME7PmXo/rjed90JcWy3176w707h/kyljgIljw/TLkZbD2+CN2VJvJlGy29jnFfdnnFuT92ic77OtNeWtjQc2+tEgkD36xjL0O1TVM3R0NFY6MaiI30Zm3lWLU+VU6M73r3vjtE5YUjpr+ZKSmYMeeHzuw/K139mxaZGqxjR3Typd8ONrb9c+4B2NU+IfOG4AGHPFsvoEzTdDt0f/bXR7AeBGf/zdR3NU1XF0GQCO7PnRgH5XGN3MGXXDKpNCFMaApprXVsRLhwXoNrAMBtso03zqzdXxPLJhutPQH/z83cS6ASBn9I2r0kdO1x5vCE+R6g9+UqyqjgEj16jLHhpyqOBQvgv7mkvLu2qJaQEH8dZYs2NlZ0SPy6xbx4Z7Rmv9nnXN9e+s13VsbmGLft2GooFi92XgbeKHc27Ce3awHP3rIzkIk1PVAYHw56yC61ak5U41OgW6kwaAm8ZfOu/nc/92SIZZJKX7/8q3rYx1T4ArcgtLf3fHt3apqhGqGusOwe3fqVCLoHp1BAiM9LxPP6Cq2qg78tuFXWdbqlXVNc52NFaJi11bxseEhKSU1sZ9m3Qda3redNE5SHG0c4CHUfOpnf3ORomObO7429YlGhY9OG54qgzPmbYAozEdbTUxmbgQnZaMEVd+K3fMzT/LLPjsPyWnjbkavyu12nXwPYRSC0rSR3z6ARgnhnWfbYvV76IvcM8cMfbWtbnjvvAzeBU5fT0OBT9/NwhF03VPgdHQjtd1Axxb1ug5/6+qagNC9eTB9dd0DbJDfCHgAZDhgAEj0lq9J3Lm+Buq2m9w3eUV3/OH4dmXzjN9P8Tfw3WF48d56Giv2+ekR0Bq5uR5Iy+5d2tq5ic+b/rYcM/AfSxF3C8Q+94uRKla5VvwW0E/JXv0DWX4vZjuq1wMuy+D3xNEaEdb7R4vh9npvDcPlbamQy8P5t6ekTd9ce74O36dnDb2atVkDBh9WurfGfJAFpL5/fusLz47ULf/3gTE/9MLi2Y2Rdoadp88NuB7sx+4IndU6bM3f21LctDM/RVGlb+ePr77rt+v/ZuTrc2O6UFHZwFAbJkqaiNy5kS5V0ajMPLQJTpJqqqFJAPn1En6OwUgHlQFk76x28Qo1oVISs4qggEiZ9xta8+XRM2PQPhnFVy3fNSUb1dkj7mxLGl4ged/RyGxj/guCqc8VCE6CUat6KZBpxIjIfmX3OfZ0ZBo4um78TJylGn0DatUVSsNJ/60xOtJ34ZnTr5DFftNprgv4rrDvV81uQZE28iJX90K0ayahgSEal7x3S+47eGFc5tZeP0K3C/wm1XNviL6Hg2B7RWvuQuRnjt1AZJwoz/j1/PuJgOdwhz9rJxxt6xFH8sPv48LsaT0+hVj03Mc+c0IYRn43ozPP4pcAqopZhiXnlP8+Ny7NwzVUNJfIP6fP1C+/t6XnprbGHHWsOeoAUDcMLXPXd98+m1Hs8sPFScsbxcCIwWq6AsQR6WK5wUPJnR6ICpUk+vgwVkw6Zu7Y+GhiREgGFfQAfPjQ8k2yiDGOdY6MTgePwn/3tjfjZ879n4G900T13TTqZ2rW+q8Hx6FGOyBGG4h/rPEfVFVPQGuKeQTgsFWNQ0KCBG3Deq9wbEVTFq0OyPvKk/t14WQom70jav8eo8G6M/gXkFj7cBITuu/hsHvJF+c4/Rcs/O+6wCj/3d9otTR3wqMAD+b++UNsTRNIMT/szfft8UpQ8nFsMX/d1/ftNBp8Q8cNQAkGhitbm+u8pRLme5EWU5ME2KSzki4ShX7xBb/6BioJs+AfZIdbJ8KG1tcYgTIi+d3oGDUBaMZfuo8Xgi4CaIz7NdOZTT4feG7GapoIf0HosTEdY24/8bq1zwlks8HjCGh1P71O7wo/qOBwXaw15MU/x4VIviOssfctMoP9wqM+nvBM9EJcK+IRe9GncCgqIoXxBb/XhrEGgpXFzrjgdSb7FBKzq8+f78QzP43Argh/lfv3rYS4l81OY5jBgDEsununMD932suiUiSpYpaSEop9Fy21AvR0VazWxU/hpfFvw32zY9GAKvjEhvisjfoPGYL8ePXToxtmIkFN8HeQLTg2PxqNPMLiJs1JUpOHXp6to64f130x23X6+LfZjBGAC+L/2hwbF425nopNMRJYsm7UTd4Pl8sHCfWxD+4PFff4O34jOzix+d8eUNmyDv5jQZKVig1xw3xv7pcbyJFxwwAmKtaFbURaTvpuUzUXUggd6ZG23757WF09jweAH4Q/za2EcAvgtPuuMSauIwGsbL5E8Ux+qwTgxku8FuKRcOMDY7Nj0Yzv4DzmlFwvZHRU2Sm93rcf28u5rbrF/FvMxCh7BfxbwNjrlP5DpzCjuP2029koPh1YMMNklLOr2ViUfyDy0cUaB1ovGJEYen3Z3zuUVX1FYFhgUAsin/gmAHARALAtsZ9G1XRU0TaqrVmxsaUSaroedLzZizGaDRulKrJV+LfBvs6YtxtRuf3HAx+69wOBTx0/dSJscT/vTE3otQX7GDqw9S9E9PrNvjE9T+aC+UB8Ov9EUIZ9w9V7RO/iX+bnLHecUm3BV0sxHFfDN6j+8f5DFSxKv5NcfcnShb6zQgA8f/ja29fc3nuKCPfOcT/d3ZsWmhC/APHpgEcnn3532KKMVXVQsOJrf/sRdfERHFDTcm85POq6jitjfs36Zh2Ssc0gEhamJY7bUFm/mf/Ca6ZSamFpVmFc/4fP4qgpJS8KZj27Gz76Q9Uk6dABzBz5IyYiI/vL/i9Yoqplvo964d1d7apZs9hi/9Y9srojf3d4H7l9jRUOqeaMjkNIAQsph5TVW0g7j98dPNCU89Xp6YBBHKqu66z7UHxjMF1Zy/pOdPux9SnajPfkZx+yee7uloboo+p59jyrlrsV9GK+0RS8ogpZ8Lv/adqco28CfOeTcnwlkeCTnDuk9MmzDrT8O5/uvX81HlvdoKExLTCzs7mmt7XXO6YL/zUi+LfiWkAb5pw6bxLskZOUVVtlIwce7VfpgeE+P/+jJsevXfKZ7RPbQ/Ckbb6f9j2m3terPirsftiQL0OGcSB6nRzxZzEx999NEdVPQXmyM4rvusFVXWc04c3LzxTv3edqjpG4ZQHK5I8fCP2Ah3tDZU1B54o7faY4SmeRv77or2pclvtoWdmq6qnQGch3sR/NLhmTh56ejY6JqrJODqfR7UHn56NKWBVVRvoKOeON+OFVLP/ydJIq75Qtt7Aq23UZQ9VqCqJQ0xdR+cjnp+hTSd3loWPv7JUVY2iWyvEG070hX4w/XNli664erGqagWj3A+8+uv5fzzsTY9um6Wls1YsLplpJPSuvu1M3b0vPzX3vbpqo2HuziUB1OxWdNZg52SgdLTp/dISmMHVNeC5kJnnrYzA8S7+AToQSAyoqp4B7pUjJrg/D7eb4JrJm6DPIBoP4HdkMu7fpPgnBGTlX+varAAwrsXzMxTeN17LxUDcw6TwFKIz8G/XzVujM/HgUDEp/g83hStu2/zEp02Lf+BcEkDNI8mRtlqtcfZDQXfSJIQYqCJxgbS8qxZ7JWYR+RXiXfzbeLET47dcF7qAq6QXDTR+wdTvKHKmptyPcf/E/8CI68b926RxzcsgF4MqkjjH9Gg8pgf82Zwvb/Di9ICmxf9XXlo/52izO96SjhgAkvo5D+9QOOuiO2l/QAylKjpOIJiSpYrEBTCam5I24YKZpk2AjkvO2Nv50I7CSwml4JlB8f8RHGUaHKZ+R3hmna567k5VJcQ4GXlXGXE7jiar4LoVvE9bnlo4F6pK4pjGSFv4+QO7h5RHYKB4cXrAuyeVLjAl/qsa6w65Kf6BIwaABKFMVFEbHW21ceuimBBM9mTug3jCC/MXs+PycXA+vBCiQc+MvskeRS+AgZCaOXmeqd9RU+2OFX6b8o/EFqE0zBhkzoALI3pa7tT7VTXu8ZJ3I3GXsvLXVjRGWo3musL0gDACqKqrXJFbWPrja80MsL1z+vguuP27Kf6BIwaAYJJ+N46uTrM/zIHSpdFDIZiQTA8Al4G7opsPSsQsut1xQSJOuAwj6Uz0gjasU5sZxwudGHpm9A1CAcRvlx3ufgBxkjX6JiMGE8T9t9TtNTriQ0hv4F2HJMqqqp0RY2/hfToKnP/hmZfeoaokjoEYLdv9mpHp56K5ZlTRbLenB7wid1Tpszd/bYuqagMJEP/7ROXWe196ai68LlSzazhiADAxT31Hq7c9ALq69GWJp4XWG5jsqPTGjZjFNiHuG4RQQLbmY399JAezcNQceLIUGWejF7RhHbbBtg3Vr62EUUB9jHbQickqcG/0PSNv+mJ6ZpyfrNE3lPEednGQONHE7wiu/4z7J14hOd1MeB0MbKazz+Naa23Yt7Hp5M7VeC6ePrJ5ob2gjgXrTT4ve5OW8ylfTidJnGfNe2+UPf+h2VAAsPDyq5csKTXjet+bcek5xY/PvXtDZkhv4maI/+cPlK+/56X1c7wg/oEj0wBmj76xLGPkdG2xXF6eAtAGmfoTgvp+QDpyIHAawIHRXLd3Xb14cKuqMSAws8fcWKaq2sFxnqnfu36oUzTBMJgphLkJzwXcI0588JNi09M1olPJxH8Xp/7YH5c2n3rL2G/Yb9MAmprZA9dJ7YFflLrt+s9pAImNqf5d7rjb1pl4FsFw3tZ0YGNrw/5NA+m3oQ+ZnF40C2FApr39jv71kRxTz05OA+gsTkwD2BuT0wLaQCB/d8emhc9/WG7MAAHx/+zN920Zm56jtf+GY1vz7hur/2Xny65MvXk+HDEA5I67VdxYp2m7YUXOnCivObCmVFWJQ9AAMDAwv3n1B48Vq6oREoIp2fmTvrHbhMBEx6X+6IsLnRYH6OznSZGs97fWiBGVmh1GRzbdnJIRHefWxgMbz7bVlIvvrArz7nf16sShUxkQv6FQasG0pJSCUrFMg1u+Wm0MHZ2UC+EnAwA6/HnFdxuZNrH++CtLm0/uNGaIOR80AJBoTrz/WLFuo1ThlIdEf0ffcxTPz8ba11c6cW8waTwHJg20NAA4i65n65KSWStMj8qHI231X/nD+jkmpsQzKf5X7962cnX5duPhFRfDEQOA7gvadOcxXvCCAQAPzY622j0RiJjWmnJbwNiWc0yBGC1iUjMmzXPz4WHSUg4Q+587Xv90PYgJ1u0WnCmEcpYQzKrqOG54CunuVPbFmYZ9G0VnbfVgO5roXKaPnL4kJWPyHSavfx0j5+fDLwYAkx4kbnkw9YUXDAC4X0RaDm9rFwsMaB3i+YN2+9lje/UFxb7CEAtDTSht/Ew/GM3het7WuH8TnqudQlhjQfv5nqvJaeNnISEfwqmw3jSnKp+bhxFzVXUcJGnNv+S+rarqOLqen7qfmTYm+9gZedOXJIrfnKo6xvDMSfMSXPr9RoNrD/eUzki46myHfk+r7s62sLh2tEzjt+jyq5f8YMbnjCbyNTE1XlYoNed3d3xzVzyLf+ALA4Do8G46Xfm8a/HXsYpbBgB0vJpPv726+eSbZb1HLPsDOi6pWZfOy8jHdFlm99+kiAEmBKYJ8W+ju0Nj8vsxZZyxcdpDAyJseO60BSY6mABxsOHjrxiZscEvBoCCSd/YbcIjA53S2gNPlg7mfqsDNw0AQx2pFYK5JF2IGLeTsvbGfq6eqdu7brAhg+KYFrjxXNU9Aq0zTFX38xPfSe44vc8ZN4znTuOmZwHuKS3hd9a3Nezb6JV7rFNcnltY8vO5X3pBt1iOBkaAW3/7+JU6YuUDwwIBiP/Lc0dpfe5C/P/wzZeXrn3vjdWqyXM4Mw1gSO/DQlxQ9apIfA6SylV/8JPiRvHAHOyNEu9rEZ0cfA4+TzUbIZhkbrQXSQdjSfwDfO8QgqrqOBilU0XtmEzMCNftk4eeme2kmyw+C99Hzf4nSyEQVbM2hud8ylOCyW0QPmIqHOPUoadnx1rHdKBII8jBp2fjOhqKASfSWlNed2TzAritm7hu+kPTqZ2r7efqYMU/sJ+rYXG/UU1GSEotdHxEOJpQSr6Wzzfx/MR3ovOZCeD5kZSabzw0zO9A+Nv3FBjeYvEeC3f8v/3DL2cfba43dq8bn5FdrGN6QIj/H197+xrd4h+hDN/ZsWmhl8U/cMQAoJvuzrYGVSQ+BRZm3CiHIvz7Ap8nOmPG3Fox+qOK2knL1SuY4BJsUvzbiE7TCl0dZ1MiU3RYS0y5/tcdeXGhzrhtCBoIRN1iBp3M5PQJroXveAm4JJvKHQGRoju+2utgykN4QDjpHYRzioSKHS5mcMdzFfeH8LFXljj5XBWCswyGwS7x+apJKwnBZK2jzzpGhnG/NPX8xDNT93eRlFJIA0A/sa+7oRoT/QLc8WEEeK/uhLF7ndPTA0L8f3/GTY/eNalE66wX9W1n6pDH4DcGkxkOFkcMAMGg3imeujq9MWUCGRxS/IuOkq4bJSzkpkYsAsGULFXUiow5zdI37SA6L0015ud8Bbie4cquqo5iaiQjI+8qI67sGPlvqduzTlW1ATFTV/X8nbo7mSlp4+PeAIC4/5yxtxsJHcEUY24Y+bwERscxYq9jdA73sloYz1wyApwSAkTX/UEaBqt+c6eqakWIT20eADDWqqKjNNWaSziL31nTqbe0jiaaHNzwM+jP6rzuvAqMAF/Y9PNSZLNXTdpxcnpAfA5yGqiqFhC6cO/LT801kcTQCZwJAfBA4g3iXRpO/GmJ7hEojFigs6uq2khKyjQy6qvblR2dFzdHBWEMQuIhVXWU5DT9o8yhNP1zV8NDw2TGdnT4ERutqlpIThtvZM5vLzNi7C1rTXiPwMhn2pXba8hzcExv3gmIs1NVzxkRytHAOIhrVlW1gPu0bvdz3SRqCNvD7wpeJapqBN1Z+pHsUhXJBThd9Zs7dV93XubhnS8vKdttJqmdEKiBfyiZtfyuT5QMybNzaemsFYtL9M5oYCcv9Iv4B74IAaAHgH+BiDH1oIRLlu4RzIBmbxeb1KzJd6ii47jReemLBk1iU7ebuQn3f7c8NGBI02WYAYlxPsqEuH9Tiap0TOnpNxDaoopawXluqDZ3vcqZQAwZB024nycEQ9qeqzo8wjraavaoojHQD9Z6b07KnKCK5DwgnCoeXP4vRln5thUPv2lmTnsYAb4343OrkIxQNQ2Ir19xzRJT4l/nzAU68IkBIL6TF/kZkyIGD8iW+ne0CttAcLgRAwCmZVJFxzHpungh8CDV0bHU6U4KTLixu+mhocswAxCigQzwqhpXmI77j/eOKozPJq8hU/OogwaDnh0m3M91Tj+IcDpVdAy3rq22lsPbVdFxTPVt/AqM8vEeThXNmvfeKLtl08+vNJEcMDuUkvOzOV/eMDZ9YAnn755UuuD702/SOo3hu6erd/tR/IMhGwB03FxJbGC6AwZaG/XMh2oSCAWdYTWi86KtEzFQxPfl+NzPGJ3X6amRmjlJm3cGcNtDQ5dhxiZkIETDawRDOcWm4v47InUV7KiaNT4D3SO0Nvgbpp+rZ+r3+jbeORAMIW9Pt5NLR1utK26+Ha36/q6ppLZ+xSsDJ17i3boTu+/5w1NC/Oo3AmBmgF99/v4tmaH+ac4rcgtLf3ytvmcupvl75/TxXff4VPwDBwwAZlyiif9oa9Qfk98b3eLFBCGN2XjdMMpciLbmw1o6zCFNiZ9AkmY39vYWPedkIOj0pIlHD4Cc0XMfNRL3L8T/qYO/mqOqcUvkzIlyN+5zrY0HHDdo9qYl/I5xMY5zCcOkqvqKllNvr649+PQcJ5eOVnfifDva/BNfHGt4aeDESxxprq+AEcDEDAH9nR7witxRpc/e/LUtquo4EP/PHyhff9tvn/h0Y8S/Ieq+CAEg/qTNpRumFwTUUEhO15coLdLiLbdgXfuTlKJnJgDE/+tOeurW7AzR6PSkCYay4yrWNLPguhU6Z/SIpqnmz3E/5R9obzniyrOnzcCzxy0hIu7VvhRASNiGgQEnF7fCUnX/3XgNz7oYbhkU/QKMALdseuJKEzMEXGx6wHHpOcWPz717Q2ZITz8N4h/H+d3XNxmbflwXNAAQLeCG2e3SQ1LcqKtU0ZckJg0szmkgnGnYp32EaiDgoarDYyMxpOcc6sgoHY1XOhodotOsy5PG1EwaXiAptaA0q/B6rQmIbJpOvVnmheSeXqC9pWqrKhqlM6J3lBxTkLl1f9Dpfk76BxNiu0Ok7SR/+xehe1h3t6kZAs43PSDE/7M337dlbHqOlj4GxP/q3dtW/stOMwkQdUMDANHC2Y5G10S4n6doQU6NpOF6XMzdNMpciE4N+xQIpiDu03GQn0EVteDWyGVv0NHsjDRqERoJIT0PZ3MEAv1ZEPc/YsLdF3VXdAK4/oeP/Smup/yL5mwk7MrzB9eNTlf5sy4+2zgCSuKVjtZq47M++BXMEPDDnS8vU1UtCOEqpwdcdPmMnileryksnm1C/K8uNzMFogloACBa6HSxs9DZ4c9YRaBjyiIbr4jL3nRpGDXTNcocSsnXOsOAWyOXfRFpY6enL/IvuXfLuGn/u+tiy+jLvn3IUGKtbsb9n4uro9UajawdHXqMcv3hbAcNACQ+6exoqFBF0g9+8e4bq3TPEAAjwA9mfH7V3nu/W//63f9QgZh/neL/h2++vDSWxD+gAYBoga5qgyOo0f2/o61mtyp6CtGxdHy0Ttcoc0JQb/y/W3kz+kLXiB+zTTtL/fFXlnF09iPgJq+KrtDVqe/vd7rk2QC6NR4XIV6mq7O9QRVJPzE1QwBi/XUJfwDx/50dmxaufU9/fgPT0ABAtOCmAcBN74OhojMJT0JCSm5y+oTZXlsSk7IcTwqXEAxpEeq6wjMAhIuXQjQw1VV7U9VWHYv6E2SIYFaP5pM7jc0/7we6hEpWRUIIIS5hcoYAHYQjbfX3/GH97N98WB6TuXUC6nXQIGZ5zCf/sV5VtXD68OaFfp6H1qsUTnmwIilZz4izm98ZRPSoyx7S4rLV0d5QWf3BY8Wq6jh5RXe9YCpjeKxzZM+Phnx/i0bn7wpgfu/aQ8/MVlUyBPIn3rs1OaNIa74Gt7Gn/PPj6L+f79EXQ+dvL1afq8Dp+3WsMm7a/+lWRcc58f5jxX71JtJ53dUefHo2Zn9QVTJAAsMCge9Pv2nVoiuuXqyaPA/E/1f+sH7Oe3WxO/XmkD0A6OpNiHMkJCRrdTEngyeo0TsDuBnfS/yHX8U/IYSQ+MHkDAFOcLgpXHHrpsevjGXxD3wRApAQpCgi8YHuGPN4wulwioQEvd+Nm/G9xF801uzgfP+EEEJ8g4kZAoYKxP9XXlo/52izf5OJ9xefGABSKIpIXBAMxc8c6X4joNkQSUFH+kNbU9XWhurXVqgqIcQYH5/uMzGUXYwlKTW/tK8cN04vakcI8SUmZggYLPEk/oEjMVc6Y8mB6OysbKzZwQ6PwzAHwMDRHV+qM74v3nA6njGz4LoVWYXXL1dVx2GcoXPEag4AP8f9R8McAIODOQBMA5FvHXsoffysUErBNFGegNl6YKwPJsaWxx5zAPQNn83OMy49p1jnvP0D5d3T1bvvEeK/MRI/Ye30ACDEI/B3Tgi5EA3HX+WUf4RoJRAIBFNzhudOXZgz7tY1o69YWjfqsgcPjRh325qMkdMXI0lvaHhBSayJf0JM4qUZAv7vgfJ18Sb+gTMGAM1TVwWCKVmqSEjMwlwX3gajQKqoBZ3zhxP/g7j/1ob9G1WVEOIogQBc7PMnfmXL2E8uq4PgT8+duoBCnxA9wAhwy6Ynrlzzrntz7EP8f/f1TQvjTfwDRwwA7LgSQrxGp89mKOnWbEgl/uZMw75NqkgIcY5AVsF1KzDSn3/JV7fEYugQIV7FzRkCynZvWwnxr6pxhyMGgLMdDVqzVyclMTEaIWRgUFCTWCJ37G1rVJEQMmSsEf/CKQ8dyiy8fjlH+glxD8wQYNII8FLV+xvLyrfHdW45f+QACHkjSUQ/QMIYXQshhJA4BXHHGKlUVULIIEGMf17RFzdgxD8pWW9oFyGkf6zes33lz3I/FV4z+uruNaOvGfbRq718VF8bVUd57ZjPikW0jZphtYnXnm1GRb1Pts/oXt8Uifukjs54ADAp0bDUzEvnFU558JCuJTVz8h3qTxFCLkLnWYYlkdgjLe+qxcFQjmsZ7gnxO0mpBaUFk76+C8n8VBMhxAN0dw8bVtvZGW5MGh5oTEod1pCYIpbk7sbE1GGoN4l2We9ZlyLbZTmYLBaxXShNbtOAbcU6+VmhVPF5altRr09M6W4LJsX9wKojBgDdrrZ+sNAmpeaXYEo9XQt9AAjpP12dERoASMwBN+URY7/AUABCBgFc/kdOvJej/oR4kMycwqKM7MKibiBbAsMCgQTxj1XuQiPqAuQOsMuYrROr0Ga9VdbtCjaQi70NPrX06vl/n5ySHtdhP44YAEwk29KdgdvrdHW2N6giIeQidEXqOVUaiUmQpCwj76olqkoI6QepmZPvhMs/Y/0J8R7JqRk5t3z5XzZItS+FvfUqVL6l5LGREPrAKottZDuEvWxXBgFb6Ktt1HpZl1j1jOzRE794f9mWzOzCuNWWjhgAOtpqtc/jGAxle/pL4hRhxAfY98V4WAiJWTIKrlvOUABC+geuFczpr6qEEA+RmTOq+J5v/WLXyMJJJV3dXUKfC5EehWUIsDt2EPtK1EuBL9rFe3o6fQHxZnuRdWv9R+/Di/g8wchRk0u/eP+quDUCWCdoiED8jrrsoQpV1cLpw5sXnqnfu05VPUf+xHu36pw+5sT7jxU7nWuhcMqDFTK8QANufl86f48d7Q2V1R88pqXjrXO/I2dqyptO73RtrlXTdEbCle3Nhx1N8pI9+sayjJHTF6uq41Tvf6K0o1W/MTUe0H0/9gLtTZXbag89M1tVfYVf79H9QedvL1afq+DInh850h/tDQaPRk786la6/V8cHf1MU+i87moPPj27vbkq7pPG6SBv1KTS+fev3pKSmpHd3SXFv6XclX5HWyBBCHa1DpYBuYk0DAQCEPLW5lYbKtHrsU6ithsmPkuUrToMCN1d3eGGExW///X3vniq+sO46n85dsMdc8Wy+gSNrlVNJ3euDh9/xbNuj4WTvrE7aXhBiao6jo6HIw0AA0d353LctP9j3aQcJnLmRHnNgTWlqkoGQWbBdSuyCq9frqqOw06Gc8SDAQCEj/1xadOpt8pU1TfQADA4aAAYOLnjbluXljv1flUlF4AGgL7hs1kPl5V+YcENt//TmmEJUUJdgVAAKfp7r+vqtgwC0gfAQnaabScAsT3a5Xtl3fISUO4DFtLLQG2o6Ozq7Przyz9ZVv7Gc3EzUObYNICdmhMBBsXDRxU9STCUqW3/mNGcDJVAcDjjHoeI7mSnwSSOUJGBwVAAQs5PWs7UBS6Kf0gOHQshvmfG7K+vuGHe/14rBbpQ4pYXPxS5tUDgDwti5F8Je2kQEGWh260GbCN0f896gTIWoMHexn4fUFXbC0BsYn0GloSEYMJ1n3to1YxZC7UN8ngNebKcIK/orhd0TqvitlX/QiQEU7LHfPIf61XVcXSN3tIDYODo/h3q/E50jbDEC8NFZ3LE+NvWqqrj1B/749JmH47mehGdo0HNdXvXdUbCVap6XkIphVNTsyffqara8GMoAD0ABgc9AAZG4ZSHxPPUmGG1GwmxO87UlHe0Ve+JtNXu6Yw0VGJR64cMBsLyL/nqVlV1HHoA9A09ABwkEAjccMc/r5lS+oUFctQ+aoRfeu53dkphLum1DnR3Wl4Bclul/bFKynm8yvVq1B8ghACGBLsddfGKdwai/z7+FY3wHNjz5nNlO17692WyPYZxzANA3DQu2iEaCriJB4LJnhzFxBSAqqgF3SOPxENo/K69ev34Bd3XYaLHE50SCyHA1jfW7FhxsaXu6OZFXZ1t2gzDNuj0clYAQs4Fo/+GxH93W1PVViES51S//9jEk4eenhM+/qelZ+r2roNoPBsJVzq1ILeN+puE+A5k+v/bB9buunTazfdDrXdDmGMFyhilRzkYDGDkXy5oV81dQsBb663Rewh6WRf0fIYsW5+FJissQNQ7xSs+V/0Ne70sw2iA94ptUIaRYNo1X176pW+t2YUpCbFdrOKYASDSWqM9eUIotVCr0B4soRS9+wVLsiqSGOdsh74HPEZwVJEMgrMdekdGAsGULFX0BGJ/shND2cU6Fny2+jMxixD/4bojLy5SVa0wFICQc0nL+ZR21/+OSF0FhD9EP8R+FwdrCOmTjJxRxV96YM2uEaMmlUjXftVuC3cgBXmvBYIcAh2j+Kj2tIm69AKQ77c/Q2xiGw4g9vF3UMYrPADwnmBQtmEbaz/kx1rvQ1m9N3/MpaXzF/z7llg2AjhnAGjR7x6TkjZei3vPUElOHz9TFbUAy68qkhhHiIYGVXScJM2GqlinW/NUnKGUkZ76fkKp+SWjLnvwkI4lq+C6FerPxDStDfs2tjdVaXPZtcHc5iPGfoHTnBEiQOZ/Xe7gNpHW6t21+9dcSddwQi5M3ujJpXf/j3W7MnPHFA3rkt76lgCH4LZH6SHAZRuwhHhPHe+BMLdqUvBbr+dijeyLdXDrl4JegDLaIfZhFMB2altr+6i6erW3Tc8dXXznon9/NQ9GixjEyRCAyi7NyeqS0/QK7cGSqFlYdbRxarB4Qec0cAkMARgSuu9x6LSqoidISNA3qwtGx1Ux5mEoACFmGZ45WVs+KoCR/5MHn57DEX9CLsyU0lsWfOmBdbtSUjKypcAOQpBbRgC5qHh8UREvGH2H2BdVuORDlEP4i/fIbe061tvb9rxHNErhjgz/ok1+JGwAoizj/K31PUYF8XdhHLDeLz5X7UfPtlgHI0DmqOK7H1j7l6nXfFnbFNBu4ZgBAHRGGrWOVKOD47U4ZnTadceZRVqraQCIE5BESBUdJym1cJoqkkGi8x6HUVzd+UQGgs59iScDAAxHjTU7HlZVrTAUgJBhw1IzJ92hilo4dfBXFP+EXISrZn9zxZz531srRbsQ+FJsywWIV2hxrFOiXOh4y0AAAQ6xrsS4jOEHcjuxoIYithXa3VppNUsjgLWNNCDIWQKwGUQ+jAr4LIh91LGd/BzlLYAdEA12XgDZLpZAQkLCtZ/7+1VXzf56TM0Q4KgBoK2larsqaiM1U99MA4NBd1gCpgBkEsD4QWcoTXLaBE+G0PiJSFu11nwcXvqOQqkF2gxG8dZ5bjq5s4yhAIToB7My6XT/xywgfs2UT4gRAoHA7PnfX/uZOYuW2+LcEvMKUZTCHGJbNckQACnIE2SbjNkXZQlEPUb5MWoPIOiFkG9rbwm/tX3Nw1s2/WjRB7t/v14KevWZcltUpfeAKOAz8D78HflqjfBLgwB2TbXJssT6LKsulmAwcNWcb6y49vP/8KhcHQM4agAwkQgw3UBil4GgO9HMWQPnlHgHnW7mXp5Jwy/oDNEAXvLSSEzSF5LQqTmhohcJn3jFyLRCDAUg8YxuL6rmU2+uVkXjBIL6wrIIcYLk1Myc2xf8ZAsy/UN4Q2Rbcf5ClOMVQjshEJBJ/VCG678S2bYxQNbFgsz/XaIq32dvj3bRBvH/3GNfK31ryy9W7Nv9+3VbNvzLgq0bfrRQfob99yDcYTgQdWlwkN4FaBdgtN/+THgGyF2wPl/ut9oOn9RTFp/xqb+5Z+ndD6zblZE9yvfJAZ31AGjcv1EVteGlMAATiWbaWg5r96og3kKnm7nXPGj8hu6Rn9TMSZ74fjCKljS8QGMIgN58MV4EBvKG6tdWqqpWGApA4hWdszJ1tIcrdRuBL0SC6HSqIiGeIyNndPH8b6/fNfqSK2f1iGuIaVG2Xep7jABieyx2rL0syzABJbbxfvUZ8n2qXSI237bxR4uawifO6Y99sPvFdW9t/cVK++/ByCBj+sWrNYsA/hd/WxoDoj4b+yA/XNQFcn/kfsqqfI8E24r2EaMml9y+EDME+NsI4KgBAHGduEGqqjYy86Z7YnTDRCbr9pbDzDAbZ+gMpUlOn+DJRJp+oV3zbCdw4RbfkethALpDEdzsRLtJ86m3ypBATFW1gd9Rzui5MeOqSEh/CWqc7rajrcbVKZl1TzlNyGAZMXpy6e2L/mNLZmbhBEs5Q2jDjV8JelvkwzXfjrW3hbYS4z0J+LBIAa4MBShjQVksb29b83DF+9v7HHB+e+svVr7zX/+5GtvDU8AW79gRfIL8EPH34F3QkxNAeSHIv4X12DZ6kR4C1ufIfRPvz8gZU3TrosdehTFArfAdjhoAQFvj/k2qqI20vKsWu+0FgNH/UJp+McUEgPGHzlAajDB7LQwgNWvyncNzpy50ctGVUd+EkTMr/1rXE82I70SbJ0LkzIm4vafh91N/5PeLVFUrqVmXzsO1paqExAWJoawJqug4nS7H/us0bhAyWKZceduCWxf9x6tpWYUThiVCzAshDb0s4/DxPypisUU2RtzRBOGPhHwQ5lghNLlMwAd/fbTLPACiAWW8TzS/teXJFW+LRVT7RnzEn/9QtvR41e7tPYYGuQjU35f7FAzKfZBx/2pkXxoalMDvaZP7iZ1Q78U6IPYpK3fMRExvOPWzf+vLkDvHDQCtBsIAMLqRVXC9q53ktJxPLdCd/b+9qXIbEwDGHzoTAeLaScuZukBVXQdCPa/o7g0jxt22xslFdAK1XZvi+9EaloOwIl0GjP6Av52WO1VbbpOzHY1VqhiXYN7wppNvlamqVnLG3romEEzOUVVCYp6EBH0GbrdnL0kxMOhEyED49Ny/W3H9F7+/NjmUnt0jsG3RDaksxbsoQ1CrhHuyHeLarsv3CLCNqNgJ/GQYAOoCJOGr2Ld941+2PHnxMDqx/Uu/+l/zmxuqq7rghQBhj8+T0l18JD4TRSnm1d9HGX9fbSux16t9lseBV+QVEKutsIZg4JrPL37003O+6bsZAhw3AKBzo3OubJuMkdOXJKcXzVZVoyC2MqtQvwGC8f/xCeLMdY4yD8+crHWKpIGgaxaNzoi+89fWrD8sJ7PgOtceJroTm3YwsemwxprXVgoxUa+q2pCzAoy7jbMCEOIAyI2iisaBYVZnXhZCBkQgELjmlmWrPj1XCF+I5sSgks1CJKMOFW0LZWuFFNQoQ93LFapuGQXwPrFpjzu+er8oBxISAg2njx7a/psf9dt7LtLaVP/bNd+e09RQU2VPLSj3RZSkQQF/QzSgbO8DgHdCT+JB7IPKSyCR24gF+40i3o/tRP0zc7+x4ppblvgq7M5xAwBoNRAGANwY3QgEU3NGTrx3i6pqpbVxn3ZvCuJNdIbSYITZLeNZb1KznDdGYOpMncn6TCQ7Tc+dusCN7widzOE507R6iDCviTWSWHfkRYYCEOIwCRq9pwLBlCxVNI6JnFOE9Adk+r/16/+x5ZN/c490fYdAlu76UtALZSxH/UWrfBXrILaxoRLhUmDb4h9lIaLlggryAGB7Jazx2hg+XvG7NQ/NbW9rGtDgclP98Yo/Pvu/5kfam8Ly87Bv9v6hrgS9jPEXJbnv0SJflOT+wBAh349trGWYygtgTU1ovWfqZ7+ydP6DT/tmhgAtBoCW+nfWqaJW4IKfP/G+LeaMAIHAiHG3rNHt+g/czjZL3EV3KE32qBtct1RCbEKcqKpj6J46E+IN4Tmqqg03DJzoZOq+vzGviUVrw76N7U1VW1VVK+q3xAzihAyBUMpIV0bg8aw0kXOKkIuBTP/zHnxq16iJn5Hemz3COVrQi6p0k5e6GP9Yrz11LBjtVyP8eC9EufwMbIft1ee1tTeHX3zi23OawscHNahz+vi+3f/1u7Jlcj/xN/H5Qszb+40R/wC8F6ydswwPOB61TRfeg5wFWGevx2dgvxVIWSCNGqItb8ylpbd+46dbMrJHe94IoMUAYCoMAISGF5TACKB7yiOM/OeM+8IaHYKlL0wkUyTeRfc1hOvG7REFXX/fROhMa+MB7dcnhPjICXdtsJ6W+skU34fO2H/AvCbnUnd08yJToQBu580hxARdGsO/QsNHlbhhSMvMu2qxiYEnQi7EiNGXln7hGz/D9HcTbCEPkSwFPEQz2lAUZTkFH9qihHP0glW2az6Q+huvajQedHZ1de3Y8MNFgxX/Nvv/8uLaXdt+8TD2swsfjv3F/sn9sI5BLtgHrLPbsF7so22kQD4BeVxoh1EA26EMsI0iI3dM8S3f+I8tXp8hQIsBADSdemu1KmoHYgZu+ZYRIOpbcAh8br74/PTcEmPJ05pP7TSSJIp4F93XUGbh9cvdCgVIy5m6UJfYNOFi3lK/d50JIyfCNXLG6fYECAQg/k3kNTlDw+Y5IFSlsWbHw6qqFTfz5hASK5iehjo5fcLsdHHtqiohrjD5ytsX3PJNIf5zMLIthK+QvXLBCLkA4rmnDXUljOU/SMSXIBRzMGiN9MMF3zYKyG0g2yC6LaEdCCTIdeVbf/Fw5XvbHPGG/cuWJ1a+8+dny/An5D7Jv2ntp+0ZIPdB7ROS+0kjAbZRS49RA+LfPm61z3hvl228EJ+VkTu2eP6DT+365N/csxhNXkSbAeCM6CCrohFgHR192bcPobPsjCFA/AaDqTkYpcTnwsigVmgHo2Q6Y5iJPzARaz5iwvwNur1nepOUWlCaNVpPCALi/+E9oaraQBiAqWR2yAdQMOmbu3R8T9KzSXwXJsQ/MPGb9htNJ3eWMRSAEGc429GgdZYRk9NQ456fM5ZJPIm7XDn3gRXX3b18bSglM1sKe1sYQ2ahjER5okGOiKMdixDJaJWCGKJfrhP/ScGt2iG45ctH70MZc/Tv2vrkyl2v/vziGf/7i/iTb/z+0WUnDu3aJg0MaBJ/yzJIwMVf1JWhAiP9cl8g7rENXrGv2E9RlKIf5ehzgU+0DQHWm8U5CAauvnnpqivn/p0nve+0GQAgYE3EyfYGnWUI9ryiL27AdGcfGQPspS961knRj3nE8yd+ZcvYTy6rwyiptY05WsJmcigQbxMRAlP3NQTXYHjPQJSrJq1gNEN664i/q5ocpbXxgDGB2VD7unMPp4tgGzhhkHTKwInvomDS13eZGl2iYfP8hE+8skwVtYLfEUMBSCzTpTnEyFQ4DZ7J8tkcA67/6FcnhrKLdS7qT2khlFJQiuelmWX8LCzqT7tLIBCYcev/XFV6gzXF3TnJ+6K7IFLsS01ttatFzuUP44BcDUcAtQ2EMhZ7O7ShDJEtRPWB8hfXOyr+bbq7u1955jvzG+uOVcq/GX0scj/UvmC/ZRsqgqiytAygjvAFeAnIddZ75Su2E4u0IUgDQTBw5Q1/t+LqW5Z5boYA7Ko2xI95Vv4lXzUysnEhImdqyjs7wpWi81mFkTu0wUqcmJQ1AWVM7ZIYypqQmFJQkpTs3vzboCNSV1H9/k8nqqpWCqc8WKHreE8f3rzQtBeIDeaAH3XZQxWq6igd7Q2V1R88ZmzE3OQ11Fj92sqGmh246cp7oMMEhHhdrtugVnvw6dkmPABs8ifeuxVu+qpqjOa6vevaGvf9tq35yLZudU+zkI+nKPB0+gh0LFLSxs/EKJYuI8z5qDuyeUFL3d71qqoVnd+Lrt+YqTAMUHvwmTntzZWuPZtj6R7dG52/vVh9roIje37kSH80I2/6kuwxN65SVW1Yz0sYgXvfc4dKIJAh7s8ZBdcuN32PPvH+Y8U6jLS5425dl5Y7TWt+mVjDqethsIRSM3Pm3vfIhlHFn5klXfgh2KN+6XbPAmP5AVTEOnu1rMqKtU5uY9XEf1iBf8WrGmgPqBF4cOrYvt0vPfmtOZEBZvwfCOk5iNH/2Zb0XCtRn5zBQAAXf7xGY+03jsk6Dht7Q9mGgxHHYG8rD160RR8XOH103+5Xn/mf84ea08ApPnawTuNWB9mvmOwk0wAwcNzoXJq8hnB8TTWvrWypl7/B6HvXIJD3Qyk64caoeyTDpPHMxgtGzr4MnDYwbmLqqlBKQUkwlFlkukNpg1lNqj/4ibHrxo8GAHxX+ZMX7koK5Wo/T7jOaw48UepWQkYaAAYHDQAXx+Q9GYbYxprXH+6UiQej1MGggFfW+FlZ+df+wK0+Mw0A3sFNAwAE8s1/h3j/MarPJnZFTvMnBK34lfcIfCHgAzKRn1WWr9DBWN8p1sEzAO3Rr9haTRmIHqYU1iiI9Y3hY5UvPfHAnOZ6/QJ5xBgkNHx8S1IoPUv2dK2jsIwAoi73CXWxWCWBPN6EAAwG9qsl/MVb0JaI9/ZsLYFHg/WZVntj/bEKHGOTgWO8GNpCAGxMusn6HQgYU+Kf+AfTrua5429bWzjloUMYSUlKzS/FLfqj5UJY28DdD65s2aNvWDX6iqV1ojNmxI2xqebPxu81EIJuhDpFg/wkmJ0kY+T0xRhBjl7QhrAobOOW+Aet4Xd4X7sIMN7UH/n9IlXVCkMBSKxiKjcLsENOkXvKelZCL1zsOWkjtwvAfR3PWoSd4lnJATPiJlL8C2GcnjO2CCP21iKELESs6gbK8Xz8DxGMgr0dRrwBPkhmz8er9T7ZZr83GJSZ9LEeUQF4Q3t7Y9iU+Aenj+3b/cbvHl1q75+doBD7gv2S4/li56x0ADgQbIPjFeC10zpM69gFog25C+xjlecD7fIzYU4QdfFZGeL8fq4nmaK7aDcAWB1kMwmO/I4bAoZ4HzeuIQgEuFEWTv7mLiniRecEnRy4KaOzgjwZ9oI62rEeMeWjpvyPQ+jIQHyaEp1uGs9o5Lww1nezh3lN+gGu9aaTbxmZAYazApBYBIY000ZZGALwrIThHPmn8DzEsxGG8OglNWvynWi3n5eFUx48NOqyBw/hWUvhT9zGGvl/fEvaiDFC/Fuj13IFXiFsrZrCErgQyj0580SbTKqnxK4UyUoQS9GMV7TjVWyHZHzy/eITXn3qO/ObDY+KH3j7t+t2/+nnK6UhIlq8y2z+ar9xTGgXL7LNalTHhBwA6jxhMxyjWGHNKiDWi/fJV7nSfk0Ylpk9pmj2vY9sQIubaDcAAFNzHfsZjv6TC+HmNQQRj84JOjkYVUZnZcS429bYC+pod3Ok2U3jmUnR5kfw3TD5X/9prHltpalrnbMCkFikreXwdlU0Cgzn8MbC8xDPRhjCo5e8ors3oN1+Xrqdc4qQHoQSL7nxW8vTcsYUydFviFVL0Fru+gIpjm1jAMpiHcS/FL7YRr0P28gRdbSr98hFlOVn9by/e9jZrq6ut363aln1obdd8aTc/erjK9/771+vlvsqdx/HrWL3sa/yGFCz9jmQYM0g0HNs9nmS68VibWy1y+MUC15Fa7cKl4CnxIixU0pLb/jWCtTdwogBAJ0/U3Md+5VTB381RxUJ+Ri8hs6PF4xnEG3YD1UlCho2Bw5GMOuOvMhQAEIGSXvLYVfDsggZIlJEmuSSK29fcEnpbV+DaEW2f0vMC4RYtea3F3UhfqXYVSP7MqYfbv9yQ4hd8fxSCQMheDHaLbcVdWkQEJujWZoCUBbs3fLEw++9/sxqfIIriH1488VHllW9u22j8v0X+6iksdpfHIeN3H8l7s/BrotjHZYojlWA84ZX+R6sx+eJFyt8IDDs0s/e8/ehlAzXDPBGDADA5FzHfkMIO46QkYvCa6hPur1gPINoMxW/7Sdo2BwcrQ37Npq61hkKQGINL+RmIcQ3BAKBSz4jxD/i1VFVYl6OXsOdXY5wi7pcKdowQg5PAAhhuS3ErVivRv7laD+2s40BYqWM9Rdby+2xTpTe+/OvVpe/8jP3QyjF7r7+m+WLTh/fVy4PBMei9lEeLzYRByDb7FAB8WodozpWsZEsi4K9ThoD8IpFrhPb4MMTrXOUkpKZc/m19xqZhrkvjBkAAEMBPg5GyBqqX3PVDYT4B1xDHGn+iPrjryzzivEMnU41jSIR0LA5NEw+LxkKQGKNptNvuzeqSIiPSM8eXVRY9JmZEKW24IVOlQtG+GU76hC+QsdCzcNYAFGrtpWvomB7AMipA5VBQYL3iPX2dnXH39+988VHlsqqB4icaazf8tSy+cjObx0TDtg+LgGOyX7FOruuxL08P73XiTf3vF+er4+q2AZvGn/FzNtVi3GMGgDQGTxV+fx8VY17IOQ4QkYGAq6husoN82lIEx28U2+WNZ/c6anY+8bq11ZgaihVjVvw3dCwOTRwrZsK+2EoAIk14EUTaa3eraqEkPOQO2ZKSY9ohUiHsIfQtwW7EqtyZBvbwSgA8AqjgNhEKmCsw7YQvrb4F80ytt6eFUAszaePVWz95T96Tgs21x+r2PLU0vntrc1hefxS3GNwH8eI/9Sx4h+ss49dHKtVjl6sbXrqomzPItBjOBHnJLdwSolbYQBGDQCAo2Q9dMNlmCNkZKBEWmvKw8dfWSaK8h4Sj6BjFz72J89Yj6NpOP7K0njueOLYG6t5j3cCk2E/DAUgsUb4+J/wnIwVpHbotRAyZHJGXTpN/piU+74UtxDzeMWikOIfyDaxICeArFqv8jMwym2/TywQv9hWvop1jXVHD738xDeMTfc3UOqOfbD7v57/wSKIc3mMEO04J/IYgHhF5kNRkrH8EP+CLmvlRyD/gVhjN0vRL7e0PlO+SuMCZhFxZ0pA4wYAgFGyODcCdCPJE4whqk7IgGip27uu7shmxJz3vu3EPBCYJw8+7VnPGeQDOHnwmTnxaASAV9Ppyufnd3W2h1UTGSLhE9LYZwSGApBYIlZmaEE41ZE9P0rovXScqSlXmxAyOAKBQFr2qAn29Hxy5N4e0RYN9gi/FPRKBEsxi9F/eASIuvWvVLdCVcoNJfa2liFg2LDOQHf39l8u+2KzR8W/zeG/bnnhrc2PLO3Zf+m9AM0ujgOvSGiIcwHjgN0m/pev4tThfcAyfqBd/GMbFPCC9+JVGVmSUjKy5IaGccUAAOLYCNCNuGXOi02GCowACKmJp3CAtqaqrRD/XheYthEgnpI2wuBRu3/NlfRqchZ4/DRUv2bkWYlQgMy86a4lJSLEafw+QwvE//nCqdpaqlyZ7pDEGEKG9ox0C10qBb7VbiFEak9dClcro3+Pl0D3MDm6Ld4kXjFNniVw5efZoQDiI/+y+ZF/rJOJ9rzPezueKkOCQhg67FkAes4LyjhuvKINx6lOlsz8j2O3T57czlowu4LlPCDq6rPk51nzLhrHNQMAiDIC2Oc01pEj/16LWyb+BXGONfufvDIOEgN2I6785CHvi38bGAFqxf7GwT2uu7l+7zo/GGb8SvOpt8pMXeOZhdcvT0otKFVVQnwN7sPIteTHZ+SFxD9ob+Z0h2SICB3aHD5RCcEaSLSMAPJV1OUihaoS83ab7M7g1erYSJEs6lbCQGTJt9rtqf+gevf86WcrP3j9aV9pn71/+unKg3/57Tp5jDgOZfCQxg1xOnrapJHAOjcfnSN1bqKWYTAO2HV5rrq7Oz/a1DiuGgAAjADxEM+Mhw+EGkf+idPI5Jqig9Ma3v+CqMbcddTZ2VYPrxmvxvxfDNzjEK4Ro54a0qOp/vDmhRT/+oCIMTnNZO7Y29aoIiG+x06e6ycjwMXEP2hvYRgpGTr1x/ftsVWoXOxeJIR8dII7GAGkxrVUqxT3WLAO26IsR/yj2kTp/dd/tXrvKz/1n8e3UPlvb/63ZXXH3z/Ha8E6duUVIMvW6D5A3WrDIv6JXqSxQJwfUZTnEnWxYf3xD/bgLaZx3QAAkOjoxPuPTYzRUcxuuC1DoMGVU7UR4ijSCFD13HwY02LoOpLXTu3+J6/0u9cMwjVgAFQzBMjng8/phsu/PCZ6NBnBZDxzaHhBSVbBdZzFgcQM6H/5xROgP+IfwDDY0R5myBUZEjWH3pKGJCnc1ai9HOVGXXoACIRYtUf60SCFLl6xKO8AueB90lBgbVd39L3db2/+V18O3gBMD7ht3dL5TXXHpJcEjhsj+ZZxA6dKHa86dpwn6dGPdrGpPIdqUZ4DVsgAzqdoq614a3uktcmVwRNPGAAABEzt/rVXqg6OPMd+xx65hNsy42KJCWBMQyfH70IT107dkc0LY+nawXHUi2OCN4DqhPry+7HvazX7f3EljZpmQTyzKU8ShgKQWEMayr39fOzur/i3aWvcv0kVCRkUEKDVh97eJrPaC2yhK+tylFohBKwc6VYCVy6IB5Bi1rqgPhK3oj96+ljF9l8u8f3U7y31xypeefzrc9rPNIaloE8U5wQHCEGPDVSeA8T34/i7kBxRrrDOkb0OLXLWACw4x6Lx4Nub18t2F/CMAQDAmhk+/selUd4A1gnzHzEzckn8hy00cR35zBDQDXGJmPlqse8tdXtduzHqBN4A1e//dKLPDAHnfDe8r7kDnpHII6Oq2mEoAIk1+jDEegLbsDoQ8Q9ohCVDRsjVv/7xPx6GXrXEv+iSKA0rFzVdHcStHPGW7Ur8Rot/jIwrMdx46mjFq48vmtPi8Yz//aWl7ljFa8qYIY896jz0GEPgIQGDSWKwZ3YAuY1a11PHuRXllvoTFYfe3kQDQDS4Qfuwgwws4X/w6Tkc9Sdu09sQ4OFrSV434eOvLIW4RMx8PMSTRxsC1GwB1vPEW8Tld+NlkPjT1OwSDAUgsYqcRefgr2SSVpefjUMaMIowDwBxAIQBfPDnp1ZbSfyEUBVC3koKKK4LCFuIWFv0Q/TKF1XHNlgwMo6RbqFvX39q8fyW+mMxpYFqDu7c+pff/pucHtDCOg92XQp9vOIfe8Rf0bNOeUzAJeCVxxfNlY0u4UkDgI3dQcZUZ17uIMNy23TyzTJb+Ptmfv+AuNA/OqdOL27T1z4NfbHOma+wDQG22ESyQPxmxSq3jkWeS3S60Pmyr5umkztXx6O4xH0OswXAUOMBY0AsfTf2OXR6cZ26oz1JJfvaP0eXtJHT/yEYyi4SZafp8+8NefHGPfrj++XM4jZ97ZNTi3HwbIRRE9OX4t6LvCai2cT+yL/hxIAR3hdlwBjqogUoQvkSH4s/gRfAKz99uCV8vEq6/gu9aocAyBFr0QD3fznKD+GPBWW0YXQbc+WjLP4VInlZ/bEPYtIz5YMdvyx7548/XYnzYX3h6rULpwRlceIg/qVnhL0Op8kqAxhZ/vv/fn+R2wYSyyThExJDWUWpWZfeMTznU/eHUgtLVLMbxwDRH+44U1Pe1rR/U0vdnvV+FC7iXM4LBJOzVdVRIs1V2wb7QBsqCcGU7JSsyfNU1VG6xffe2rB/o6r6muT0CbNSMyfdEUopnJY4vKAkKM6bWuXkNWXf8zATRmWk+ci2jrbaPeIcbjobYfKi85Egrsvk9KJZyWnjZuL7Sc6YMEutAk59PzH73SSnj5+lSbS6em+LRucx9qZT/B6cnHIslu/Rsfrb0/mdgTN1MlzNdex+ZmrG5DscfC7Ke62ufqNTvzl4F3Vr6MvieZYQTNXS14xV3HoGp40YWzz3gbVb0nLHFuFHK3/0+Ef1FnraBBjMDoj/ZGgAvASEsN31239dum/HL1erTWKWT9704IqpNz24XB47jB+d6hUnyD4fH52oYZZxoHtYe2tD/a6N/7q04u2Nroe4DuWG5iq4SUPAhNImzAyl5k+LMggAJ49L/uztG3dHW/We1sYDmzpaq8vpCktiiVCq6OyITkRSSn6JuL7GJyZlFwUSk7PRFtUJuiAQkt1CLXS2N1ae7aiv6uxorIy01uzh9TJ0or8f0aHKSkzKmSA7VskZsuOXFMrtswOI7wSv9vfS1dUaFiLi8NmOhsqzrTXl6GjwuyGEkI9zvudiQDT2dc9FX7Gr80y493OwvblqO++1xBcItXrlHf+8avJ19y1WLecgxWyn5WkVQEI7obia6w5XvPns9xbVHtwZNyEpxVfdueBTN357edqIMUUyZwKEPtz7JfL0iBuCaJXGke7umkM7t735n99zfeTfxrcGgN6gI5yUWlgibtbTgkmZRdGd44Tg8Oz+CBi7o9zV3iRu2uHK6E4yE60QAsNb36MMHM0nhBBCCIkN0nLHFH3ypoeWj/nk3Hmh1MxsWzFC/EPoQvCeFIK/4q0X1oklJpM29wcYAoo/c8f9BROnz5Tx/ZgFQIh+nK5Ia2O4YufG9UfffXWj14wjMWMA6C99CRiKF0IIIYQQQgg5l5wxl5UMzxldJA0Bgo62pnDNh29u63BpDnuvkjN6SkmSOEcdQvhjesVYS4RICCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIISTWGTbs/weu4URpsmtERgAAAABJRU5ErkJggg==" alt="Checkmarx logo" width="192" height="32"><div class="container"><div class="report-header-footer"><span class="title">KICS <span>REPORT</span></span><span class="timestamp">03/12/2022 09:23</span><a href="https://www.kics.io/" rel="noopener" target="_blank">KICS.IO</a></div><div class="run-info"><span style="flex-basis:100%" id="scan-paths"><strong>KICS v1.5.2</strong></span>
<span style="flex-basis:100%" id="scan-paths"><strong>Scanned paths:</strong> test-cases/terraform/</span>
<span style="flex-basis:100%" id="scan-platforms"><strong>Platforms:</strong> Terraform, Common</span><span id="scan-start-time"><strong>Start time:</strong> 09:22:18, Mar 12 2022</span>
<span id="scan-end-time"><strong>End time:</strong> 09:23:14, Mar 12 2022</span></div><h2 style="margin-top:41px" class="kics-orange">Vulnerabilities:</h2><div class="counters"><div class="severity" onclick="filter('HIGH')"><div class="kics-orange icon"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="badge" id="severity-count-high">618</span>
<span class="caption">HIGH</span></div><div class="severity" onclick="filter('MEDIUM')"><div class="kics-orange icon"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="badge" id="severity-count-medium">320</span>
<span class="caption">MEDIUM</span></div><div class="severity" onclick="filter('LOW')"><div class="kics-purple icon"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="badge" id="severity-count-low">116</span>
<span class="caption">LOW</span></div><div class="severity" onclick="filter('INFO')"><div class="kics-purple icon"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="badge" id="severity-count-info">424</span>
<span class="caption">INFO</span></div><div class="severity" onclick="filter('TOTAL')"><div class="kics-orange icon"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="badge" id="severity-count-total">1478</span>
<span class="caption selected">TOTAL</span></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">AD Admin Not Configured For SQL Server</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">The Active Directory Administrator is not configured for a SQL server</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_active_directory_administrator" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_active_directory_administrator</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/sql_vulnerability_email_not_set/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> A 'azurerm_sql_active_directory_administrator' is defined for 'azurerm_sql_server[sql]'</span>
<span><strong>Found:</strong> A 'azurerm_sql_active_directory_administrator' is not defined for 'azurerm_sql_server[sql]'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_sql_server" "sql" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-sqlserver"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/sql_vulnerability_assessment_not_enabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> A 'azurerm_sql_active_directory_administrator' is defined for 'azurerm_sql_server[sql]'</span>
<span><strong>Found:</strong> A 'azurerm_sql_active_directory_administrator' is not defined for 'azurerm_sql_server[sql]'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_sql_server" "sql" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-sqlserver"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">ALB Listening on HTTP</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">AWS Application Load Balancer (alb) should not listen on HTTP</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/load_balancer_listener_http/main.tf</strong>
<span>Line 70</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'default_action.redirect.protocol' is equal to 'HTTPS'</span>
<span><strong>Found:</strong> 'default_action.redirect.protocol' is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">69</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">70</span><span class="code"> default_action {</span></div><div class="code-line"><span class="code-line-counter">71</span><span class="code"> type = "forward"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 70</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'default_action.redirect.protocol' is equal to 'HTTPS'</span>
<span><strong>Found:</strong> 'default_action.redirect.protocol' is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">69</span><span class="code"> port = 80</span></div><div class="code-line error"><span class="code-line-counter">70</span><span class="code"> default_action {</span></div><div class="code-line"><span class="code-line-counter">71</span><span class="code"> type = "forward"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">AMI Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">AWS AMI Encryption is not enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/ami" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/ami</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 38</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> One of 'rule.ebs_block_device.encrypted' is 'true'</span>
<span><strong>Found:</strong> One of 'rule.ebs_block_device.encrypted' is not 'true'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">37</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">38</span><span class="code"> ebs_block_device {</span></div><div class="code-line"><span class="code-line-counter">39</span><span class="code"> device_name = "/dev/xvda"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">App Service FTPS Enforce Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Azure App Service should only enforce FTPS when 'ftps_state' is enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#ftps_state" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#ftps_state</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/app_service_use_most_recent_supported_tls/main.tf</strong>
<span>Line 36</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].site_config.ftps_state' is not set to 'AllAllowed'</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].site_config.ftps_state' is set to 'AllAllowed'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">35</span><span class="code"> use_32_bit_worker_process = true</span></div><div class="code-line error"><span class="code-line-counter">36</span><span class="code"> ftps_state = "AllAllowed"</span></div><div class="code-line"><span class="code-line-counter">37</span><span class="code"> min_tls_version = 1.1</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">App Service Managed Identity Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Resource Management</span></span></div><div class="query-details"><span class="query-description-title">Azure App Service should have managed identity enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#identity" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#identity</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">9</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_lin_java_isnot_latest/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/webapp_client_cert_not_enabled/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/webapp_not_use_managedidentity/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_php_isnot_latest/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/app_service_authentication_missing/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/app_service_use_most_recent_supported_tls/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_win_java_isnot_latest/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_http2_not_enabled/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/app_service_ftps_unused/main.tf</strong>
<span>Line 36</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">35</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">36</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">37</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">App Service Not Using Latest TLS Encryption Version</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Ensure App Service is using the latest version of TLS encryption</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#min_tls_version" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#min_tls_version</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/app_service_use_most_recent_supported_tls/main.tf</strong>
<span>Line 37</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].site_config.min_tls_version' is set to '1.2'</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].site_config.min_tls_version' is not set to '1.2'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">36</span><span class="code"> ftps_state = "AllAllowed"</span></div><div class="code-line error"><span class="code-line-counter">37</span><span class="code"> min_tls_version = 1.1</span></div><div class="code-line"><span class="code-line-counter">38</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Athena Database Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">AWS Athena Database data in S3 should be encrypted</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_database#encryption_configuration" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_database#encryption_configuration</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/athena_not_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_athena_database[{{hoge}}] encryption_configuration is defined</span>
<span><strong>Found:</strong> aws_athena_database[{{hoge}}] encryption_configuration is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_athena_database" "hoge" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "database_name"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Athena Workgroup Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Athena Workgroup query results should be encrypted, for all queries that run in the workgroup</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_workgroup#encryption_configuration" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_workgroup#encryption_configuration</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workgroups_non_encrypted/main.tf</strong>
<span>Line 52</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_athena_workgroup[{{cloudrail_wg_2}}].configuration.result_configuration.encryption_configuration is defined</span>
<span><strong>Found:</strong> aws_athena_workgroup[{{cloudrail_wg_2}}].configuration.result_configuration.encryption_configuration is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">51</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">52</span><span class="code"> result_configuration {</span></div><div class="code-line"><span class="code-line-counter">53</span><span class="code"> output_location = "s3://{aws_s3_bucket.cloudrail_anthena_bucket_2.bucket}/output/"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workgroups_non_encrypted/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_athena_workgroup[{{cloudrail_wg}}].configuration.result_configuration.encryption_configuration is defined</span>
<span><strong>Found:</strong> aws_athena_workgroup[{{cloudrail_wg}}].configuration.result_configuration.encryption_configuration is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code"> result_configuration {</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> output_location = "s3://{aws_s3_bucket.cloudrail_anthena_bucket.bucket}/output/"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Authentication Without MFA</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 1.10</sub></span>
<span class="query-description-title">Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</span>
<span class="cis-description-text">Multi-Factor Authentication (MFA) adds an extra layer of authentication assurance beyond traditional credentials. With MFA enabled, when a user signs in to the AWS Console, they will be prompted for their user name and password as well as for an authentication code from their physical or virtual MFA token. It is recommended that MFA be enabled for all accounts that have a console password.
Enabling MFA provides increased security for console access as it requires the authenticating principal to possess a device that displays a time-sensitive key and have knowledge of a credential.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/iam_user_inline_policy_attach/main.tf</strong>
<span>Line 13</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attributes 'policy.Statement.Condition', 'policy.Statement.Condition.BoolIfExists', and 'policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent' are defined and not null</span>
<span><strong>Found:</strong> The attribute(s) 'policy.Statement.Condition' or/and 'policy.Statement.Condition.BoolIfExists' or/and 'policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent' is/are undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">12</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">13</span><span class="code"> policy = &lt;&lt;EOF</span></div><div class="code-line"><span class="code-line-counter">14</span><span class="code">{</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Azure App Service Client Certificate Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">Azure App Service client certificate should be enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#client_cert_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#client_cert_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">9</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/webapp_client_cert_not_enabled/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].client_cert_enabled' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].client_cert_enabeld' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_win_java_isnot_latest/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].client_cert_enabled' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].client_cert_enabeld' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/app_service_authentication_missing/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].client_cert_enabled' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].client_cert_enabeld' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/app_service_ftps_unused/main.tf</strong>
<span>Line 36</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].client_cert_enabled' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].client_cert_enabeld' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">35</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">36</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">37</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/webapp_not_use_managedidentity/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].client_cert_enabled' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].client_cert_enabeld' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/app_service_use_most_recent_supported_tls/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].client_cert_enabled' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].client_cert_enabeld' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_php_isnot_latest/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].client_cert_enabled' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].client_cert_enabeld' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_http2_not_enabled/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].client_cert_enabled' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].client_cert_enabeld' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_lin_java_isnot_latest/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].client_cert_enabled' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].client_cert_enabeld' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">CMK Rotation Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 3.8</sub></span>
<span class="query-description-title">Ensure rotation for customer created CMKs is enabled</span>
<span class="cis-description-text">AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled.
Rotating encryption keys helps reduce the potential impact of a compromised key as data encrypted with a new key cannot be accessed with a previous key that may have been exposed.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key#enable_key_rotation" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key#enable_key_rotation</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/policy_missing_principal/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_kms_key[secure_policy].enable_key_rotation is set to true</span>
<span><strong>Found:</strong> aws_kms_key[secure_policy].enable_key_rotation is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_kms_key" "secure_policy" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> description = "KMS key + secure_policy"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/kms_key_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_kms_key[not_secure_policy].enable_key_rotation is set to true</span>
<span><strong>Found:</strong> aws_kms_key[not_secure_policy].enable_key_rotation is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_kms_key" "not_secure_policy" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> description = "KMS key + not_secure_policy"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/kms_uses_rotation/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_kms_key[a].enable_key_rotation is set to true</span>
<span><strong>Found:</strong> aws_kms_key[a].enable_key_rotation is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_kms_key" "a" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> description = "KMS key 1"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> deletion_window_in_days = 10</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">CloudFront Without Minimum Protocol TLS 1.2</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">CloudFront Minimum Protocol version should be at least TLS 1.2</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 76</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_cloudfront_distribution[s3_distribution].viewer_certificate.cloudfront_default_certificate' is 'false'</span>
<span><strong>Found:</strong> resource.aws_cloudfront_distribution[s3_distribution].viewer_certificate.cloudfront_default_certificate' is 'true'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">75</span><span class="code"> viewer_certificate {</span></div><div class="code-line error"><span class="code-line-counter">76</span><span class="code"> cloudfront_default_certificate = true</span></div><div class="code-line"><span class="code-line-counter">77</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudfront_distribution_without_logging/main.tf</strong>
<span>Line 109</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_cloudfront_distribution[s3_distribution].viewer_certificate.cloudfront_default_certificate' is 'false'</span>
<span><strong>Found:</strong> resource.aws_cloudfront_distribution[s3_distribution].viewer_certificate.cloudfront_default_certificate' is 'true'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">108</span><span class="code"> viewer_certificate {</span></div><div class="code-line error"><span class="code-line-counter">109</span><span class="code"> cloudfront_default_certificate = true</span></div><div class="code-line"><span class="code-line-counter">110</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudfront_not_using_waf/main.tf</strong>
<span>Line 115</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_cloudfront_distribution[s3_distribution].viewer_certificate.cloudfront_default_certificate' is 'false'</span>
<span><strong>Found:</strong> resource.aws_cloudfront_distribution[s3_distribution].viewer_certificate.cloudfront_default_certificate' is 'true'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">114</span><span class="code"> viewer_certificate {</span></div><div class="code-line error"><span class="code-line-counter">115</span><span class="code"> cloudfront_default_certificate = true</span></div><div class="code-line"><span class="code-line-counter">116</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_protocol_version_is_low/main.tf</strong>
<span>Line 129</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_cloudfront_distribution[s3_distribution].viewer_certificate.cloudfront_default_certificate' is 'false'</span>
<span><strong>Found:</strong> resource.aws_cloudfront_distribution[s3_distribution].viewer_certificate.cloudfront_default_certificate' is 'true'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">128</span><span class="code"> viewer_certificate {</span></div><div class="code-line error"><span class="code-line-counter">129</span><span class="code"> cloudfront_default_certificate = true</span></div><div class="code-line"><span class="code-line-counter">130</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">CloudTrail Log Files Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 3.7</sub></span>
<span class="query-description-title">Ensure CloudTrail logs are encrypted at rest using KMS CMKs</span>
<span class="cis-description-text">AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS.
Configuring CloudTrail to use SSE-KMS provides additional confidentiality controls on log data as a given user must have S3 read permission on the corresponding log bucket and must be granted decrypt permission by the CMK policy.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#kms_key_id" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#kms_key_id</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudtrail_not_encrypted/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[foobar].kms_key_id is defined and not null</span>
<span><strong>Found:</strong> aws_cloudtrail[foobar].kms_key_id is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudtrail_enabled_on_multi_region/main.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[foobar].kms_key_id is defined and not null</span>
<span><strong>Found:</strong> aws_cloudtrail[foobar].kms_key_id is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"> name = "tf-trail-foobar"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudtrail_file_log_validation_disabled/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[foobar].kms_key_id is defined and not null</span>
<span><strong>Found:</strong> aws_cloudtrail[foobar].kms_key_id is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = local.name</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">CloudTrail Log Files S3 Bucket with Logging Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">CloudTrail Log Files S3 Bucket should have 'logging' enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#s3_bucket_name" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#s3_bucket_name</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudtrail_enabled_on_multi_region/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[foo] has 'logging' defined</span>
<span><strong>Found:</strong> aws_s3_bucket[foo] does not have 'logging' defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> bucket = "tf-test-trail"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudtrail_file_log_validation_disabled/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[foo] has 'logging' defined</span>
<span><strong>Found:</strong> aws_s3_bucket[foo] does not have 'logging' defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudtrail_not_encrypted/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[foo] has 'logging' defined</span>
<span><strong>Found:</strong> aws_s3_bucket[foo] does not have 'logging' defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> bucket = local.name</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">CloudWatch Log Group Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">AWS CloudWatch Log groups should be encrypted using KMS</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudwatch_groups_not_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'kms_key_id' is set</span>
<span><strong>Found:</strong> Attribute 'kms_key_id' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_cloudwatch_log_group" "cloudrail-test" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> retention_in_days = 1</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudwatch_log_groups_no_retention/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'kms_key_id' is set</span>
<span><strong>Found:</strong> Attribute 'kms_key_id' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_cloudwatch_log_group" "yada" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "Yada"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">CodeBuild Project Encrypted With AWS Managed Key</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">CodeBuild Project should be encrypted with customer-managed KMS keys instead of AWS managed keys</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/codebuild_project#encryption_key" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/codebuild_project#encryption_key</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/codbuild_using_aws_key/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> CodeBuild Project is not encrypted with AWS managed key</span>
<span><strong>Found:</strong> CodeBuild Project is encrypted with AWS managed key</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"> service_role = aws_iam_role.codebuild.arn</span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code"> encryption_key = data.aws_kms_key.by_alias.arn</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"></span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Configuration Aggregator to All Regions Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 3.5</sub></span>
<span class="query-description-title">Ensure AWS Config is enabled in all regions</span>
<span class="cis-description-text">AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. It is recommended AWS Config be enabled in all regions.
The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/config_configuration_aggregator#all_regions" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/config_configuration_aggregator#all_regions</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/config_aggregator_all_regions/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_config_configuration_aggregator[organization].account_aggregation_source.all_regions' is set to true</span>
<span><strong>Found:</strong> 'aws_config_configuration_aggregator[organization].account_aggregation_source.all_regions' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code"> account_aggregation_source {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> account_ids = ["123456789012"]</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">DAX Cluster Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">AWS DAX Cluster should have server-side encryption at rest</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dax_cluster#enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dax_cluster#enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/dax_cluster_not_encrypted/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_dax_cluster.server_side_encryption.enabled is set to true</span>
<span><strong>Found:</strong> aws_dax_cluster.server_side_encryption is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code">resource "aws_dax_cluster" "cloudrail-test" {</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> cluster_name = "non-encrypt"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">DB Instance Publicly Accessible</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">The field 'publicly_accessible' should not be set to 'true' (default is 'false').</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#publicly_accessible" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#publicly_accessible</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 62</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'publicly_accessible' is set to false or undefined</span>
<span><strong>Found:</strong> 'publicly_accessible' is set to true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">61</span><span class="code"> instance_class = "db.t3.micro"</span></div><div class="code-line error"><span class="code-line-counter">62</span><span class="code"> publicly_accessible = true</span></div><div class="code-line"><span class="code-line-counter">63</span><span class="code"> db_subnet_group_name = aws_db_subnet_group.nondefault.name</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">DB Instance Storage Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">The parameter storage_encrypted in aws_db_instance must be set to 'true' (the default is 'false').</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#storage_encrypted" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#storage_encrypted</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rds_without_authentication/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'storage_encrypted' is set to true</span>
<span><strong>Found:</strong> 'storage_encrypted' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_db_instance" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> allocated_storage = 10</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "mysql"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 60</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'storage_encrypted' is set to true</span>
<span><strong>Found:</strong> 'storage_encrypted' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">59</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">60</span><span class="code">resource "aws_db_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">61</span><span class="code"> instance_class = "db.t3.micro"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 113</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'storage_encrypted' is set to true</span>
<span><strong>Found:</strong> 'storage_encrypted' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">112</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">113</span><span class="code">resource "aws_db_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">114</span><span class="code"> identifier = "tf-test-db"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rds_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'storage_encrypted' is set to true</span>
<span><strong>Found:</strong> 'storage_encrypted' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_db_instance" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> allocated_storage = 10</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "mysql"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">DOCDB Cluster Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">AWS DOCDB Cluster storage should be encrypted</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#storage_encrypted" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#storage_encrypted</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/docdb_audit_logs_missing/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_docdb_cluster.storage_encrypted is set to true</span>
<span><strong>Found:</strong> aws_docdb_cluster.storage_encrypted is missing</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_docdb_cluster" "docdb" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "my-docdb-cluster"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "docdb"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/docdb_clusters_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_docdb_cluster.storage_encrypted is set to true</span>
<span><strong>Found:</strong> aws_docdb_cluster.storage_encrypted is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_docdb_cluster" "docdb" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "my-docdb-cluster"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">DOCDB Cluster Without KMS</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">AWS DOCDB Cluster should be encrypted with a KMS encryption key</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#kms_key_id" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#kms_key_id</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/docdb_cluster_encrypted_without_kms_key/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_docdb_cluster.kms_key_id is defined and not null</span>
<span><strong>Found:</strong> aws_docdb_cluster.kms_key_id is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_docdb_cluster" "test1" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "my-docdb-cluster-test1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/docdb_audit_logs_missing/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_docdb_cluster.kms_key_id is defined and not null</span>
<span><strong>Found:</strong> aws_docdb_cluster.kms_key_id is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_docdb_cluster" "docdb" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "my-docdb-cluster"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "docdb"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/docdb_clusters_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_docdb_cluster.kms_key_id is defined and not null</span>
<span><strong>Found:</strong> aws_docdb_cluster.kms_key_id is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_docdb_cluster" "docdb" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "my-docdb-cluster"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">EBS Volume Snapshot Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">The value on AWS EBS Volume Snapshot Encryptation must be true</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/ebs_snapshot#encrypted" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/ebs_snapshot#encrypted</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_ebs_volume[example].encrypted' associated with aws_ebs_snapshot[example_snapshot] is set</span>
<span><strong>Found:</strong> 'aws_ebs_volume[example].encrypted' associated with aws_ebs_snapshot[example_snapshot] is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code">resource "aws_ebs_snapshot" "example_snapshot" {</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> volume_id = aws_ebs_volume.example.id</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">EC2 Instance Has Public IP</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">EC2 Instance should not have a public IP address.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#associate_public_ip_address" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#associate_public_ip_address</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">21</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 149</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is false</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">148</span><span class="code"> instance_type = "t3.nano"</span></div><div class="code-line error"><span class="code-line-counter">149</span><span class="code"> associate_public_ip_address = true</span></div><div class="code-line"><span class="code-line-counter">150</span><span class="code"> vpc_security_group_ids = [aws_security_group.publicly_accessible_sg.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/ec2_without_monitoring/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "aws_instance" "web" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 98</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">97</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">98</span><span class="code">resource "aws_instance" "public-ubuntu-from-data" {</span></div><div class="code-line"><span class="code-line-counter">99</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 80</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">79</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">80</span><span class="code">resource "aws_instance" "example_with_copied_ami" {</span></div><div class="code-line"><span class="code-line-counter">81</span><span class="code"> ami = aws_ami_copy.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ec2_ebs_not_optimized/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "aws_instance" "web" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 141</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is false</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">140</span><span class="code"> instance_type = "t3.nano"</span></div><div class="code-line error"><span class="code-line-counter">141</span><span class="code"> associate_public_ip_address = true</span></div><div class="code-line"><span class="code-line-counter">142</span><span class="code"> vpc_security_group_ids = [aws_security_group.publicly_accessible_sg.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 136</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">135</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">136</span><span class="code">resource "aws_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">137</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 98</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">97</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">98</span><span class="code">resource "aws_instance" "pub_ins" {</span></div><div class="code-line"><span class="code-line-counter">99</span><span class="code"> ami = "${data.aws_ami.ubuntu.id}"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 45</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">44</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">45</span><span class="code">resource "aws_instance" "example_with_new_ami" {</span></div><div class="code-line"><span class="code-line-counter">46</span><span class="code"> ami = aws_ami.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/default_sg_in_new_vpc/main.tf</strong>
<span>Line 31</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">30</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">31</span><span class="code">resource "aws_instance" "ec2" {</span></div><div class="code-line"><span class="code-line-counter">32</span><span class="code"> ami = "ami-07cda0db070313c52"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_rules/main.tf</strong>
<span>Line 61</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">60</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">61</span><span class="code">resource "aws_instance" "ec2" {</span></div><div class="code-line"><span class="code-line-counter">62</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 95</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">94</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">95</span><span class="code">resource "aws_instance" "inst2" {</span></div><div class="code-line"><span class="code-line-counter">96</span><span class="code"> vpc_security_group_ids = [aws_default_security_group.dsg.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 82</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">81</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">82</span><span class="code">resource "aws_instance" "inst1" {</span></div><div class="code-line"><span class="code-line-counter">83</span><span class="code"> vpc_security_group_ids = [aws_default_security_group.dsg.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 134</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is false</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">133</span><span class="code"> instance_type = "t3.nano"</span></div><div class="code-line error"><span class="code-line-counter">134</span><span class="code"> associate_public_ip_address = true</span></div><div class="code-line"><span class="code-line-counter">135</span><span class="code"> vpc_security_group_ids = [aws_security_group.publicly_accessible_sg.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_ec2_to_default_vpc/main.tf</strong>
<span>Line 49</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">48</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">49</span><span class="code">resource "aws_instance" "t2-instance" {</span></div><div class="code-line"><span class="code-line-counter">50</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 106</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">105</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">106</span><span class="code">resource "aws_instance" "priv_ins" {</span></div><div class="code-line"><span class="code-line-counter">107</span><span class="code"> ami = "${data.aws_ami.ubuntu.id}"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 108</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">107</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">108</span><span class="code">resource "aws_instance" "inst3" {</span></div><div class="code-line"><span class="code-line-counter">109</span><span class="code"> vpc_security_group_ids = [aws_default_security_group.dsg.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 83</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">82</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">83</span><span class="code">resource "aws_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">84</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 87</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">86</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">87</span><span class="code">resource "aws_instance" "test-ec2-instance" {</span></div><div class="code-line"><span class="code-line-counter">88</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_security_group/main.tf</strong>
<span>Line 63</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">62</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">63</span><span class="code">resource "aws_instance" "ec2" {</span></div><div class="code-line"><span class="code-line-counter">64</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 93</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">92</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">93</span><span class="code">resource "aws_instance" "example_with_ami_from_instance" {</span></div><div class="code-line"><span class="code-line-counter">94</span><span class="code"> ami = aws_ami_from_instance.example.id</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">ECS Task Definition Volume Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">AWS ECS Task Definition EFS data in transit between AWS ECS host and AWS EFS server should be encrypted</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_task_definition#transit_encryption" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_task_definition#transit_encryption</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/ecs_task_definition_not_encrypted_in_transit/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecs_task_definition.volume.efs_volume_configuration.transit_encryption value is 'ENABLED'</span>
<span><strong>Found:</strong> aws_ecs_task_definition.volume.efs_volume_configuration.transit_encryption is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code"> efs_volume_configuration {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> file_system_id = aws_efs_file_system.test.id</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">EFS Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Elastic File System (EFS) must be encrypted</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system#encrypted" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system#encrypted</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/ecs_task_definition_not_encrypted_in_transit/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_efs_file_system[test].encrypted' is defined and not null</span>
<span><strong>Found:</strong> aws_efs_file_system[test].encrypted' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_efs_file_system" "test" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> creation_token = "cloudrail-test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/efs_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_efs_file_system[not_secure].encrypted' is defined and not null</span>
<span><strong>Found:</strong> aws_efs_file_system[not_secure].encrypted' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_efs_file_system" "not_secure" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> creation_token = "efs-not-secure"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">EFS With Vulnerable Policy</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">EFS (Elastic File System) policy should avoid wildcard in 'Action' and 'Principal'.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system_policy#policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system_policy#policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/efs_not_secure_policy/main.tf</strong>
<span>Line 16</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_efs_file_system_policy[not_secure_policy].policy does not have wildcard in 'Action' and 'Principal'</span>
<span><strong>Found:</strong> aws_efs_file_system_policy[not_secure_policy].policy has wildcard in 'Action' or 'Principal'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">15</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">16</span><span class="code"> policy = &lt;&lt;POLICY</span></div><div class="code-line"><span class="code-line-counter">17</span><span class="code">{</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">EFS Without KMS</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Elastic File System (EFS) must have KMS Key ID</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system#kms_key_id" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system#kms_key_id</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/ecs_task_definition_not_encrypted_in_transit/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_efs_file_system[test].kms_key_id' is defined'</span>
<span><strong>Found:</strong> aws_efs_file_system[test].kms_key_id' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_efs_file_system" "test" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> creation_token = "cloudrail-test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/efs_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_efs_file_system[not_secure].kms_key_id' is defined'</span>
<span><strong>Found:</strong> aws_efs_file_system[not_secure].kms_key_id' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_efs_file_system" "not_secure" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> creation_token = "efs-not-secure"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">EKS Cluster Encryption Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">EKS Cluster should be encrypted</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#encryption_config" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#encryption_config</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/eks_logging_disabled/main.tf</strong>
<span>Line 19</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'encryption_config' is defined and not null</span>
<span><strong>Found:</strong> 'encryption_config' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">18</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">19</span><span class="code">resource "aws_eks_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">20</span><span class="code"> name = "test"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Function App Authentication Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Azure Function App authentication settings should be enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#auth_settings" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#auth_settings</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">9</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/func_app_ftps_not_required/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].auth_settings' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].auth_settings' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code">}</span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_python_isnot_latest/main.tf</strong>
<span>Line 37</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].auth_settings' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].auth_settings' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">36</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">37</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">38</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_latest_tls/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].auth_settings' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].auth_settings' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_win_java_isnot_latest/main.tf</strong>
<span>Line 46</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].auth_settings' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].auth_settings' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">45</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">46</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">47</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_http2/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].auth_settings' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].auth_settings' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/func_app_authentication/main.tf</strong>
<span>Line 51</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].auth_settings.enabled' is set to true</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].auth_settings.enabled' is not set to true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">50</span><span class="code"> auth_settings {</span></div><div class="code-line error"><span class="code-line-counter">51</span><span class="code"> enabled = false</span></div><div class="code-line"><span class="code-line-counter">52</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/func_app_client_cert_optional/main.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].auth_settings' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].auth_settings' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/functionapp_not_use_managedidentity/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].auth_settings' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].auth_settings' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_lin_java_isnot_latest/main.tf</strong>
<span>Line 37</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].auth_settings' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].auth_settings' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">36</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">37</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">38</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Function App FTPS Enforce Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Azure Function App should only enforce FTPS when 'ftps_state' is enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#ftps_state" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#ftps_state</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">6</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_lin_java_isnot_latest/main.tf</strong>
<span>Line 51</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config.ftps_state' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config.ftps_state' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">50</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">51</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">52</span><span class="code"> linux_fx_version = "JAVA|8"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_latest_tls/main.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config.ftps_state' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config.ftps_state' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> min_tls_version = 1.1</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_python_isnot_latest/main.tf</strong>
<span>Line 51</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config.ftps_state' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config.ftps_state' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">50</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">51</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">52</span><span class="code"> linux_fx_version = "Python|3.8"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_http2/main.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config.ftps_state' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config.ftps_state' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> http2_enabled = false</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/func_app_ftps_not_required/main.tf</strong>
<span>Line 36</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config.ftps_state' is not set to 'AllAllowed'</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config.ftps_state' is set to 'AllAllowed'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">35</span><span class="code"> site_config {</span></div><div class="code-line error"><span class="code-line-counter">36</span><span class="code"> ftps_state = "AllAllowed"</span></div><div class="code-line"><span class="code-line-counter">37</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_win_java_isnot_latest/main.tf</strong>
<span>Line 60</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config.ftps_state' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config.ftps_state' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">59</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">60</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">61</span><span class="code"> java_version = "1.8"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Function App Not Using Latest TLS Encryption Version</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Ensure Function App is using the latest version of TLS encryption</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#min_tls_version" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#min_tls_version</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_latest_tls/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config.min_tls_version' is set to '1.2'</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config.min_tls_version' is not set to '1.2'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"> site_config {</span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code"> min_tls_version = 1.1</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Geo Redundancy Is Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Backup</span></span></div><div class="query-details"><span class="query-description-title">Make sure that on PostgreSQL Geo Redundant Backups is enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/postgresql_log_disconnections_not_enabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server.example.geo_redundant_backup_enabled' is set</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server.example.geo_redundant_backup_enabled' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_postgresql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-postgresql-server"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/postgresql_not_forcing_ssl/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server.example.geo_redundant_backup_enabled' is set</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server.example.geo_redundant_backup_enabled' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_postgresql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-postgresql-server"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/postgresql_log_connections_not_enabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server.example.geo_redundant_backup_enabled' is set</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server.example.geo_redundant_backup_enabled' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_postgresql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-postgresql-server"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/postgresql_logcheckpoints_not_enabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server.example.geo_redundant_backup_enabled' is set</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server.example.geo_redundant_backup_enabled' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_postgresql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-postgresql-server"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">HTTP Port Open</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">The HTTP port is open in a Security Group</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 114</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group.ingress doesn't open the HTTP port (80)</span>
<span><strong>Found:</strong> aws_security_group.ingress opens the HTTP port (80)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">113</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">114</span><span class="code">resource "aws_security_group" "publicly_accessible_sg" {</span></div><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 121</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group.ingress doesn't open the HTTP port (80)</span>
<span><strong>Found:</strong> aws_security_group.ingress opens the HTTP port (80)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">120</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">121</span><span class="code">resource "aws_security_group" "publicly_accessible_sg" {</span></div><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 129</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group.ingress doesn't open the HTTP port (80)</span>
<span><strong>Found:</strong> aws_security_group.ingress opens the HTTP port (80)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">128</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">129</span><span class="code">resource "aws_security_group" "publicly_accessible_sg" {</span></div><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">IAM Database Auth Not Enabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">IAM Database Auth Enabled must be configured to true</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#iam_database_authentication_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#iam_database_authentication_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 60</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'iam_database_authentication_enabled' is set to true</span>
<span><strong>Found:</strong> 'iam_database_authentication_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">59</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">60</span><span class="code">resource "aws_db_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">61</span><span class="code"> instance_class = "db.t3.micro"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 113</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'iam_database_authentication_enabled' is set to true</span>
<span><strong>Found:</strong> 'iam_database_authentication_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">112</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">113</span><span class="code">resource "aws_db_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">114</span><span class="code"> identifier = "tf-test-db"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rds_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'iam_database_authentication_enabled' is set to true</span>
<span><strong>Found:</strong> 'iam_database_authentication_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_db_instance" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> allocated_storage = 10</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "mysql"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rds_without_authentication/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'iam_database_authentication_enabled' is set to true</span>
<span><strong>Found:</strong> 'iam_database_authentication_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_db_instance" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> allocated_storage = 10</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "mysql"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">KMS Key With Vulnerable Policy</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Checks if the policy is vulnerable and needs updating.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/kms_uses_rotation/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_kms_key[a].policy is defined and not null</span>
<span><strong>Found:</strong> aws_kms_key[a].policy is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_kms_key" "a" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> description = "KMS key 1"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> deletion_window_in_days = 10</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/kms_key_not_secure_policy/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_kms_key[not_secure_policy].policy does not have wildcard in 'Action' and 'Principal'</span>
<span><strong>Found:</strong> aws_kms_key[not_secure_policy].policy has wildcard in 'Action' or 'Principal'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code"> policy = &lt;&lt;EOF</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code">{</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Kinesis Not Encrypted With KMS</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">AWS Kinesis Streams and metadata should be protected with KMS</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kinesis_stream" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kinesis_stream</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/cloudwatch_log_destination_insecure_policy/main.tf</strong>
<span>Line 49</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_kinesis_stream[kinesis_for_cloudwatch].encryption_type is set</span>
<span><strong>Found:</strong> aws_kinesis_stream[kinesis_for_cloudwatch].encryption_type is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">48</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">49</span><span class="code">resource "aws_kinesis_stream" "kinesis_for_cloudwatch" {</span></div><div class="code-line"><span class="code-line-counter">50</span><span class="code"> name = "kinesis_for_cloudwatch"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/kinesis_stream_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_kinesis_stream[test_stream].encryption_type is set</span>
<span><strong>Found:</strong> aws_kinesis_stream[test_stream].encryption_type is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_kinesis_stream" "test_stream" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "terraform-kinesis-test"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> shard_count = 1</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">MSSQL Server Public Network Access Enabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">MSSQL Server public network access should be disabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server#public_network_access_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server#public_network_access_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/public_access_sql_db/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mssql_server[my-sql-server].public_network_access_enabled' is set to false</span>
<span><strong>Found:</strong> 'azurerm_mssql_server[my-sql-server].public_network_access_enabled' is set to true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"> administrator_login_password = "4-v3ry-53cr37-p455w0rd"</span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code"> public_network_access_enabled = true</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"></span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/at-rest/sql_encryption_customer_key_not_set/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mssql_server[sql].public_network_access_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_mssql_server[sql].public_network_access_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_mssql_server" "sql" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-sqlserver"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/sql_server_audit_not_used/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mssql_server[sql].public_network_access_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_mssql_server[sql].public_network_access_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "azurerm_mssql_server" "sql" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> name = "${local.resource_prefix}-sqlserver"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/sql-server-ad-admin-not-set/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mssql_server[sql].public_network_access_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_mssql_server[sql].public_network_access_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "azurerm_mssql_server" "sql" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> name = "${local.resource_prefix}-sqlserver"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/sql-server-audit-retention-30/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mssql_server[sql].public_network_access_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_mssql_server[sql].public_network_access_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code">resource "azurerm_mssql_server" "sql" {</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> name = "${local.resource_prefix}-sqlserver"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Memcached Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Check if the Memcached is disabled on the ElastiCache</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#engine" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#engine</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/elasticache_automatic_backup/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_elasticache_cluster[disabled].engine enables Memcached</span>
<span><strong>Found:</strong> resource.aws_elasticache_cluster[disabled].engine doesn't enable Memcached</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"> cluster_id = "cluster"</span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code"> engine = "redis"</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> node_type = "cache.m5.large"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/elasticache_automatic_backup/main.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_elasticache_cluster[default].engine enables Memcached</span>
<span><strong>Found:</strong> resource.aws_elasticache_cluster[default].engine doesn't enable Memcached</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_id = "cluster"</span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code"> engine = "redis"</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"> node_type = "cache.m5.large"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">MySQL SSL Connection Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Make sure that for MySQL Database Server, 'Enforce SSL connection' is enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/mysql_not_forcing_ssl/main.tf</strong>
<span>Line 31</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mysql_server.example.ssl_enforcement_enabled' is equal 'true'</span>
<span><strong>Found:</strong> 'azurerm_mysql_server.example.ssl_enforcement_enabled' is equal 'false'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">30</span><span class="code"> infrastructure_encryption_enabled = false</span></div><div class="code-line error"><span class="code-line-counter">31</span><span class="code"> ssl_enforcement_enabled = false</span></div><div class="code-line"><span class="code-line-counter">32</span><span class="code"> ssl_minimal_tls_version_enforced = "TLS1_2"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">MySQL Server Public Access Enabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">MySQL Server public access should be disabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#public_network_access_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#public_network_access_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/mysql_not_forcing_ssl/main.tf</strong>
<span>Line 33</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mysql_server[example].public_network_access_enabled' is set to false</span>
<span><strong>Found:</strong> 'azurerm_mysql_server[example].public_network_access_enabled' is set to true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">32</span><span class="code"> ssl_minimal_tls_version_enforced = "TLS1_2"</span></div><div class="code-line error"><span class="code-line-counter">33</span><span class="code"> public_network_access_enabled = true</span></div><div class="code-line"><span class="code-line-counter">34</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Neptune Cluster Instance is Publicly Accessible</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Neptune Cluster Instance should not be publicly accessible</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster_instance#publicly_accessible" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster_instance#publicly_accessible</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 82</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_neptune_cluster_instance[neptune_instance].publicly_accessible is set to false</span>
<span><strong>Found:</strong> aws_neptune_cluster_instance[neptune_instance].publicly_accessible is set to true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">81</span><span class="code"> apply_immediately = true</span></div><div class="code-line error"><span class="code-line-counter">82</span><span class="code"> publicly_accessible = true</span></div><div class="code-line"><span class="code-line-counter">83</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Passwords And Secrets - Generic Password</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Common</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Secret Management</span></span></div><div class="query-details"><span class="query-description-title">Query to find passwords and secrets in infrastructure code.</span><span><a href="https://kics.io/" rel="noopener" target="_blank">https://kics.io/</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">33</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/vmss_unmanaged_disks/main.tf</strong>
<span>Line 124</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' admin_password = "Pas1sword1234!"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">123</span><span class="code"> admin_username = "testadmin"</span></div><div class="code-line error"><span class="code-line-counter">124</span><span class="code"> admin_password = "Pas1sword1234!"</span></div><div class="code-line"><span class="code-line-counter">125</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 120</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' password = "password123"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">119</span><span class="code"> username = "admin"</span></div><div class="code-line error"><span class="code-line-counter">120</span><span class="code"> password = "password123"</span></div><div class="code-line"><span class="code-line-counter">121</span><span class="code"> db_subnet_group_name = aws_db_subnet_group.db.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/docdb_clusters_non_encrypted/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' master_password = "mustbeeightchars"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"> master_username = "foo"</span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code"> master_password = "mustbeeightchars"</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> skip_final_snapshot = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workspace_user_volume_not_encrypted_at_rest/main.tf</strong>
<span>Line 34</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' password = "SuperSecretPassw0rd"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">33</span><span class="code"> name = "corp.notexample.com"</span></div><div class="code-line error"><span class="code-line-counter">34</span><span class="code"> password = "SuperSecretPassw0rd"</span></div><div class="code-line"><span class="code-line-counter">35</span><span class="code"> size = "Small"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/at-rest/sql_encryption_customer_key_not_set/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' administrator_login_password = "4-v3ry-53cr37-p455w0rd"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"> administrator_login = "4dm1n157r470r"</span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> administrator_login_password = "4-v3ry-53cr37-p455w0rd"</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_redshift_in_ec2_classic_mode/main.tf</strong>
<span>Line 8</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' master_password = "Test1234"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">7</span><span class="code"> node_type = "dc2.large"</span></div><div class="code-line error"><span class="code-line-counter">8</span><span class="code"> master_password = "Test1234"</span></div><div class="code-line"><span class="code-line-counter">9</span><span class="code"> master_username = "test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/vmss_unmanaged_disks/main.tf</strong>
<span>Line 83</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' admin_password = "Pas1sword1234!"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">82</span><span class="code"> admin_username = "testadmin"</span></div><div class="code-line error"><span class="code-line-counter">83</span><span class="code"> admin_password = "Pas1sword1234!"</span></div><div class="code-line"><span class="code-line-counter">84</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/sql_server_audit_not_used/main.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' administrator_login_password = "4-v3ry-53cr37-p455w0rd"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code"> administrator_login = "4dm1n157r470r"</span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code"> administrator_login_password = "4-v3ry-53cr37-p455w0rd"</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/docdb_audit_logs_missing/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' master_password = "mustbeeightchars"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"> master_username = "foo"</span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code"> master_password = "mustbeeightchars"</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> backup_retention_period = 5</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 106</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' master_password = "Test1234"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">105</span><span class="code"> node_type = "dc2.large"</span></div><div class="code-line error"><span class="code-line-counter">106</span><span class="code"> master_password = "Test1234"</span></div><div class="code-line"><span class="code-line-counter">107</span><span class="code"> master_username = "test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/vm_unmanaged_disks/main.tf</strong>
<span>Line 81</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' admin_password = "Password1234!"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">80</span><span class="code"> admin_username = "testadmin"</span></div><div class="code-line error"><span class="code-line-counter">81</span><span class="code"> admin_password = "Password1234!"</span></div><div class="code-line"><span class="code-line-counter">82</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/vm_public_rdp_nat_opened/main.tf</strong>
<span>Line 110</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' admin_password = "Passw0rd78234!"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">109</span><span class="code"> admin_username = "testadmin"</span></div><div class="code-line error"><span class="code-line-counter">110</span><span class="code"> admin_password = "Passw0rd78234!"</span></div><div class="code-line"><span class="code-line-counter">111</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/docdb_cluster_encrypted_without_kms_key/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' master_password = "mustbeeightchars"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"> master_username = "foo"</span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code"> master_password = "mustbeeightchars"</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> skip_final_snapshot = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rds_without_authentication/main.tf</strong>
<span>Line 8</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' password = "foobarbaz"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">7</span><span class="code"> username = "foo"</span></div><div class="code-line error"><span class="code-line-counter">8</span><span class="code"> password = "foobarbaz"</span></div><div class="code-line"><span class="code-line-counter">9</span><span class="code"> parameter_group_name = "default.mysql5.7"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/vmss_win_diagnostic_log_disabled/main.tf</strong>
<span>Line 55</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' admin_password = "P@55w0rd1234!"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">54</span><span class="code"> instances = 1</span></div><div class="code-line error"><span class="code-line-counter">55</span><span class="code"> admin_password = "P@55w0rd1234!"</span></div><div class="code-line"><span class="code-line-counter">56</span><span class="code"> admin_username = "adminuser"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rds_cluster_encrypt_at_rest_disabled/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' master_password = "cloudrail-TEST-password"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"> master_username = "administrator"</span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> master_password = "cloudrail-TEST-password"</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> skip_final_snapshot = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/mysql_not_forcing_ssl/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' administrator_login_password = "H@Sh1CoR3!"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"> administrator_login = "mysqladminun"</span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> administrator_login_password = "H@Sh1CoR3!"</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"></span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/public_access_sql_db/main.tf</strong>
<span>Line 27</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' administrator_login_password = "4-v3ry-53cr37-p455w0rd"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">26</span><span class="code"> administrator_login = "4dm1n157r470r"</span></div><div class="code-line error"><span class="code-line-counter">27</span><span class="code"> administrator_login_password = "4-v3ry-53cr37-p455w0rd"</span></div><div class="code-line"><span class="code-line-counter">28</span><span class="code"> public_network_access_enabled = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workspace_root_volume_not_encrypted_at_rest/main.tf</strong>
<span>Line 34</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' password = "SuperSecretPassw0rd"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">33</span><span class="code"> name = "corp.notexample.com"</span></div><div class="code-line error"><span class="code-line-counter">34</span><span class="code"> password = "SuperSecretPassw0rd"</span></div><div class="code-line"><span class="code-line-counter">35</span><span class="code"> size = "Small"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/redshift_not_encrypted/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' master_password = "Mustbe8characters"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"> master_username = "foo"</span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code"> master_password = "Mustbe8characters"</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> node_type = "dc1.large"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/postgresql_logcheckpoints_not_enabled/main.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' administrator_login_password = "H@Sh1CoR3!"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code"> administrator_login = "psqladminun"</span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code"> administrator_login_password = "H@Sh1CoR3!"</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code"> version = "11"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rds_without_logging/main.tf</strong>
<span>Line 8</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' password = "foobarbaz"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">7</span><span class="code"> username = "foo"</span></div><div class="code-line error"><span class="code-line-counter">8</span><span class="code"> password = "foobarbaz"</span></div><div class="code-line"><span class="code-line-counter">9</span><span class="code"> parameter_group_name = "default.mysql5.7"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/sql_vulnerability_assessment_not_enabled/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' administrator_login_password = "4-v3ry-53cr37-p455w0rd"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"> administrator_login = "4dm1n157r470r"</span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> administrator_login_password = "4-v3ry-53cr37-p455w0rd"</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/sql_vulnerability_email_not_set/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' administrator_login_password = "4-v3ry-53cr37-p455w0rd"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"> administrator_login = "4dm1n157r470r"</span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> administrator_login_password = "4-v3ry-53cr37-p455w0rd"</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/postgresql_not_forcing_ssl/main.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' administrator_login_password = "H@Sh1CoR3!"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code"> administrator_login = "psqladminun"</span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code"> administrator_login_password = "H@Sh1CoR3!"</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code"> version = "11"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/sql-server-ad-admin-not-set/main.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' administrator_login_password = "4-v3ry-53cr37-p455w0rd"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code"> administrator_login = "4dm1n157r470r"</span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code"> administrator_login_password = "4-v3ry-53cr37-p455w0rd"</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/postgresql_log_disconnections_not_enabled/main.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' administrator_login_password = "H@Sh1CoR3!"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code"> administrator_login = "psqladminun"</span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code"> administrator_login_password = "H@Sh1CoR3!"</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code"> version = "11"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/postgresql_log_connections_not_enabled/main.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' administrator_login_password = "H@Sh1CoR3!"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code"> administrator_login = "psqladminun"</span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code"> administrator_login_password = "H@Sh1CoR3!"</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code"> version = "11"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/redshift_without_logging/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' master_password = "Mustbe8characters"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"> master_username = "foo"</span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code"> master_password = "Mustbe8characters"</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> node_type = "dc1.large"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/sql-server-audit-retention-30/main.tf</strong>
<span>Line 31</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' administrator_login_password = "4-v3ry-53cr37-p455w0rd"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">30</span><span class="code"> administrator_login = "4dm1n157r470r"</span></div><div class="code-line error"><span class="code-line-counter">31</span><span class="code"> administrator_login_password = "4-v3ry-53cr37-p455w0rd"</span></div><div class="code-line"><span class="code-line-counter">32</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/vmss_public_rdp_lb_opened/main.tf</strong>
<span>Line 79</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' admin_password = "P@55w0rd1234!"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">78</span><span class="code"> instances = 3</span></div><div class="code-line error"><span class="code-line-counter">79</span><span class="code"> admin_password = "P@55w0rd1234!"</span></div><div class="code-line"><span class="code-line-counter">80</span><span class="code"> admin_username = "adminuser"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/vm_public_rdp_lb_opened/main.tf</strong>
<span>Line 117</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' admin_password = "Passw0rd78234!"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">116</span><span class="code"> admin_username = "testadmin"</span></div><div class="code-line error"><span class="code-line-counter">117</span><span class="code"> admin_password = "Passw0rd78234!"</span></div><div class="code-line"><span class="code-line-counter">118</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/docdb_cluster_encrypted_at_rest_using_cmk_not_customer_managed/main.tf</strong>
<span>Line 13</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' master_password = "mustbeeightchars"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">12</span><span class="code"> master_username = "foo"</span></div><div class="code-line error"><span class="code-line-counter">13</span><span class="code"> master_password = "mustbeeightchars"</span></div><div class="code-line"><span class="code-line-counter">14</span><span class="code"> skip_final_snapshot = true</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">PostgreSQL Server Threat Detection Policy Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Resource Management</span></span></div><div class="query-details"><span class="query-description-title">PostgreSQL Server Threat Detection Policy should be enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#threat_detection_policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#threat_detection_policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/postgresql_log_disconnections_not_enabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server[example].threat_detection_policy' is a defined object</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server[example].threat_detection_policy' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_postgresql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-postgresql-server"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/postgresql_logcheckpoints_not_enabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server[example].threat_detection_policy' is a defined object</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server[example].threat_detection_policy' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_postgresql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-postgresql-server"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/postgresql_not_forcing_ssl/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server[example].threat_detection_policy' is a defined object</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server[example].threat_detection_policy' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_postgresql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-postgresql-server"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/postgresql_log_connections_not_enabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server[example].threat_detection_policy' is a defined object</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server[example].threat_detection_policy' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_postgresql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-postgresql-server"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">RDS Storage Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 2.3.1</sub></span>
<span class="query-description-title">Ensure that encryption is enabled for RDS Instances</span>
<span class="cis-description-text">Amazon RDS encrypted DB instances use the industry standard AES-256 encryption algorithm to encrypt your data on the server that hosts your Amazon RDS DB instances. After your data is encrypted, Amazon RDS handles authentication of access and decryption of your data transparently with a minimal impact on performance.
Databases are likely to hold sensitive and critical data, it is highly recommended to implement encryption in order to protect your data from unauthorized access or disclosure. With RDS encryption enabled, the data stored on the instance's underlying storage, the automated backups, read replicas, and snapshots, are all encrypted.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#storage_encrypted" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#storage_encrypted</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rds_cluster_encrypt_at_rest_disabled/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_rds_cluster.storage_encrypted is set to true</span>
<span><strong>Found:</strong> aws_rds_cluster.storage_encrypted is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_rds_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "cloudrail-test-non-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/rds_retention_period_set/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_rds_cluster.storage_encrypted is set to true</span>
<span><strong>Found:</strong> aws_rds_cluster.storage_encrypted is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_rds_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "aurora-cluster-demo"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "aurora-mysql"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Redshift Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Check if 'encrypted' field is false or undefined (default is false)</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#encrypted" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#encrypted</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_redshift_in_ec2_classic_mode/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster.encrypted is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_cluster.encrypted is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_redshift_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "redshift-defaults-only"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/redshift_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster.encrypted is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_cluster.encrypted is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_redshift_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "tf-redshift-cluster"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> database_name = "mydb"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/redshift_not_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster.encrypted is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_cluster.encrypted is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_redshift_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "tf-redshift-cluster"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 103</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster.encrypted is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_cluster.encrypted is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">102</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">103</span><span class="code">resource "aws_redshift_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">104</span><span class="code"> cluster_identifier = "redshift-defaults-only"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Redshift Publicly Accessible</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Check if 'publicly_accessible' field is true or undefined (default is true)</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/redshift_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster.publicly_accessible is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_cluster.publicly_accessible is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_redshift_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "tf-redshift-cluster"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> database_name = "mydb"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/redshift_not_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster.publicly_accessible is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_cluster.publicly_accessible is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_redshift_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "tf-redshift-cluster"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_redshift_in_ec2_classic_mode/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster.publicly_accessible is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_cluster.publicly_accessible is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_redshift_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "redshift-defaults-only"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Remote Desktop Port Open</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">The Remote Desktop port is open in a Security Group</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 121</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[publicly_accessible_sg].ingress doesn't open the remote desktop port (3389)</span>
<span><strong>Found:</strong> aws_security_group[publicly_accessible_sg].ingress opens the remote desktop port (3389)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">120</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">121</span><span class="code">resource "aws_security_group" "publicly_accessible_sg" {</span></div><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 129</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[publicly_accessible_sg].ingress doesn't open the remote desktop port (3389)</span>
<span><strong>Found:</strong> aws_security_group[publicly_accessible_sg].ingress opens the remote desktop port (3389)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">128</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">129</span><span class="code">resource "aws_security_group" "publicly_accessible_sg" {</span></div><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 114</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[publicly_accessible_sg].ingress doesn't open the remote desktop port (3389)</span>
<span><strong>Found:</strong> aws_security_group[publicly_accessible_sg].ingress opens the remote desktop port (3389)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">113</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">114</span><span class="code">resource "aws_security_group" "publicly_accessible_sg" {</span></div><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">S3 Bucket ACL Allows Read Or Write to All Users</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">S3 bucket with public READ/WRITE access</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned/main.tf</strong>
<span>Line 7</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'acl' is equal 'private'</span>
<span><strong>Found:</strong> 'acl' is equal 'public-read'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-1"</span></div><div class="code-line error"><span class="code-line-counter">7</span><span class="code"> acl = "public-read"</span></div><div class="code-line"><span class="code-line-counter">8</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned_with_overriding_access_block/main.tf</strong>
<span>Line 7</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'acl' is equal 'private'</span>
<span><strong>Found:</strong> 'acl' is equal 'public-read-write'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-3"</span></div><div class="code-line error"><span class="code-line-counter">7</span><span class="code"> acl = "public-read-write"</span></div><div class="code-line"><span class="code-line-counter">8</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_protocol_version_is_low/main.tf</strong>
<span>Line 16</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'acl' is equal 'private'</span>
<span><strong>Found:</strong> 'acl' is equal 'public-read-write'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">15</span><span class="code"> bucket = "dist-cloud-test"</span></div><div class="code-line error"><span class="code-line-counter">16</span><span class="code"> acl = "public-read-write"</span></div><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">S3 Bucket ACL Allows Read to Any Authenticated User</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Misconfigured S3 buckets can leak private information to the entire internet or allow unauthorized data tampering / deletion</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#acl" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#acl</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_authenticated_users_canned/main.tf</strong>
<span>Line 7</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[public-bucket].acl is private</span>
<span><strong>Found:</strong> aws_s3_bucket[public-bucket].acl is authenticated-read</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-2"</span></div><div class="code-line error"><span class="code-line-counter">7</span><span class="code"> acl = "authenticated-read"</span></div><div class="code-line"><span class="code-line-counter">8</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">S3 Bucket Access to Any Principal</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">S3 Buckets must not allow Actions From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when there are All Principals</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_policy_public_to_all_authenticated_users/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket_policy[bucket_2_policy].policy.Principal is not equal to, nor does it contain '*'</span>
<span><strong>Found:</strong> aws_s3_bucket_policy[bucket_2_policy].policy.Principal is equal to or contains '*'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> policy = &lt;&lt;POLICY</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code">{</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">S3 Bucket Allows Get Action From All Principals</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">S3 Buckets must not allow Get Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Get, for all Principals.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_policy_public_to_all_authenticated_users/main.tf</strong>
<span>Line 20</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket_policy[bucket_2_policy].policy.Action is not a 'Get' action</span>
<span><strong>Found:</strong> aws_s3_bucket_policy[bucket_2_policy].policy.Action is a 'Get' action</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">19</span><span class="code"> "Principal": {"AWS": "*"},</span></div><div class="code-line error"><span class="code-line-counter">20</span><span class="code"> "Action":["s3:GetObject","s3:GetObjectVersion"],</span></div><div class="code-line"><span class="code-line-counter">21</span><span class="code"> "Resource":["arn:aws:s3:::bucket-with-public-policy-2/*"]</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">S3 Bucket Object Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 2.1.1</sub></span>
<span class="query-description-title">Ensure all S3 buckets employ encryption-at-rest</span>
<span class="cis-description-text">Amazon S3 provides a variety of no, or low, cost encryption options to protect data at rest.
Encrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_object#server_side_encryption" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_object#server_side_encryption</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/s3_bucket_object_non_encrypted/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket_object.server_side_encryption is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket_object.server_side_encryption is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_s3_bucket_object" "object" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> bucket = aws_s3_bucket.cloudrail.id</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">S3 Bucket SSE Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">If algorithm is AES256 then the master key is null, empty or undefined, otherwise the master key is required</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#server_side_encryption_configuration" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#server_side_encryption_configuration</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">19</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workgroups_non_encrypted/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_s3_bucket" "cloudrail_anthena_bucket_2" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> bucket = "cloudrail-wg-encrypted-sse-s3-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_protocol_version_is_low/main.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code">resource "aws_s3_bucket" "dist" {</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code"> bucket = "dist-cloud-test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudfront_not_using_waf/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "b" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "mybucket"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> acl = "private"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_authenticated_users_canned/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudtrail_not_encrypted/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_protocol_version_is_low/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "logging" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "dist-cloud-test-logs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudtrail_file_log_validation_disabled/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/glue_data_catalog_not_secure_policy/main.tf</strong>
<span>Line 33</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">32</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">33</span><span class="code">resource "aws_s3_bucket" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">34</span><span class="code"> bucket = "cloudrail-glue"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/s3_bucket_object_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "cloudrail-non-encrypted-czx7zxchs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/athena_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "hoge" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "hoge"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned_with_overriding_access_block/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-3"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_s3_bucket" "cdn-content" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workgroups_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "cloudrail_anthena_bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "cloudrail-wg-encrypted-sse-s3"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/s3_bucket_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "cloudrail-non-encrypted-czx7zxchs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudtrail_enabled_on_multi_region/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> bucket = "tf-test-trail"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudfront_distribution_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "b" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "mybucket"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> acl = "private"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/s3_access_logging_disabled/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "b" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "my-tf-test-bucket"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> acl = "private"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_policy_public_to_all_authenticated_users/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-policy-2"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">S3 Bucket Without Enabled MFA Delete</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 2.1.3</sub></span>
<span class="query-description-title">Ensure MFA Delete is enable on S3 buckets</span>
<span class="cis-description-text">Once MFA Delete is enabled on your sensitive and classified S3 bucket it requires the user to have two forms of authentication.
Adding MFA delete to an S3 bucket, requires additional authentication when you change the version state of your bucket or you delete and object version adding another layer of security in the event your security credentials are compromised or unauthorized access is granted.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#mfa_delete" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#mfa_delete</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">19</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/s3_access_logging_disabled/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[b].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[b].versioning is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "b" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "my-tf-test-bucket"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> acl = "private"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_policy_public_to_all_authenticated_users/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[public-bucket].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[public-bucket].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-policy-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workgroups_non_encrypted/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[cloudrail_anthena_bucket_2].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[cloudrail_anthena_bucket_2].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_s3_bucket" "cloudrail_anthena_bucket_2" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> bucket = "cloudrail-wg-encrypted-sse-s3-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_authenticated_users_canned/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[public-bucket].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[public-bucket].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[public-bucket].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[public-bucket].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudtrail_file_log_validation_disabled/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[foo].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[foo].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudtrail_enabled_on_multi_region/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[foo].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[foo].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> bucket = "tf-test-trail"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudtrail_not_encrypted/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[foo].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[foo].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/s3_bucket_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[cloudrail].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[cloudrail].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "cloudrail-non-encrypted-czx7zxchs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/athena_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[hoge].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[hoge].versioning is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "hoge" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "hoge"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudfront_distribution_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[b].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[b].versioning is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "b" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "mybucket"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> acl = "private"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workgroups_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[cloudrail_anthena_bucket].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[cloudrail_anthena_bucket].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "cloudrail_anthena_bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "cloudrail-wg-encrypted-sse-s3"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[cdn-content].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[cdn-content].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_s3_bucket" "cdn-content" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudfront_not_using_waf/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[b].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[b].versioning is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "b" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "mybucket"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> acl = "private"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/glue_data_catalog_not_secure_policy/main.tf</strong>
<span>Line 33</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[cloudrail].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[cloudrail].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">32</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">33</span><span class="code">resource "aws_s3_bucket" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">34</span><span class="code"> bucket = "cloudrail-glue"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_protocol_version_is_low/main.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[dist].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[dist].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code">resource "aws_s3_bucket" "dist" {</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code"> bucket = "dist-cloud-test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/s3_bucket_object_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[cloudrail].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[cloudrail].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "cloudrail-non-encrypted-czx7zxchs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned_with_overriding_access_block/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[public-bucket].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[public-bucket].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-3"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_protocol_version_is_low/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[logging].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[logging].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "logging" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "dist-cloud-test-logs"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">SQL Database Audit Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Resource Management</span></span></div><div class="query-details"><span class="query-description-title">Ensure that 'Threat Detection' is enabled for Azure SQL Database</span><span><a href="https://www.terraform.io/docs/providers/azurerm/r/sql_database.html" rel="noopener" target="_blank">https://www.terraform.io/docs/providers/azurerm/r/sql_database.html</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/public_access_sql_db/main.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'threat_detection_policy' exists</span>
<span><strong>Found:</strong> 'threat_detection_policy' is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code">resource "azurerm_sql_database" "my-sql-database" {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> name = "${local.resource_prefix}sqldatabase"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">SQS With SSE Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Amazon Simple Queue Service (SQS) queue is not protecting the contents of their messages using Server-Side Encryption (SSE)</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/tag_all_items/plan.json</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_sqs_queue.kms_master_key_id is defined and not null</span>
<span><strong>Found:</strong> aws_sqs_queue.kms_master_key_id is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">{</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> "format_version": "0.1",</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> "terraform_version": "0.15.1-dev",</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 103</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_sqs_queue.kms_master_key_id is defined and not null</span>
<span><strong>Found:</strong> aws_sqs_queue.kms_master_key_id is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">102</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">103</span><span class="code">resource "aws_sqs_queue" "test-queue" {</span></div><div class="code-line"><span class="code-line-counter">104</span><span class="code"> name = "test-queue"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/tag_all_items/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_sqs_queue.kms_master_key_id is defined and not null</span>
<span><strong>Found:</strong> aws_sqs_queue.kms_master_key_id is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code">resource "aws_sqs_queue" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> name = "sqs_non_encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/sqs_queue_not_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_sqs_queue.kms_master_key_id is defined and not null</span>
<span><strong>Found:</strong> aws_sqs_queue.kms_master_key_id is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_sqs_queue" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "sqs_non_encrypted"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">SSL Enforce Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Make sure that for PosgreSQL, the 'Enforce SSL connection' is set to 'ENABLED'</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/postgresql_not_forcing_ssl/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server.example.ssl_enforcement_enabled' is equal 'true'</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server.example.ssl_enforcement_enabled' is equal 'false'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"> version = "11"</span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code"> ssl_enforcement_enabled = false</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> public_network_access_enabled = true</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Sagemaker Notebook Instance Without KMS</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">AWS SageMaker should encrypt model artifacts at rest using Amazon S3 server-side encryption with an AWS KMS</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sagemaker_notebook_instance#kms_key_id" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sagemaker_notebook_instance#kms_key_id</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/sagemaker_not_encrypted/main.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_sagemaker_notebook_instance.kms_key_id is defined and not null</span>
<span><strong>Found:</strong> aws_sagemaker_notebook_instance.kms_key_id is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code">resource "aws_sagemaker_notebook_instance" "ni" {</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code"> name = "my-notebook-instance"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Security Group With Unrestricted Access To SSH</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">'SSH' (TCP:22) should not be public in AWS Security Group</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 120</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[publicly_accessible_sg] 'SSH' (Port:22) is not public</span>
<span><strong>Found:</strong> aws_security_group[publicly_accessible_sg] 'SSH' (Port:22) is public</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">119</span><span class="code"> to_port = 65000</span></div><div class="code-line error"><span class="code-line-counter">120</span><span class="code"> cidr_blocks = ["0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">121</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 135</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[publicly_accessible_sg] 'SSH' (Port:22) is not public</span>
<span><strong>Found:</strong> aws_security_group[publicly_accessible_sg] 'SSH' (Port:22) is public</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">134</span><span class="code"> to_port = 65000</span></div><div class="code-line error"><span class="code-line-counter">135</span><span class="code"> cidr_blocks = ["0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">136</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 127</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[publicly_accessible_sg] 'SSH' (Port:22) is not public</span>
<span><strong>Found:</strong> aws_security_group[publicly_accessible_sg] 'SSH' (Port:22) is public</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">126</span><span class="code"> to_port = 65000</span></div><div class="code-line error"><span class="code-line-counter">127</span><span class="code"> cidr_blocks = ["0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">128</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Sensitive Port Is Exposed To Entire Network</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">A sensitive port, such as port 23 or port 110, is open for the whole network in either TCP or UDP protocol</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">311</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hadoop Name Node (TCP:9000) should not be allowed</span>
<span><strong>Found:</strong> Hadoop Name Node (TCP:9000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MySQL (TCP:3306) should not be allowed</span>
<span><strong>Found:</strong> MySQL (TCP:3306) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HTTPS (TCP:443) should not be allowed</span>
<span><strong>Found:</strong> HTTPS (TCP:443) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra OpsCenter Website (TCP:8888) should not be allowed</span>
<span><strong>Found:</strong> Cassandra OpsCenter Website (TCP:8888) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Internode Communication (TCP:7000) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Internode Communication (TCP:7000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SMTP (TCP:25) should not be allowed</span>
<span><strong>Found:</strong> SMTP (TCP:25) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> NetBIOS Session Service (TCP:139) should not be allowed</span>
<span><strong>Found:</strong> NetBIOS Session Service (TCP:139) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> VNC Server (TCP:5900) should not be allowed</span>
<span><strong>Found:</strong> VNC Server (TCP:5900) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> NetBIOS Session Service (TCP:139) should not be allowed</span>
<span><strong>Found:</strong> NetBIOS Session Service (TCP:139) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracle DB SSL (TCP:2483) should not be allowed</span>
<span><strong>Found:</strong> Oracle DB SSL (TCP:2483) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SaltStack Master (TCP:4506) should not be allowed</span>
<span><strong>Found:</strong> SaltStack Master (TCP:4506) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> PostgreSQL (TCP:5432) should not be allowed</span>
<span><strong>Found:</strong> PostgreSQL (TCP:5432) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Client (TCP:9042) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Client (TCP:9042) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> NetBIOS Datagram Service (TCP:138) should not be allowed</span>
<span><strong>Found:</strong> NetBIOS Datagram Service (TCP:138) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Thrift (TCP:9160) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Thrift (TCP:9160) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Thrift (TCP:9160) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Thrift (TCP:9160) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> VNC Listener (TCP:5500) should not be allowed</span>
<span><strong>Found:</strong> VNC Listener (TCP:5500) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MSSQL Server (TCP:1433) should not be allowed</span>
<span><strong>Found:</strong> MSSQL Server (TCP:1433) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> PostgreSQL (TCP:5432) should not be allowed</span>
<span><strong>Found:</strong> PostgreSQL (TCP:5432) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Elastic Search (TCP:9200) should not be allowed</span>
<span><strong>Found:</strong> Elastic Search (TCP:9200) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> FTP (TCP:20) should not be allowed</span>
<span><strong>Found:</strong> FTP (TCP:20) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Memcached (TCP:11211) should not be allowed</span>
<span><strong>Found:</strong> Memcached (TCP:11211) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> FTP (TCP:21) should not be allowed</span>
<span><strong>Found:</strong> FTP (TCP:21) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Telnet (TCP:23) should not be allowed</span>
<span><strong>Found:</strong> Telnet (TCP:23) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> PostgreSQL (TCP:5432) should not be allowed</span>
<span><strong>Found:</strong> PostgreSQL (TCP:5432) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> DNS (TCP:53) should not be allowed</span>
<span><strong>Found:</strong> DNS (TCP:53) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Elastic Search (TCP:9300) should not be allowed</span>
<span><strong>Found:</strong> Elastic Search (TCP:9300) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Docker (TCP:2376) should not be allowed</span>
<span><strong>Found:</strong> Docker (TCP:2376) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> NetBIOS Datagram Service (TCP:138) should not be allowed</span>
<span><strong>Found:</strong> NetBIOS Datagram Service (TCP:138) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Known internal web port (TCP:8000) should not be allowed</span>
<span><strong>Found:</strong> Known internal web port (TCP:8000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> LDAP (TCP:389) should not be allowed</span>
<span><strong>Found:</strong> LDAP (TCP:389) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HTTPS (TCP:443) should not be allowed</span>
<span><strong>Found:</strong> HTTPS (TCP:443) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracl DB (TCP:1521) should not be allowed</span>
<span><strong>Found:</strong> Oracl DB (TCP:1521) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> VNC Server (TCP:5900) should not be allowed</span>
<span><strong>Found:</strong> VNC Server (TCP:5900) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> CIFS / SMB (TCP:3020) should not be allowed</span>
<span><strong>Found:</strong> CIFS / SMB (TCP:3020) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> NetBIOS Datagram Service (TCP:138) should not be allowed</span>
<span><strong>Found:</strong> NetBIOS Datagram Service (TCP:138) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> POP3 (TCP:110) should not be allowed</span>
<span><strong>Found:</strong> POP3 (TCP:110) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HDFS NameNode WebUI (TCP:50070) should not be allowed</span>
<span><strong>Found:</strong> HDFS NameNode WebUI (TCP:50070) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SQL Server Analysis (TCP:2382) should not be allowed</span>
<span><strong>Found:</strong> SQL Server Analysis (TCP:2382) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Memcached SSL (TCP:11214) should not be allowed</span>
<span><strong>Found:</strong> Memcached SSL (TCP:11214) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MSSQL Server (TCP:1433) should not be allowed</span>
<span><strong>Found:</strong> MSSQL Server (TCP:1433) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MSSQL Debugger (TCP:135) should not be allowed</span>
<span><strong>Found:</strong> MSSQL Debugger (TCP:135) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracle Auto Data Warehouse (TCP:1522) should not be allowed</span>
<span><strong>Found:</strong> Oracle Auto Data Warehouse (TCP:1522) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Puppet Master (TCP:8140) should not be allowed</span>
<span><strong>Found:</strong> Puppet Master (TCP:8140) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HTTPS (TCP:443) should not be allowed</span>
<span><strong>Found:</strong> HTTPS (TCP:443) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Remote Desktop (TCP:3389) should not be allowed</span>
<span><strong>Found:</strong> Remote Desktop (TCP:3389) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> DNS (TCP:53) should not be allowed</span>
<span><strong>Found:</strong> DNS (TCP:53) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> VNC Server (TCP:5900) should not be allowed</span>
<span><strong>Found:</strong> VNC Server (TCP:5900) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MySQL (TCP:3306) should not be allowed</span>
<span><strong>Found:</strong> MySQL (TCP:3306) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Mongo (TCP:27017) should not be allowed</span>
<span><strong>Found:</strong> Mongo (TCP:27017) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MSSQL Server (TCP:1433) should not be allowed</span>
<span><strong>Found:</strong> MSSQL Server (TCP:1433) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra OpsCenter (TCP:61620) should not be allowed</span>
<span><strong>Found:</strong> Cassandra OpsCenter (TCP:61620) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HDFS NameNode (TCP:8020) should not be allowed</span>
<span><strong>Found:</strong> HDFS NameNode (TCP:8020) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Elastic Search (TCP:9200) should not be allowed</span>
<span><strong>Found:</strong> Elastic Search (TCP:9200) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SSH (TCP:22) should not be allowed</span>
<span><strong>Found:</strong> SSH (TCP:22) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HDFS NameNode WebUI (TCP:50070) should not be allowed</span>
<span><strong>Found:</strong> HDFS NameNode WebUI (TCP:50070) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> LDAP SSL (TCP:636) should not be allowed</span>
<span><strong>Found:</strong> LDAP SSL (TCP:636) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HTTP (TCP:80) should not be allowed</span>
<span><strong>Found:</strong> HTTP (TCP:80) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> VNC Listener (TCP:5500) should not be allowed</span>
<span><strong>Found:</strong> VNC Listener (TCP:5500) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Client (TCP:9042) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Client (TCP:9042) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra OpsCenter Website (TCP:8888) should not be allowed</span>
<span><strong>Found:</strong> Cassandra OpsCenter Website (TCP:8888) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Puppet Master (TCP:8140) should not be allowed</span>
<span><strong>Found:</strong> Puppet Master (TCP:8140) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MSSQL Server (TCP:1433) should not be allowed</span>
<span><strong>Found:</strong> MSSQL Server (TCP:1433) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MSSQL Browser (TCP:1434) should not be allowed</span>
<span><strong>Found:</strong> MSSQL Browser (TCP:1434) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SNMP (TCP:161) should not be allowed</span>
<span><strong>Found:</strong> SNMP (TCP:161) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MSSQL Debugger (TCP:135) should not be allowed</span>
<span><strong>Found:</strong> MSSQL Debugger (TCP:135) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Docker (TCP:2376) should not be allowed</span>
<span><strong>Found:</strong> Docker (TCP:2376) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> FTP (TCP:21) should not be allowed</span>
<span><strong>Found:</strong> FTP (TCP:21) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra (TCP:7001) should not be allowed</span>
<span><strong>Found:</strong> Cassandra (TCP:7001) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SaltStack Master (TCP:4506) should not be allowed</span>
<span><strong>Found:</strong> SaltStack Master (TCP:4506) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HDFS NameNode WebUI (TCP:50470) should not be allowed</span>
<span><strong>Found:</strong> HDFS NameNode WebUI (TCP:50470) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HTTPS (TCP:443) should not be allowed</span>
<span><strong>Found:</strong> HTTPS (TCP:443) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Memcached SSL (TCP:11215) should not be allowed</span>
<span><strong>Found:</strong> Memcached SSL (TCP:11215) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracle DB SSL (TCP:2484) should not be allowed</span>
<span><strong>Found:</strong> Oracle DB SSL (TCP:2484) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracle DB SSL (TCP:2483) should not be allowed</span>
<span><strong>Found:</strong> Oracle DB SSL (TCP:2483) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> CIFS / SMB (TCP:3020) should not be allowed</span>
<span><strong>Found:</strong> CIFS / SMB (TCP:3020) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracle Auto Data Warehouse (TCP:1522) should not be allowed</span>
<span><strong>Found:</strong> Oracle Auto Data Warehouse (TCP:1522) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> LDAP SSL (TCP:636) should not be allowed</span>
<span><strong>Found:</strong> LDAP SSL (TCP:636) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SSH (TCP:22) should not be allowed</span>
<span><strong>Found:</strong> SSH (TCP:22) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Mongo (TCP:27017) should not be allowed</span>
<span><strong>Found:</strong> Mongo (TCP:27017) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracl DB (TCP:1521) should not be allowed</span>
<span><strong>Found:</strong> Oracl DB (TCP:1521) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Internode Communication (TCP:7000) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Internode Communication (TCP:7000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SaltStack Master (TCP:4506) should not be allowed</span>
<span><strong>Found:</strong> SaltStack Master (TCP:4506) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Microsoft-DS (TCP:445) should not be allowed</span>
<span><strong>Found:</strong> Microsoft-DS (TCP:445) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Memcached SSL (TCP:11214) should not be allowed</span>
<span><strong>Found:</strong> Memcached SSL (TCP:11214) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> POP3 (TCP:110) should not be allowed</span>
<span><strong>Found:</strong> POP3 (TCP:110) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Telnet (TCP:23) should not be allowed</span>
<span><strong>Found:</strong> Telnet (TCP:23) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> CIFS / SMB (TCP:3020) should not be allowed</span>
<span><strong>Found:</strong> CIFS / SMB (TCP:3020) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> POP3 (TCP:110) should not be allowed</span>
<span><strong>Found:</strong> POP3 (TCP:110) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Client (TCP:9042) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Client (TCP:9042) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracle DB SSL (TCP:2483) should not be allowed</span>
<span><strong>Found:</strong> Oracle DB SSL (TCP:2483) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Mongo (TCP:27017) should not be allowed</span>
<span><strong>Found:</strong> Mongo (TCP:27017) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Microsoft-DS (TCP:445) should not be allowed</span>
<span><strong>Found:</strong> Microsoft-DS (TCP:445) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> NetBIOS Datagram Service (TCP:138) should not be allowed</span>
<span><strong>Found:</strong> NetBIOS Datagram Service (TCP:138) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SSH (TCP:22) should not be allowed</span>
<span><strong>Found:</strong> SSH (TCP:22) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Elastic Search (TCP:9300) should not be allowed</span>
<span><strong>Found:</strong> Elastic Search (TCP:9300) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Known internal web port (TCP:8000) should not be allowed</span>
<span><strong>Found:</strong> Known internal web port (TCP:8000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracle DB SSL (TCP:2484) should not be allowed</span>
<span><strong>Found:</strong> Oracle DB SSL (TCP:2484) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MSSQL Browser (TCP:1434) should not be allowed</span>
<span><strong>Found:</strong> MSSQL Browser (TCP:1434) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Internode Communication (TCP:7000) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Internode Communication (TCP:7000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra (TCP:7001) should not be allowed</span>
<span><strong>Found:</strong> Cassandra (TCP:7001) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Thrift (TCP:9160) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Thrift (TCP:9160) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Docker (TCP:2375) should not be allowed</span>
<span><strong>Found:</strong> Docker (TCP:2375) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Known internal web port (TCP:8000) should not be allowed</span>
<span><strong>Found:</strong> Known internal web port (TCP:8000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Client (TCP:9042) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Client (TCP:9042) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Remote Desktop (TCP:3389) should not be allowed</span>
<span><strong>Found:</strong> Remote Desktop (TCP:3389) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SQL Server Analysis (TCP:2382) should not be allowed</span>
<span><strong>Found:</strong> SQL Server Analysis (TCP:2382) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra (TCP:7001) should not be allowed</span>
<span><strong>Found:</strong> Cassandra (TCP:7001) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracl DB (TCP:1521) should not be allowed</span>
<span><strong>Found:</strong> Oracl DB (TCP:1521) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Memcached SSL (TCP:11215) should not be allowed</span>
<span><strong>Found:</strong> Memcached SSL (TCP:11215) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra (TCP:7001) should not be allowed</span>
<span><strong>Found:</strong> Cassandra (TCP:7001) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Memcached (TCP:11211) should not be allowed</span>
<span><strong>Found:</strong> Memcached (TCP:11211) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SQL Server Analysis (TCP:2383) should not be allowed</span>
<span><strong>Found:</strong> SQL Server Analysis (TCP:2383) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Kibana (TCP:5601) should not be allowed</span>
<span><strong>Found:</strong> Kibana (TCP:5601) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MSSQL Browser (TCP:1434) should not be allowed</span>
<span><strong>Found:</strong> MSSQL Browser (TCP:1434) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> FTP (TCP:20) should not be allowed</span>
<span><strong>Found:</strong> FTP (TCP:20) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra OpsCenter (TCP:61620) should not be allowed</span>
<span><strong>Found:</strong> Cassandra OpsCenter (TCP:61620) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracle DB SSL (TCP:2483) should not be allowed</span>
<span><strong>Found:</strong> Oracle DB SSL (TCP:2483) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hadoop Name Node (TCP:9000) should not be allowed</span>
<span><strong>Found:</strong> Hadoop Name Node (TCP:9000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MySQL (TCP:3306) should not be allowed</span>
<span><strong>Found:</strong> MySQL (TCP:3306) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> NetBIOS Name Service (TCP:137) should not be allowed</span>
<span><strong>Found:</strong> NetBIOS Name Service (TCP:137) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> CiscoSecure, WebSM (TCP:9090) should not be allowed</span>
<span><strong>Found:</strong> CiscoSecure, WebSM (TCP:9090) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Elastic Search (TCP:9200) should not be allowed</span>
<span><strong>Found:</strong> Elastic Search (TCP:9200) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Mongo Web Portal (TCP:27018) should not be allowed</span>
<span><strong>Found:</strong> Mongo Web Portal (TCP:27018) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracle DB SSL (TCP:2484) should not be allowed</span>
<span><strong>Found:</strong> Oracle DB SSL (TCP:2484) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra OpsCenter (TCP:61621) should not be allowed</span>
<span><strong>Found:</strong> Cassandra OpsCenter (TCP:61621) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SQL Server Analysis (TCP:2383) should not be allowed</span>
<span><strong>Found:</strong> SQL Server Analysis (TCP:2383) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Memcached SSL (TCP:11214) should not be allowed</span>
<span><strong>Found:</strong> Memcached SSL (TCP:11214) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Memcached SSL (TCP:11215) should not be allowed</span>
<span><strong>Found:</strong> Memcached SSL (TCP:11215) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Memcached (TCP:11211) should not be allowed</span>
<span><strong>Found:</strong> Memcached (TCP:11211) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Redis (TCP:6379) should not be allowed</span>
<span><strong>Found:</strong> Redis (TCP:6379) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Microsoft-DS (TCP:445) should not be allowed</span>
<span><strong>Found:</strong> Microsoft-DS (TCP:445) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HDFS NameNode WebUI (TCP:50470) should not be allowed</span>
<span><strong>Found:</strong> HDFS NameNode WebUI (TCP:50470) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> CiscoSecure, WebSM (TCP:9090) should not be allowed</span>
<span><strong>Found:</strong> CiscoSecure, WebSM (TCP:9090) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> WinRM for HTTP (TCP:5985) should not be allowed</span>
<span><strong>Found:</strong> WinRM for HTTP (TCP:5985) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Monitoring (TCP:7199) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Monitoring (TCP:7199) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HDFS NameNode WebUI (TCP:50070) should not be allowed</span>
<span><strong>Found:</strong> HDFS NameNode WebUI (TCP:50070) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Known internal web port (TCP:8080) should not be allowed</span>
<span><strong>Found:</strong> Known internal web port (TCP:8080) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Memcached SSL (TCP:11214) should not be allowed</span>
<span><strong>Found:</strong> Memcached SSL (TCP:11214) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Thrift (TCP:9160) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Thrift (TCP:9160) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Memcached (TCP:11211) should not be allowed</span>
<span><strong>Found:</strong> Memcached (TCP:11211) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SNMP (TCP:161) should not be allowed</span>
<span><strong>Found:</strong> SNMP (TCP:161) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Docker (TCP:2375) should not be allowed</span>
<span><strong>Found:</strong> Docker (TCP:2375) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SMTP (TCP:25) should not be allowed</span>
<span><strong>Found:</strong> SMTP (TCP:25) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> FTP (TCP:21) should not be allowed</span>
<span><strong>Found:</strong> FTP (TCP:21) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> LDAP (TCP:389) should not be allowed</span>
<span><strong>Found:</strong> LDAP (TCP:389) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SNMP (TCP:161) should not be allowed</span>
<span><strong>Found:</strong> SNMP (TCP:161) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra OpsCenter Website (TCP:8888) should not be allowed</span>
<span><strong>Found:</strong> Cassandra OpsCenter Website (TCP:8888) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MSSQL Browser (TCP:1434) should not be allowed</span>
<span><strong>Found:</strong> MSSQL Browser (TCP:1434) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Monitoring (TCP:7199) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Monitoring (TCP:7199) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Prevalent known internal port (TCP:3000) should not be allowed</span>
<span><strong>Found:</strong> Prevalent known internal port (TCP:3000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> DNS (TCP:53) should not be allowed</span>
<span><strong>Found:</strong> DNS (TCP:53) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HDFS NameNode (TCP:8020) should not be allowed</span>
<span><strong>Found:</strong> HDFS NameNode (TCP:8020) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracle DB SSL (TCP:2483) should not be allowed</span>
<span><strong>Found:</strong> Oracle DB SSL (TCP:2483) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SQL Server Analysis (TCP:2382) should not be allowed</span>
<span><strong>Found:</strong> SQL Server Analysis (TCP:2382) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Redis (TCP:6379) should not be allowed</span>
<span><strong>Found:</strong> Redis (TCP:6379) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HDFS NameNode WebUI (TCP:50070) should not be allowed</span>
<span><strong>Found:</strong> HDFS NameNode WebUI (TCP:50070) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra OpsCenter (TCP:61620) should not be allowed</span>
<span><strong>Found:</strong> Cassandra OpsCenter (TCP:61620) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HDFS NameNode (TCP:8020) should not be allowed</span>
<span><strong>Found:</strong> HDFS NameNode (TCP:8020) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hadoop Name Node (TCP:9000) should not be allowed</span>
<span><strong>Found:</strong> Hadoop Name Node (TCP:9000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SQL Server Analysis (TCP:2382) should not be allowed</span>
<span><strong>Found:</strong> SQL Server Analysis (TCP:2382) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SQL Server Analysis (TCP:2382) should not be allowed</span>
<span><strong>Found:</strong> SQL Server Analysis (TCP:2382) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> CIFS / SMB (TCP:3020) should not be allowed</span>
<span><strong>Found:</strong> CIFS / SMB (TCP:3020) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HTTP (TCP:80) should not be allowed</span>
<span><strong>Found:</strong> HTTP (TCP:80) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> CiscoSecure, WebSM (TCP:9090) should not be allowed</span>
<span><strong>Found:</strong> CiscoSecure, WebSM (TCP:9090) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> VNC Listener (TCP:5500) should not be allowed</span>
<span><strong>Found:</strong> VNC Listener (TCP:5500) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Microsoft-DS (TCP:445) should not be allowed</span>
<span><strong>Found:</strong> Microsoft-DS (TCP:445) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Microsoft-DS (TCP:445) should not be allowed</span>
<span><strong>Found:</strong> Microsoft-DS (TCP:445) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Puppet Master (TCP:8140) should not be allowed</span>
<span><strong>Found:</strong> Puppet Master (TCP:8140) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> LDAP (TCP:389) should not be allowed</span>
<span><strong>Found:</strong> LDAP (TCP:389) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Mongo Web Portal (TCP:27018) should not be allowed</span>
<span><strong>Found:</strong> Mongo Web Portal (TCP:27018) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracle Auto Data Warehouse (TCP:1522) should not be allowed</span>
<span><strong>Found:</strong> Oracle Auto Data Warehouse (TCP:1522) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Kibana (TCP:5601) should not be allowed</span>
<span><strong>Found:</strong> Kibana (TCP:5601) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracle DB SSL (TCP:2484) should not be allowed</span>
<span><strong>Found:</strong> Oracle DB SSL (TCP:2484) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Mongo Web Portal (TCP:27018) should not be allowed</span>
<span><strong>Found:</strong> Mongo Web Portal (TCP:27018) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> NetBIOS Session Service (TCP:139) should not be allowed</span>
<span><strong>Found:</strong> NetBIOS Session Service (TCP:139) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> FTP (TCP:20) should not be allowed</span>
<span><strong>Found:</strong> FTP (TCP:20) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SaltStack Master (TCP:4505) should not be allowed</span>
<span><strong>Found:</strong> SaltStack Master (TCP:4505) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_unused/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HTTPS (TCP:443) should not be allowed</span>
<span><strong>Found:</strong> HTTPS (TCP:443) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> description = "TLS anywhere"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HTTP (TCP:80) should not be allowed</span>
<span><strong>Found:</strong> HTTP (TCP:80) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MySQL (TCP:3306) should not be allowed</span>
<span><strong>Found:</strong> MySQL (TCP:3306) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> NetBIOS Name Service (TCP:137) should not be allowed</span>
<span><strong>Found:</strong> NetBIOS Name Service (TCP:137) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SSH (TCP:22) should not be allowed</span>
<span><strong>Found:</strong> SSH (TCP:22) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SQL Server Analysis (TCP:2383) should not be allowed</span>
<span><strong>Found:</strong> SQL Server Analysis (TCP:2383) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SNMP (TCP:161) should not be allowed</span>
<span><strong>Found:</strong> SNMP (TCP:161) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> VNC Listener (TCP:5500) should not be allowed</span>
<span><strong>Found:</strong> VNC Listener (TCP:5500) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Elastic Search (TCP:9200) should not be allowed</span>
<span><strong>Found:</strong> Elastic Search (TCP:9200) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> POP3 (TCP:110) should not be allowed</span>
<span><strong>Found:</strong> POP3 (TCP:110) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Prevalent known internal port (TCP:3000) should not be allowed</span>
<span><strong>Found:</strong> Prevalent known internal port (TCP:3000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HDFS NameNode WebUI (TCP:50470) should not be allowed</span>
<span><strong>Found:</strong> HDFS NameNode WebUI (TCP:50470) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MSSQL Debugger (TCP:135) should not be allowed</span>
<span><strong>Found:</strong> MSSQL Debugger (TCP:135) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SaltStack Master (TCP:4505) should not be allowed</span>
<span><strong>Found:</strong> SaltStack Master (TCP:4505) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Thrift (TCP:9160) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Thrift (TCP:9160) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Monitoring (TCP:7199) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Monitoring (TCP:7199) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Puppet Master (TCP:8140) should not be allowed</span>
<span><strong>Found:</strong> Puppet Master (TCP:8140) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Redis (TCP:6379) should not be allowed</span>
<span><strong>Found:</strong> Redis (TCP:6379) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MSSQL Server (TCP:1433) should not be allowed</span>
<span><strong>Found:</strong> MSSQL Server (TCP:1433) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Prevalent known internal port (TCP:3000) should not be allowed</span>
<span><strong>Found:</strong> Prevalent known internal port (TCP:3000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> WinRM for HTTP (TCP:5985) should not be allowed</span>
<span><strong>Found:</strong> WinRM for HTTP (TCP:5985) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> PostgreSQL (TCP:5432) should not be allowed</span>
<span><strong>Found:</strong> PostgreSQL (TCP:5432) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> FTP (TCP:21) should not be allowed</span>
<span><strong>Found:</strong> FTP (TCP:21) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Kibana (TCP:5601) should not be allowed</span>
<span><strong>Found:</strong> Kibana (TCP:5601) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HDFS NameNode WebUI (TCP:50470) should not be allowed</span>
<span><strong>Found:</strong> HDFS NameNode WebUI (TCP:50470) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Prevalent known internal port (TCP:3000) should not be allowed</span>
<span><strong>Found:</strong> Prevalent known internal port (TCP:3000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra OpsCenter (TCP:61621) should not be allowed</span>
<span><strong>Found:</strong> Cassandra OpsCenter (TCP:61621) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> VNC Listener (TCP:5500) should not be allowed</span>
<span><strong>Found:</strong> VNC Listener (TCP:5500) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Mongo (TCP:27017) should not be allowed</span>
<span><strong>Found:</strong> Mongo (TCP:27017) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> WinRM for HTTP (TCP:5985) should not be allowed</span>
<span><strong>Found:</strong> WinRM for HTTP (TCP:5985) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MSSQL Debugger (TCP:135) should not be allowed</span>
<span><strong>Found:</strong> MSSQL Debugger (TCP:135) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Telnet (TCP:23) should not be allowed</span>
<span><strong>Found:</strong> Telnet (TCP:23) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> LDAP SSL (TCP:636) should not be allowed</span>
<span><strong>Found:</strong> LDAP SSL (TCP:636) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MSSQL Browser (TCP:1434) should not be allowed</span>
<span><strong>Found:</strong> MSSQL Browser (TCP:1434) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Known internal web port (TCP:8080) should not be allowed</span>
<span><strong>Found:</strong> Known internal web port (TCP:8080) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra OpsCenter Website (TCP:8888) should not be allowed</span>
<span><strong>Found:</strong> Cassandra OpsCenter Website (TCP:8888) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> LDAP SSL (TCP:636) should not be allowed</span>
<span><strong>Found:</strong> LDAP SSL (TCP:636) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SMTP (TCP:25) should not be allowed</span>
<span><strong>Found:</strong> SMTP (TCP:25) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Docker (TCP:2376) should not be allowed</span>
<span><strong>Found:</strong> Docker (TCP:2376) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Memcached SSL (TCP:11215) should not be allowed</span>
<span><strong>Found:</strong> Memcached SSL (TCP:11215) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> VNC Server (TCP:5900) should not be allowed</span>
<span><strong>Found:</strong> VNC Server (TCP:5900) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> LDAP SSL (TCP:636) should not be allowed</span>
<span><strong>Found:</strong> LDAP SSL (TCP:636) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Elastic Search (TCP:9300) should not be allowed</span>
<span><strong>Found:</strong> Elastic Search (TCP:9300) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SQL Server Analysis (TCP:2383) should not be allowed</span>
<span><strong>Found:</strong> SQL Server Analysis (TCP:2383) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Mongo (TCP:27017) should not be allowed</span>
<span><strong>Found:</strong> Mongo (TCP:27017) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MSSQL Debugger (TCP:135) should not be allowed</span>
<span><strong>Found:</strong> MSSQL Debugger (TCP:135) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SaltStack Master (TCP:4505) should not be allowed</span>
<span><strong>Found:</strong> SaltStack Master (TCP:4505) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> NetBIOS Datagram Service (TCP:138) should not be allowed</span>
<span><strong>Found:</strong> NetBIOS Datagram Service (TCP:138) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Mongo Web Portal (TCP:27018) should not be allowed</span>
<span><strong>Found:</strong> Mongo Web Portal (TCP:27018) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> FTP (TCP:20) should not be allowed</span>
<span><strong>Found:</strong> FTP (TCP:20) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracle DB SSL (TCP:2484) should not be allowed</span>
<span><strong>Found:</strong> Oracle DB SSL (TCP:2484) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Memcached SSL (TCP:11215) should not be allowed</span>
<span><strong>Found:</strong> Memcached SSL (TCP:11215) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Redis (TCP:6379) should not be allowed</span>
<span><strong>Found:</strong> Redis (TCP:6379) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> VNC Server (TCP:5900) should not be allowed</span>
<span><strong>Found:</strong> VNC Server (TCP:5900) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> LDAP (TCP:389) should not be allowed</span>
<span><strong>Found:</strong> LDAP (TCP:389) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Remote Desktop (TCP:3389) should not be allowed</span>
<span><strong>Found:</strong> Remote Desktop (TCP:3389) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracl DB (TCP:1521) should not be allowed</span>
<span><strong>Found:</strong> Oracl DB (TCP:1521) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra OpsCenter (TCP:61620) should not be allowed</span>
<span><strong>Found:</strong> Cassandra OpsCenter (TCP:61620) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HDFS NameNode (TCP:8020) should not be allowed</span>
<span><strong>Found:</strong> HDFS NameNode (TCP:8020) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HDFS NameNode (TCP:8020) should not be allowed</span>
<span><strong>Found:</strong> HDFS NameNode (TCP:8020) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra (TCP:7001) should not be allowed</span>
<span><strong>Found:</strong> Cassandra (TCP:7001) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Monitoring (TCP:7199) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Monitoring (TCP:7199) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracle Auto Data Warehouse (TCP:1522) should not be allowed</span>
<span><strong>Found:</strong> Oracle Auto Data Warehouse (TCP:1522) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra OpsCenter Website (TCP:8888) should not be allowed</span>
<span><strong>Found:</strong> Cassandra OpsCenter Website (TCP:8888) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SMTP (TCP:25) should not be allowed</span>
<span><strong>Found:</strong> SMTP (TCP:25) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> NetBIOS Name Service (TCP:137) should not be allowed</span>
<span><strong>Found:</strong> NetBIOS Name Service (TCP:137) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> WinRM for HTTP (TCP:5985) should not be allowed</span>
<span><strong>Found:</strong> WinRM for HTTP (TCP:5985) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> MySQL (TCP:3306) should not be allowed</span>
<span><strong>Found:</strong> MySQL (TCP:3306) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> CIFS / SMB (TCP:3020) should not be allowed</span>
<span><strong>Found:</strong> CIFS / SMB (TCP:3020) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Internode Communication (TCP:7000) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Internode Communication (TCP:7000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SMTP (TCP:25) should not be allowed</span>
<span><strong>Found:</strong> SMTP (TCP:25) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Docker (TCP:2376) should not be allowed</span>
<span><strong>Found:</strong> Docker (TCP:2376) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Elastic Search (TCP:9300) should not be allowed</span>
<span><strong>Found:</strong> Elastic Search (TCP:9300) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> DNS (TCP:53) should not be allowed</span>
<span><strong>Found:</strong> DNS (TCP:53) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> WinRM for HTTP (TCP:5985) should not be allowed</span>
<span><strong>Found:</strong> WinRM for HTTP (TCP:5985) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SNMP (TCP:161) should not be allowed</span>
<span><strong>Found:</strong> SNMP (TCP:161) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra OpsCenter (TCP:61621) should not be allowed</span>
<span><strong>Found:</strong> Cassandra OpsCenter (TCP:61621) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> NetBIOS Session Service (TCP:139) should not be allowed</span>
<span><strong>Found:</strong> NetBIOS Session Service (TCP:139) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SaltStack Master (TCP:4505) should not be allowed</span>
<span><strong>Found:</strong> SaltStack Master (TCP:4505) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Telnet (TCP:23) should not be allowed</span>
<span><strong>Found:</strong> Telnet (TCP:23) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Remote Desktop (TCP:3389) should not be allowed</span>
<span><strong>Found:</strong> Remote Desktop (TCP:3389) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Elastic Search (TCP:9200) should not be allowed</span>
<span><strong>Found:</strong> Elastic Search (TCP:9200) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra OpsCenter (TCP:61621) should not be allowed</span>
<span><strong>Found:</strong> Cassandra OpsCenter (TCP:61621) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Mongo Web Portal (TCP:27018) should not be allowed</span>
<span><strong>Found:</strong> Mongo Web Portal (TCP:27018) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> PostgreSQL (TCP:5432) should not be allowed</span>
<span><strong>Found:</strong> PostgreSQL (TCP:5432) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> CiscoSecure, WebSM (TCP:9090) should not be allowed</span>
<span><strong>Found:</strong> CiscoSecure, WebSM (TCP:9090) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> FTP (TCP:20) should not be allowed</span>
<span><strong>Found:</strong> FTP (TCP:20) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Internode Communication (TCP:7000) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Internode Communication (TCP:7000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> CiscoSecure, WebSM (TCP:9090) should not be allowed</span>
<span><strong>Found:</strong> CiscoSecure, WebSM (TCP:9090) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Known internal web port (TCP:8080) should not be allowed</span>
<span><strong>Found:</strong> Known internal web port (TCP:8080) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SQL Server Analysis (TCP:2383) should not be allowed</span>
<span><strong>Found:</strong> SQL Server Analysis (TCP:2383) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Puppet Master (TCP:8140) should not be allowed</span>
<span><strong>Found:</strong> Puppet Master (TCP:8140) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Remote Desktop (TCP:3389) should not be allowed</span>
<span><strong>Found:</strong> Remote Desktop (TCP:3389) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hadoop Name Node (TCP:9000) should not be allowed</span>
<span><strong>Found:</strong> Hadoop Name Node (TCP:9000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SaltStack Master (TCP:4505) should not be allowed</span>
<span><strong>Found:</strong> SaltStack Master (TCP:4505) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HDFS NameNode WebUI (TCP:50070) should not be allowed</span>
<span><strong>Found:</strong> HDFS NameNode WebUI (TCP:50070) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> POP3 (TCP:110) should not be allowed</span>
<span><strong>Found:</strong> POP3 (TCP:110) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> NetBIOS Name Service (TCP:137) should not be allowed</span>
<span><strong>Found:</strong> NetBIOS Name Service (TCP:137) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Docker (TCP:2376) should not be allowed</span>
<span><strong>Found:</strong> Docker (TCP:2376) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SaltStack Master (TCP:4506) should not be allowed</span>
<span><strong>Found:</strong> SaltStack Master (TCP:4506) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Docker (TCP:2375) should not be allowed</span>
<span><strong>Found:</strong> Docker (TCP:2375) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> NetBIOS Name Service (TCP:137) should not be allowed</span>
<span><strong>Found:</strong> NetBIOS Name Service (TCP:137) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Known internal web port (TCP:8000) should not be allowed</span>
<span><strong>Found:</strong> Known internal web port (TCP:8000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Known internal web port (TCP:8080) should not be allowed</span>
<span><strong>Found:</strong> Known internal web port (TCP:8080) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Elastic Search (TCP:9300) should not be allowed</span>
<span><strong>Found:</strong> Elastic Search (TCP:9300) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Docker (TCP:2375) should not be allowed</span>
<span><strong>Found:</strong> Docker (TCP:2375) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Memcached (TCP:11211) should not be allowed</span>
<span><strong>Found:</strong> Memcached (TCP:11211) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracl DB (TCP:1521) should not be allowed</span>
<span><strong>Found:</strong> Oracl DB (TCP:1521) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Known internal web port (TCP:8080) should not be allowed</span>
<span><strong>Found:</strong> Known internal web port (TCP:8080) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HTTP (TCP:80) should not be allowed</span>
<span><strong>Found:</strong> HTTP (TCP:80) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> DNS (TCP:53) should not be allowed</span>
<span><strong>Found:</strong> DNS (TCP:53) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> NetBIOS Session Service (TCP:139) should not be allowed</span>
<span><strong>Found:</strong> NetBIOS Session Service (TCP:139) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HDFS NameNode WebUI (TCP:50470) should not be allowed</span>
<span><strong>Found:</strong> HDFS NameNode WebUI (TCP:50470) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SaltStack Master (TCP:4506) should not be allowed</span>
<span><strong>Found:</strong> SaltStack Master (TCP:4506) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Prevalent known internal port (TCP:3000) should not be allowed</span>
<span><strong>Found:</strong> Prevalent known internal port (TCP:3000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Telnet (TCP:23) should not be allowed</span>
<span><strong>Found:</strong> Telnet (TCP:23) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Docker (TCP:2375) should not be allowed</span>
<span><strong>Found:</strong> Docker (TCP:2375) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Redis (TCP:6379) should not be allowed</span>
<span><strong>Found:</strong> Redis (TCP:6379) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Oracle Auto Data Warehouse (TCP:1522) should not be allowed</span>
<span><strong>Found:</strong> Oracle Auto Data Warehouse (TCP:1522) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Known internal web port (TCP:8000) should not be allowed</span>
<span><strong>Found:</strong> Known internal web port (TCP:8000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Monitoring (TCP:7199) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Monitoring (TCP:7199) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HTTP (TCP:80) should not be allowed</span>
<span><strong>Found:</strong> HTTP (TCP:80) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Kibana (TCP:5601) should not be allowed</span>
<span><strong>Found:</strong> Kibana (TCP:5601) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Kibana (TCP:5601) should not be allowed</span>
<span><strong>Found:</strong> Kibana (TCP:5601) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> LDAP (TCP:389) should not be allowed</span>
<span><strong>Found:</strong> LDAP (TCP:389) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra OpsCenter (TCP:61621) should not be allowed</span>
<span><strong>Found:</strong> Cassandra OpsCenter (TCP:61621) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HTTPS (TCP:443) should not be allowed</span>
<span><strong>Found:</strong> HTTPS (TCP:443) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra Client (TCP:9042) should not be allowed</span>
<span><strong>Found:</strong> Cassandra Client (TCP:9042) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Memcached SSL (TCP:11214) should not be allowed</span>
<span><strong>Found:</strong> Memcached SSL (TCP:11214) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> FTP (TCP:21) should not be allowed</span>
<span><strong>Found:</strong> FTP (TCP:21) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hadoop Name Node (TCP:9000) should not be allowed</span>
<span><strong>Found:</strong> Hadoop Name Node (TCP:9000) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Cassandra OpsCenter (TCP:61620) should not be allowed</span>
<span><strong>Found:</strong> Cassandra OpsCenter (TCP:61620) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SSH (TCP:22) should not be allowed</span>
<span><strong>Found:</strong> SSH (TCP:22) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Storage Account Not Forcing HTTPS</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">See that Storage Accounts forces the use of HTTPS</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">20</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/vmss_win_diagnostic_log_disabled/main.tf</strong>
<span>Line 41</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">40</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">41</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">42</span><span class="code"> name = "${local.resource_prefix}tstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/at-rest/storacc_encryption_not_enabled/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> name = "${local.resource_prefix}tststacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_win_java_isnot_latest/main.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> name = "${local.resource_prefix}funcapptstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/func_app_ftps_not_required/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code">}</span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = "myfuncappstorageaccount"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/functionapp_not_use_managedidentity/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}funcapptstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_latest_tls/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}funcapptstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/public_access_sql_db/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.my-storage-account.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.my-storage-account.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "azurerm_storage_account" "my-storage-account" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> name = "${local.resource_prefix}storageaccount"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_http2/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}functionapptstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/sql-server-audit-retention-30/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.example.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.example.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "azurerm_storage_account" "example" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> name = "${local.resource_prefix}tststacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/sql_vulnerability_email_not_set/main.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.example.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.example.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code">resource "azurerm_storage_account" "example" {</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> name = "${local.resource_prefix}tststoracc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/func_app_client_cert_optional/main.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code"> name = local.resource_prefix</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/storage_account_public_access_disabled/main.tf</strong>
<span>Line 16</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">15</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">16</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">17</span><span class="code"> name = "${local.resource_prefix}tststacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/batch_diagnostic_disabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}batchstacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/vmss_unmanaged_disks/main.tf</strong>
<span>Line 41</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">40</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">41</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">42</span><span class="code"> name = "${local.resource_prefix}tstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/func_app_authentication/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> name = "myfuncappstorageaccount"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/at-rest/activitylog_storage_account_encryption_not_enabled/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> name = "${local.resource_prefix}tststacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_python_isnot_latest/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}funappsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_lin_java_isnot_latest/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}funcapptstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/iot_hub_diagnostic_not_enabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}tststacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/vm_unmanaged_disks/main.tf</strong>
<span>Line 42</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.storacc.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">41</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">42</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">43</span><span class="code"> name = "${local.resource_prefix}tstsa"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Trusted Microsoft Services Not Enabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Trusted MIcrosoft Services are not enabled for Storage Account access</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#bypass" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#bypass</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">20</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_http2/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}functionapptstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_lin_java_isnot_latest/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}funcapptstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/func_app_authentication/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> name = "myfuncappstorageaccount"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_win_java_isnot_latest/main.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> name = "${local.resource_prefix}funcapptstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_latest_tls/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}funcapptstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/sql_vulnerability_email_not_set/main.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code">resource "azurerm_storage_account" "example" {</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> name = "${local.resource_prefix}tststoracc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/func_app_client_cert_optional/main.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code"> name = local.resource_prefix</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/functionapp_not_use_managedidentity/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}funcapptstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/at-rest/storacc_encryption_not_enabled/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> name = "${local.resource_prefix}tststacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/sql-server-audit-retention-30/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "azurerm_storage_account" "example" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> name = "${local.resource_prefix}tststacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/public_access_sql_db/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "azurerm_storage_account" "my-storage-account" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> name = "${local.resource_prefix}storageaccount"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/iot_hub_diagnostic_not_enabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}tststacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/vmss_win_diagnostic_log_disabled/main.tf</strong>
<span>Line 41</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">40</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">41</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">42</span><span class="code"> name = "${local.resource_prefix}tstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/at-rest/activitylog_storage_account_encryption_not_enabled/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> name = "${local.resource_prefix}tststacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/storage_account_public_access_disabled/main.tf</strong>
<span>Line 16</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">15</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">16</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">17</span><span class="code"> name = "${local.resource_prefix}tststacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/batch_diagnostic_disabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}batchstacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/vm_unmanaged_disks/main.tf</strong>
<span>Line 42</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">41</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">42</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">43</span><span class="code"> name = "${local.resource_prefix}tstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/func_app_ftps_not_required/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code">}</span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = "myfuncappstorageaccount"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_python_isnot_latest/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}funappsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/vmss_unmanaged_disks/main.tf</strong>
<span>Line 41</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">40</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">41</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">42</span><span class="code"> name = "${local.resource_prefix}tstsa"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Unknown Port Exposed To Internet</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">AWS Security Group should not have an unknown port exposed to the entire Internet</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">6</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[free].ingress.from_port is known</span>
<span><strong>Found:</strong> aws_security_group[free].ingress.from_port is unknown and is exposed to the entire Internet</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"> to_port = 64000</span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code"> cidr_blocks = ["0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_unused/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[allow_tls].ingress.from_port is known</span>
<span><strong>Found:</strong> aws_security_group[allow_tls].ingress.from_port is unknown and is exposed to the entire Internet</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"> protocol = "tcp"</span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code"> cidr_blocks = ["0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 16</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[nondefault].ingress.from_port is known</span>
<span><strong>Found:</strong> aws_security_group[nondefault].ingress.from_port is unknown and is exposed to the entire Internet</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">15</span><span class="code"> to_port = 65000</span></div><div class="code-line error"><span class="code-line-counter">16</span><span class="code"> cidr_blocks = ["0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">17</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 120</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[publicly_accessible_sg].ingress.from_port is known</span>
<span><strong>Found:</strong> aws_security_group[publicly_accessible_sg].ingress.from_port is unknown and is exposed to the entire Internet</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">119</span><span class="code"> to_port = 65000</span></div><div class="code-line error"><span class="code-line-counter">120</span><span class="code"> cidr_blocks = ["0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">121</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 127</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[publicly_accessible_sg].ingress.from_port is known</span>
<span><strong>Found:</strong> aws_security_group[publicly_accessible_sg].ingress.from_port is unknown and is exposed to the entire Internet</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">126</span><span class="code"> to_port = 65000</span></div><div class="code-line error"><span class="code-line-counter">127</span><span class="code"> cidr_blocks = ["0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">128</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 135</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[publicly_accessible_sg].ingress.from_port is known</span>
<span><strong>Found:</strong> aws_security_group[publicly_accessible_sg].ingress.from_port is unknown and is exposed to the entire Internet</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">134</span><span class="code"> to_port = 65000</span></div><div class="code-line error"><span class="code-line-counter">135</span><span class="code"> cidr_blocks = ["0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">136</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Unrestricted Security Group Ingress</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">Security groups allow ingress from 0.0.0.0:0</span><span><a href="https://www.terraform.io/docs/providers/aws/r/security_group.html" rel="noopener" target="_blank">https://www.terraform.io/docs/providers/aws/r/security_group.html</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">6</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> One of 'ingress.cidr_blocks' not equal '0.0.0.0/0'</span>
<span><strong>Found:</strong> One of 'ingress.cidr_blocks' equal '0.0.0.0/0'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"> to_port = 64000</span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code"> cidr_blocks = ["0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 135</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> One of 'ingress.cidr_blocks' not equal '0.0.0.0/0'</span>
<span><strong>Found:</strong> One of 'ingress.cidr_blocks' equal '0.0.0.0/0'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">134</span><span class="code"> to_port = 65000</span></div><div class="code-line error"><span class="code-line-counter">135</span><span class="code"> cidr_blocks = ["0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">136</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 120</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> One of 'ingress.cidr_blocks' not equal '0.0.0.0/0'</span>
<span><strong>Found:</strong> One of 'ingress.cidr_blocks' equal '0.0.0.0/0'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">119</span><span class="code"> to_port = 65000</span></div><div class="code-line error"><span class="code-line-counter">120</span><span class="code"> cidr_blocks = ["0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">121</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_unused/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> One of 'ingress.cidr_blocks' not equal '0.0.0.0/0'</span>
<span><strong>Found:</strong> One of 'ingress.cidr_blocks' equal '0.0.0.0/0'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"> protocol = "tcp"</span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code"> cidr_blocks = ["0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 127</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> One of 'ingress.cidr_blocks' not equal '0.0.0.0/0'</span>
<span><strong>Found:</strong> One of 'ingress.cidr_blocks' equal '0.0.0.0/0'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">126</span><span class="code"> to_port = 65000</span></div><div class="code-line error"><span class="code-line-counter">127</span><span class="code"> cidr_blocks = ["0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">128</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 16</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> One of 'ingress.cidr_blocks' not equal '0.0.0.0/0'</span>
<span><strong>Found:</strong> One of 'ingress.cidr_blocks' equal '0.0.0.0/0'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">15</span><span class="code"> to_port = 65000</span></div><div class="code-line error"><span class="code-line-counter">16</span><span class="code"> cidr_blocks = ["0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">17</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">VPC Peering Route Table with Unrestricted CIDR</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">VPC Peering Route Table should restrict CIDR</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/route" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/route</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/over_exposed_vpc_peering/main.tf</strong>
<span>Line 164</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_route[subnet2_1].route restricts CIDR</span>
<span><strong>Found:</strong> aws_route[subnet2_1].route does not restrict CIDR</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">163</span><span class="code"> vpc_id = aws_vpc.vpc2.id</span></div><div class="code-line error"><span class="code-line-counter">164</span><span class="code"> route {</span></div><div class="code-line"><span class="code-line-counter">165</span><span class="code"> cidr_block = "0.0.0.0/0"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Viewer Protocol Policy Allows HTTP</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Checks if the connection between the CloudFront and the origin server is encrypted</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">6</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 100</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_cloudfront_distribution[s3_distribution].ordered_cache_behavior.viewer_protocol_policy is 'https-only' or 'redirect-to-https'</span>
<span><strong>Found:</strong> resource.aws_cloudfront_distribution[s3_distribution].ordered_cache_behavior.viewer_protocol_policy isn't 'https-only' or 'redirect-to-https'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">99</span><span class="code"> target_origin_id = local.s3_origin_id</span></div><div class="code-line error"><span class="code-line-counter">100</span><span class="code"> viewer_protocol_policy = "allow-all"</span></div><div class="code-line"><span class="code-line-counter">101</span><span class="code"></span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_protocol_version_is_low/main.tf</strong>
<span>Line 64</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_cloudfront_distribution[s3_distribution].default_cache_behavior.viewer_protocol_policy is 'https-only' or 'redirect-to-https'</span>
<span><strong>Found:</strong> resource.aws_cloudfront_distribution[s3_distribution].default_cache_behavior.viewer_protocol_policy isn't 'https-only' or 'redirect-to-https'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">63</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">64</span><span class="code"> viewer_protocol_policy = "allow-all"</span></div><div class="code-line"><span class="code-line-counter">65</span><span class="code"> min_ttl = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudfront_distribution_without_logging/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_cloudfront_distribution[s3_distribution].default_cache_behavior.viewer_protocol_policy is 'https-only' or 'redirect-to-https'</span>
<span><strong>Found:</strong> resource.aws_cloudfront_distribution[s3_distribution].default_cache_behavior.viewer_protocol_policy isn't 'https-only' or 'redirect-to-https'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code"> viewer_protocol_policy = "allow-all"</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> min_ttl = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudfront_not_using_waf/main.tf</strong>
<span>Line 50</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_cloudfront_distribution[s3_distribution].default_cache_behavior.viewer_protocol_policy is 'https-only' or 'redirect-to-https'</span>
<span><strong>Found:</strong> resource.aws_cloudfront_distribution[s3_distribution].default_cache_behavior.viewer_protocol_policy isn't 'https-only' or 'redirect-to-https'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">49</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">50</span><span class="code"> viewer_protocol_policy = "allow-all"</span></div><div class="code-line"><span class="code-line-counter">51</span><span class="code"> min_ttl = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 118</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_cloudfront_distribution[s3_distribution].ordered_cache_behavior.viewer_protocol_policy is 'https-only' or 'redirect-to-https'</span>
<span><strong>Found:</strong> resource.aws_cloudfront_distribution[s3_distribution].ordered_cache_behavior.viewer_protocol_policy isn't 'https-only' or 'redirect-to-https'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">117</span><span class="code"> target_origin_id = local.s3_origin_id</span></div><div class="code-line error"><span class="code-line-counter">118</span><span class="code"> viewer_protocol_policy = "allow-all"</span></div><div class="code-line"><span class="code-line-counter">119</span><span class="code"></span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 83</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_cloudfront_distribution[s3_distribution].default_cache_behavior.viewer_protocol_policy is 'https-only' or 'redirect-to-https'</span>
<span><strong>Found:</strong> resource.aws_cloudfront_distribution[s3_distribution].default_cache_behavior.viewer_protocol_policy isn't 'https-only' or 'redirect-to-https'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">82</span><span class="code"> target_origin_id = local.s3_origin_id</span></div><div class="code-line error"><span class="code-line-counter">83</span><span class="code"> viewer_protocol_policy = "allow-all"</span></div><div class="code-line"><span class="code-line-counter">84</span><span class="code"></span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Vulnerable Default SSL Certificate</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Defaults</span></span></div><div class="query-details"><span class="query-description-title">CloudFront web distributions should use custom (and not default) SSL certificates. Custom SSL certificates allow only defined users to access content by using an alternate domain name instead of the default one.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudfront_distribution_without_logging/main.tf</strong>
<span>Line 108</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'cloudfront_default_certificate' is 'false' or not defined</span>
<span><strong>Found:</strong> Attribute 'cloudfront_default_certificate' is 'true'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">107</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">108</span><span class="code"> viewer_certificate {</span></div><div class="code-line"><span class="code-line-counter">109</span><span class="code"> cloudfront_default_certificate = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_protocol_version_is_low/main.tf</strong>
<span>Line 128</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'cloudfront_default_certificate' is 'false' or not defined</span>
<span><strong>Found:</strong> Attribute 'cloudfront_default_certificate' is 'true'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">127</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">128</span><span class="code"> viewer_certificate {</span></div><div class="code-line"><span class="code-line-counter">129</span><span class="code"> cloudfront_default_certificate = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudfront_not_using_waf/main.tf</strong>
<span>Line 114</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'cloudfront_default_certificate' is 'false' or not defined</span>
<span><strong>Found:</strong> Attribute 'cloudfront_default_certificate' is 'true'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">113</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">114</span><span class="code"> viewer_certificate {</span></div><div class="code-line"><span class="code-line-counter">115</span><span class="code"> cloudfront_default_certificate = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 75</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'cloudfront_default_certificate' is 'false' or not defined</span>
<span><strong>Found:</strong> Attribute 'cloudfront_default_certificate' is 'true'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">74</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">75</span><span class="code"> viewer_certificate {</span></div><div class="code-line"><span class="code-line-counter">76</span><span class="code"> cloudfront_default_certificate = true</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Web App Accepting Traffic Other Than HTTPS</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Web app should only accept HTTPS traffic in Azure Web App Service.</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#https_only" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#https_only</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">9</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_http2_not_enabled/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].https_only' is set</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].https_only' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_win_java_isnot_latest/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].https_only' is set</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].https_only' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/app_service_use_most_recent_supported_tls/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].https_only' is set</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].https_only' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/webapp_client_cert_not_enabled/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].https_only' is set</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].https_only' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_php_isnot_latest/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].https_only' is set</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].https_only' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/app_service_authentication_missing/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].https_only' is set</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].https_only' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_lin_java_isnot_latest/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].https_only' is set</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].https_only' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/webapp_not_use_managedidentity/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].https_only' is set</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].https_only' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/app_service_ftps_unused/main.tf</strong>
<span>Line 36</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].https_only' is set</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].https_only' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">35</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">36</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">37</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Workspaces Workspace Volume Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">AWS Workspaces Workspace data stored in volumes should be encrypted</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/workspaces_workspace#root_volume_encryption_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/workspaces_workspace#root_volume_encryption_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workspace_root_volume_not_encrypted_at_rest/main.tf</strong>
<span>Line 84</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_workspaces_workspace.root_volume_encryption_enabled is set to true</span>
<span><strong>Found:</strong> aws_workspaces_workspace.root_volume_encryption_enabled is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">83</span><span class="code"> user_volume_size_gib = 10</span></div><div class="code-line error"><span class="code-line-counter">84</span><span class="code"> root_volume_size_gib = 80</span></div><div class="code-line"><span class="code-line-counter">85</span><span class="code"> running_mode = "AUTO_STOP"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workspace_root_volume_not_encrypted_at_rest/main.tf</strong>
<span>Line 83</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_workspaces_workspace.user_volume_encryption_enabled is set to true</span>
<span><strong>Found:</strong> aws_workspaces_workspace.user_volume_encryption_enabled is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">82</span><span class="code"> compute_type_name = "VALUE"</span></div><div class="code-line error"><span class="code-line-counter">83</span><span class="code"> user_volume_size_gib = 10</span></div><div class="code-line"><span class="code-line-counter">84</span><span class="code"> root_volume_size_gib = 80</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workspace_user_volume_not_encrypted_at_rest/main.tf</strong>
<span>Line 83</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_workspaces_workspace.user_volume_encryption_enabled is set to true</span>
<span><strong>Found:</strong> aws_workspaces_workspace.user_volume_encryption_enabled is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">82</span><span class="code"> compute_type_name = "VALUE"</span></div><div class="code-line error"><span class="code-line-counter">83</span><span class="code"> user_volume_size_gib = 10</span></div><div class="code-line"><span class="code-line-counter">84</span><span class="code"> root_volume_size_gib = 80</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workspace_user_volume_not_encrypted_at_rest/main.tf</strong>
<span>Line 84</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_workspaces_workspace.root_volume_encryption_enabled is set to true</span>
<span><strong>Found:</strong> aws_workspaces_workspace.root_volume_encryption_enabled is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">83</span><span class="code"> user_volume_size_gib = 10</span></div><div class="code-line error"><span class="code-line-counter">84</span><span class="code"> root_volume_size_gib = 80</span></div><div class="code-line"><span class="code-line-counter">85</span><span class="code"> running_mode = "AUTO_STOP"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ALB Is Not Integrated With WAF</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">All Application Load Balancers (ALB) must be protected with Web Application Firewall (WAF) service</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/wafregional_web_acl_association" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/wafregional_web_acl_association</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 39</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_lb[disabled]' is not 'internal' and has a 'aws_wafregional_web_acl_association' associated</span>
<span><strong>Found:</strong> 'aws_lb[disabled]' is not 'internal' and does not have a 'aws_wafregional_web_acl_association' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">38</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">39</span><span class="code">resource "aws_lb" "disabled" {</span></div><div class="code-line"><span class="code-line-counter">40</span><span class="code"> internal = false</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_lb[default]' is not 'internal' and has a 'aws_wafregional_web_acl_association' associated</span>
<span><strong>Found:</strong> 'aws_lb[default]' is not 'internal' and does not have a 'aws_wafregional_web_acl_association' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code">resource "aws_lb" "default" {</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> internal = false</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 48</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_alb[disabled]' is not 'internal' and has a 'aws_wafregional_web_acl_association' associated</span>
<span><strong>Found:</strong> 'aws_alb[disabled]' is not 'internal' and does not have a 'aws_wafregional_web_acl_association' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">47</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">48</span><span class="code">resource "aws_alb" "disabled" {</span></div><div class="code-line"><span class="code-line-counter">49</span><span class="code"> internal = false</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_alb[default]' is not 'internal' and has a 'aws_wafregional_web_acl_association' associated</span>
<span><strong>Found:</strong> 'aws_alb[default]' is not 'internal' and does not have a 'aws_wafregional_web_acl_association' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_alb" "default" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> internal = false</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/load_balancer_listener_http/main.tf</strong>
<span>Line 60</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_lb[alb_test]' is not 'internal' and has a 'aws_wafregional_web_acl_association' associated</span>
<span><strong>Found:</strong> 'aws_lb[alb_test]' is not 'internal' and does not have a 'aws_wafregional_web_acl_association' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">59</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">60</span><span class="code">resource "aws_lb" "alb_test" {</span></div><div class="code-line"><span class="code-line-counter">61</span><span class="code"> subnets = [aws_subnet.subnet1.id, aws_subnet.subnet2.id]</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ALB Not Dropping Invalid Headers</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">It's considered a best practice when using Application Load Balancers to drop invalid header fields</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">6</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 45</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lb[{{disabled}}].drop_invalid_header_fields is set to true</span>
<span><strong>Found:</strong> aws_lb[{{disabled}}].drop_invalid_header_fields is set to false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">44</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">45</span><span class="code"> drop_invalid_header_fields = false</span></div><div class="code-line"><span class="code-line-counter">46</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 49</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lb[{{test}}].drop_invalid_header_fields is set to true</span>
<span><strong>Found:</strong> aws_lb[{{test}}].drop_invalid_header_fields is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">48</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">49</span><span class="code">resource "aws_lb" "test" {</span></div><div class="code-line"><span class="code-line-counter">50</span><span class="code"> name = "test123"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_alb[{{default}}].drop_invalid_header_fields is set to true</span>
<span><strong>Found:</strong> aws_alb[{{default}}].drop_invalid_header_fields is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_alb" "default" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> internal = false</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 54</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_alb[{{disabled}}].drop_invalid_header_fields is set to true</span>
<span><strong>Found:</strong> aws_alb[{{disabled}}].drop_invalid_header_fields is set to false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">53</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">54</span><span class="code"> drop_invalid_header_fields = false</span></div><div class="code-line"><span class="code-line-counter">55</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lb[{{default}}].drop_invalid_header_fields is set to true</span>
<span><strong>Found:</strong> aws_lb[{{default}}].drop_invalid_header_fields is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code">resource "aws_lb" "default" {</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> internal = false</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/load_balancer_listener_http/main.tf</strong>
<span>Line 60</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lb[{{alb_test}}].drop_invalid_header_fields is set to true</span>
<span><strong>Found:</strong> aws_lb[{{alb_test}}].drop_invalid_header_fields is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">59</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">60</span><span class="code">resource "aws_lb" "alb_test" {</span></div><div class="code-line"><span class="code-line-counter">61</span><span class="code"> subnets = [aws_subnet.subnet1.id, aws_subnet.subnet2.id]</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">API Gateway Deployment Without Access Log Setting</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">API Gateway Deployment should have access log setting defined when connected to an API Gateway Stage.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_deployment" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_deployment</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_deployment[api_gw_deploy] has a 'aws_api_gateway_stage' resource associated with 'access_log_settings' set</span>
<span><strong>Found:</strong> aws_api_gateway_deployment[api_gw_deploy] doesn't have a 'aws_api_gateway_stage' resource associated with 'access_log_settings' set</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_api_gateway_deployment" "api_gw_deploy" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> depends_on = [aws_api_gateway_integration.api_gw_int]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 38</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_deployment[api_gw_deploy] has a 'aws_api_gateway_stage' resource associated with 'access_log_settings' set</span>
<span><strong>Found:</strong> aws_api_gateway_deployment[api_gw_deploy] doesn't have a 'aws_api_gateway_stage' resource associated with 'access_log_settings' set</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">37</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">38</span><span class="code">resource "aws_api_gateway_deployment" "api_gw_deploy" {</span></div><div class="code-line"><span class="code-line-counter">39</span><span class="code"> depends_on = [aws_api_gateway_integration.api_gw_int]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_deployment[api_gw_deploy] has a 'aws_api_gateway_stage' resource associated with 'access_log_settings' set</span>
<span><strong>Found:</strong> aws_api_gateway_deployment[api_gw_deploy] doesn't have a 'aws_api_gateway_stage' resource associated with 'access_log_settings' set</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_api_gateway_deployment" "api_gw_deploy" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> depends_on = [aws_api_gateway_integration.api_gw_int]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_deployment[api_gw_deploy] has a 'aws_api_gateway_stage' resource associated with 'access_log_settings' set</span>
<span><strong>Found:</strong> aws_api_gateway_deployment[api_gw_deploy] doesn't have a 'aws_api_gateway_stage' resource associated with 'access_log_settings' set</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_api_gateway_deployment" "api_gw_deploy" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> depends_on = [aws_api_gateway_integration.api_gw_int]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_deployment[api_gw_deploy] has a 'aws_api_gateway_stage' resource associated with 'access_log_settings' set</span>
<span><strong>Found:</strong> aws_api_gateway_deployment[api_gw_deploy] doesn't have a 'aws_api_gateway_stage' resource associated with 'access_log_settings' set</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_api_gateway_deployment" "api_gw_deploy" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> depends_on = [aws_api_gateway_integration.api_gw_int]</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">API Gateway Method Does Not Contains An API Key</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">An API Key should be required on a method request.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_api_gateway_method[api_gw_method].api_key_required is defined</span>
<span><strong>Found:</strong> resource.aws_api_gateway_method[api_gw_method].api_key_required is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource "aws_api_gateway_method" "api_gw_method" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> rest_api_id = aws_api_gateway_rest_api.api_gw.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_api_gateway_method[api_gw_method].api_key_required is defined</span>
<span><strong>Found:</strong> resource.aws_api_gateway_method[api_gw_method].api_key_required is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource "aws_api_gateway_method" "api_gw_method" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> rest_api_id = aws_api_gateway_rest_api.api_gw.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_api_gateway_method[api_gw_method].api_key_required is defined</span>
<span><strong>Found:</strong> resource.aws_api_gateway_method[api_gw_method].api_key_required is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource "aws_api_gateway_method" "api_gw_method" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> rest_api_id = aws_api_gateway_rest_api.api_gw.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 50</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_api_gateway_method[api_gw_method].api_key_required is defined</span>
<span><strong>Found:</strong> resource.aws_api_gateway_method[api_gw_method].api_key_required is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">49</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">50</span><span class="code">resource "aws_api_gateway_method" "api_gw_method" {</span></div><div class="code-line"><span class="code-line-counter">51</span><span class="code"> rest_api_id = aws_api_gateway_rest_api.api_gw.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> resource.aws_api_gateway_method[api_gw_method].api_key_required is defined</span>
<span><strong>Found:</strong> resource.aws_api_gateway_method[api_gw_method].api_key_required is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource "aws_api_gateway_method" "api_gw_method" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> rest_api_id = aws_api_gateway_rest_api.api_gw.id</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">API Gateway With CloudWatch Logging Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">AWS CloudWatch Logs for APIs is not enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_cloudwatch_log_group' is set</span>
<span><strong>Found:</strong> 'aws_cloudwatch_log_group' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 72</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_cloudwatch_log_group' is set</span>
<span><strong>Found:</strong> 'aws_cloudwatch_log_group' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">71</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">72</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">73</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_cloudwatch_log_group' is set</span>
<span><strong>Found:</strong> 'aws_cloudwatch_log_group' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_cloudwatch_log_group' is set</span>
<span><strong>Found:</strong> 'aws_cloudwatch_log_group' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_cloudwatch_log_group' is set</span>
<span><strong>Found:</strong> 'aws_cloudwatch_log_group' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">API Gateway With Open Access</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">API Gateway Method should restrict the authorization type, except for the HTTP OPTIONS method.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_method.authorization is only 'NONE' if http_method is 'OPTIONS'</span>
<span><strong>Found:</strong> aws_api_gateway_method[api_gw_method].authorization type is 'NONE' and http_method is not ''OPTIONS'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"> resource_id = aws_api_gateway_resource.api_gw_resource.id</span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code"> http_method = "GET"</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> authorization = "NONE"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_method.authorization is only 'NONE' if http_method is 'OPTIONS'</span>
<span><strong>Found:</strong> aws_api_gateway_method[api_gw_method].authorization type is 'NONE' and http_method is not ''OPTIONS'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"> resource_id = aws_api_gateway_resource.api_gw_resource.id</span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code"> http_method = "GET"</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> authorization = "NONE"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_method.authorization is only 'NONE' if http_method is 'OPTIONS'</span>
<span><strong>Found:</strong> aws_api_gateway_method[api_gw_method].authorization type is 'NONE' and http_method is not ''OPTIONS'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"> resource_id = aws_api_gateway_resource.api_gw_resource.id</span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code"> http_method = "GET"</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> authorization = "NONE"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 53</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_method.authorization is only 'NONE' if http_method is 'OPTIONS'</span>
<span><strong>Found:</strong> aws_api_gateway_method[api_gw_method].authorization type is 'NONE' and http_method is not ''OPTIONS'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">52</span><span class="code"> resource_id = aws_api_gateway_resource.api_gw_resource.id</span></div><div class="code-line error"><span class="code-line-counter">53</span><span class="code"> http_method = "GET"</span></div><div class="code-line"><span class="code-line-counter">54</span><span class="code"> authorization = "NONE"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_method.authorization is only 'NONE' if http_method is 'OPTIONS'</span>
<span><strong>Found:</strong> aws_api_gateway_method[api_gw_method].authorization type is 'NONE' and http_method is not ''OPTIONS'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"> resource_id = aws_api_gateway_resource.api_gw_resource.id</span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code"> http_method = "GET"</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> authorization = "NONE"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">API Gateway Without Configured Authorizer</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">API Gateway REST API should have an API Gateway Authorizer</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_authorizer" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_authorizer</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> API Gateway REST API is associated with an API Gateway Authorizer</span>
<span><strong>Found:</strong> API Gateway REST API is not associated with an API Gateway Authorizer</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_api_gateway_rest_api" "api_gw" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "api-gw-cache-non-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> API Gateway REST API is associated with an API Gateway Authorizer</span>
<span><strong>Found:</strong> API Gateway REST API is not associated with an API Gateway Authorizer</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_api_gateway_rest_api" "api_gw" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "api-gw-cache-non-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> API Gateway REST API is associated with an API Gateway Authorizer</span>
<span><strong>Found:</strong> API Gateway REST API is not associated with an API Gateway Authorizer</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_api_gateway_rest_api" "api_gw" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "api-gw-cache-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> API Gateway REST API is associated with an API Gateway Authorizer</span>
<span><strong>Found:</strong> API Gateway REST API is not associated with an API Gateway Authorizer</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_api_gateway_rest_api" "api_gw" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "api-gw-cache-non-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> API Gateway REST API is associated with an API Gateway Authorizer</span>
<span><strong>Found:</strong> API Gateway REST API is not associated with an API Gateway Authorizer</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_api_gateway_rest_api" "api_gw" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "api-gw-cache-non-encrypted"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">API Gateway Without Content Encoding</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Enable Content Encoding through the attribute 'minimum_compression_size'. This value should be greater than -1 and smaller than 10485760</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_rest_api" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_rest_api</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'minimum_compression_size' is set, greater than -1 and smaller than 10485760</span>
<span><strong>Found:</strong> Attribute 'minimum_compression_size' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_api_gateway_rest_api" "api_gw" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "api-gw-cache-non-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'minimum_compression_size' is set, greater than -1 and smaller than 10485760</span>
<span><strong>Found:</strong> Attribute 'minimum_compression_size' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_api_gateway_rest_api" "api_gw" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "api-gw-cache-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'minimum_compression_size' is set, greater than -1 and smaller than 10485760</span>
<span><strong>Found:</strong> Attribute 'minimum_compression_size' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_api_gateway_rest_api" "api_gw" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "api-gw-cache-non-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'minimum_compression_size' is set, greater than -1 and smaller than 10485760</span>
<span><strong>Found:</strong> Attribute 'minimum_compression_size' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_api_gateway_rest_api" "api_gw" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "api-gw-cache-non-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'minimum_compression_size' is set, greater than -1 and smaller than 10485760</span>
<span><strong>Found:</strong> Attribute 'minimum_compression_size' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_api_gateway_rest_api" "api_gw" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "api-gw-cache-non-encrypted"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">API Gateway Without SSL Certificate</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">SSL Client Certificate should be enabled in aws_api_gateway_stage resource</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#client_certificate_id" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#client_certificate_id</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'client_certificate_id' is set</span>
<span><strong>Found:</strong> Attribute 'client_certificate_id' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 72</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'client_certificate_id' is set</span>
<span><strong>Found:</strong> Attribute 'client_certificate_id' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">71</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">72</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">73</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'client_certificate_id' is set</span>
<span><strong>Found:</strong> Attribute 'client_certificate_id' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'client_certificate_id' is set</span>
<span><strong>Found:</strong> Attribute 'client_certificate_id' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'client_certificate_id' is set</span>
<span><strong>Found:</strong> Attribute 'client_certificate_id' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">API Gateway X-Ray Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">X-ray Tracing is not enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#xray_tracing_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#xray_tracing_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_api_gateway_stage[api_gw_stage].xray_tracing_enabled' is set</span>
<span><strong>Found:</strong> 'aws_api_gateway_stage[api_gw_stage].xray_tracing_enabled' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_api_gateway_stage[api_gw_stage].xray_tracing_enabled' is set</span>
<span><strong>Found:</strong> 'aws_api_gateway_stage[api_gw_stage].xray_tracing_enabled' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 72</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_api_gateway_stage[api_gw_stage].xray_tracing_enabled' is set</span>
<span><strong>Found:</strong> 'aws_api_gateway_stage[api_gw_stage].xray_tracing_enabled' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">71</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">72</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">73</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_api_gateway_stage[api_gw_stage].xray_tracing_enabled' is set</span>
<span><strong>Found:</strong> 'aws_api_gateway_stage[api_gw_stage].xray_tracing_enabled' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_api_gateway_stage[api_gw_stage].xray_tracing_enabled' is set</span>
<span><strong>Found:</strong> 'aws_api_gateway_stage[api_gw_stage].xray_tracing_enabled' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">API Gateway without WAF</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">API Gateway should have WAF (Web Application Firewall) enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/wafregional_web_acl_association#resource_arn" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/wafregional_web_acl_association#resource_arn</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> API Gateway Stage is associated with a Web Application Firewall</span>
<span><strong>Found:</strong> API Gateway Stage is not associated with a Web Application Firewall</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> API Gateway Stage is associated with a Web Application Firewall</span>
<span><strong>Found:</strong> API Gateway Stage is not associated with a Web Application Firewall</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 72</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> API Gateway Stage is associated with a Web Application Firewall</span>
<span><strong>Found:</strong> API Gateway Stage is not associated with a Web Application Firewall</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">71</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">72</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">73</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> API Gateway Stage is associated with a Web Application Firewall</span>
<span><strong>Found:</strong> API Gateway Stage is not associated with a Web Application Firewall</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> API Gateway Stage is associated with a Web Application Firewall</span>
<span><strong>Found:</strong> API Gateway Stage is not associated with a Web Application Firewall</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Api Gateway Access Logging Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">RDS does not have any kind of logger</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#access_log_settings" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#access_log_settings</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'access_log_settings' is defined</span>
<span><strong>Found:</strong> 'access_log_settings' is not defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'access_log_settings' is defined</span>
<span><strong>Found:</strong> 'access_log_settings' is not defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 72</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'access_log_settings' is defined</span>
<span><strong>Found:</strong> 'access_log_settings' is not defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">71</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">72</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">73</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'access_log_settings' is defined</span>
<span><strong>Found:</strong> 'access_log_settings' is not defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'access_log_settings' is defined</span>
<span><strong>Found:</strong> 'access_log_settings' is not defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Azure Cognitive Search Public Network Access Enabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">Public Network Access should be disabled for Azure Cognitive Search</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/search_service#public_network_access_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/search_service#public_network_access_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/search_diagnostic_not_enabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_search_service[search].public_network_access_enabled' is defined and set to false</span>
<span><strong>Found:</strong> 'azurerm_search_service[search].public_network_access_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_search_service" "search" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-search-service"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">CloudTrail Multi Region Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 3.1</sub></span>
<span class="query-description-title">Ensure CloudTrail is enabled in all regions</span>
<span class="cis-description-text">AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation).
The AWS API call history produced by CloudTrail enables security analysis, resource change tracking, and compliance auditing. Additionally, ensuring that a multi-regions trail exists will ensure that unexpected activity occurring in otherwise unused regions is detected ensuring that a multi-regions trail exists will ensure that Global Service Logging is enabled for a trail by default to capture recording of events generated onAWS global services for a multi-regions trail, ensuring that management events configured for all type of Read/Writes ensures recording of management operations that are performed on all resources in an AWS account </span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">6</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudtrail_enabled_on_multi_region/main.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[foobar].is_multi_region_trail is defined and not null</span>
<span><strong>Found:</strong> aws_cloudtrail[foobar].is_multi_region_trail is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"> name = "tf-trail-foobar"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudtrail_file_log_validation_disabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[foobar].include_global_service_events undefined or is set to true</span>
<span><strong>Found:</strong> aws_cloudtrail[foobar].include_global_service_events is set to false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"> s3_key_prefix = "prefix"</span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code"> include_global_service_events = false</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudtrail_enabled_on_multi_region/main.tf</strong>
<span>Line 7</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[foobar].include_global_service_events undefined or is set to true</span>
<span><strong>Found:</strong> aws_cloudtrail[foobar].include_global_service_events is set to false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">6</span><span class="code"> s3_key_prefix = "prefix"</span></div><div class="code-line error"><span class="code-line-counter">7</span><span class="code"> include_global_service_events = false</span></div><div class="code-line"><span class="code-line-counter">8</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudtrail_not_encrypted/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[foobar].include_global_service_events undefined or is set to true</span>
<span><strong>Found:</strong> aws_cloudtrail[foobar].include_global_service_events is set to false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"> s3_key_prefix = "prefix"</span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code"> include_global_service_events = false</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudtrail_not_encrypted/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[foobar].is_multi_region_trail is defined and not null</span>
<span><strong>Found:</strong> aws_cloudtrail[foobar].is_multi_region_trail is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudtrail_file_log_validation_disabled/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[foobar].is_multi_region_trail is defined and not null</span>
<span><strong>Found:</strong> aws_cloudtrail[foobar].is_multi_region_trail is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = local.name</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">CloudTrail Not Integrated With CloudWatch</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">CloudTrail should be integrated with CloudWatch</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">6</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudtrail_enabled_on_multi_region/main.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[foobar].cloud_watch_logs_role_arn is defined and not null</span>
<span><strong>Found:</strong> aws_cloudtrail[foobar].cloud_watch_logs_role_arn is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"> name = "tf-trail-foobar"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudtrail_file_log_validation_disabled/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[foobar].cloud_watch_logs_role_arn is defined and not null</span>
<span><strong>Found:</strong> aws_cloudtrail[foobar].cloud_watch_logs_role_arn is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudtrail_enabled_on_multi_region/main.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[foobar].cloud_watch_logs_group_arn is defined and not null</span>
<span><strong>Found:</strong> aws_cloudtrail[foobar].cloud_watch_logs_group_arn is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"> name = "tf-trail-foobar"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudtrail_not_encrypted/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[foobar].cloud_watch_logs_group_arn is defined and not null</span>
<span><strong>Found:</strong> aws_cloudtrail[foobar].cloud_watch_logs_group_arn is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudtrail_file_log_validation_disabled/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[foobar].cloud_watch_logs_group_arn is defined and not null</span>
<span><strong>Found:</strong> aws_cloudtrail[foobar].cloud_watch_logs_group_arn is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudtrail_not_encrypted/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[foobar].cloud_watch_logs_role_arn is defined and not null</span>
<span><strong>Found:</strong> aws_cloudtrail[foobar].cloud_watch_logs_role_arn is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = local.name</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">CloudTrail SNS Topic Name Undefined</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Check if SNS topic name is set for CloudTrail</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudtrail_not_encrypted/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_cloudtrail[foobar].sns_topic_name' is set and is not null</span>
<span><strong>Found:</strong> 'aws_cloudtrail[foobar].sns_topic_name' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudtrail_enabled_on_multi_region/main.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_cloudtrail[foobar].sns_topic_name' is set and is not null</span>
<span><strong>Found:</strong> 'aws_cloudtrail[foobar].sns_topic_name' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"> name = "tf-trail-foobar"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudtrail_file_log_validation_disabled/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_cloudtrail[foobar].sns_topic_name' is set and is not null</span>
<span><strong>Found:</strong> 'aws_cloudtrail[foobar].sns_topic_name' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = local.name</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">CloudWatch Logs Destination With Vulnerable Policy</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">CloudWatch Logs destination policy should avoid wildcard in 'principals' and 'actions'</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_destination_policy#access_policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_destination_policy#access_policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/cloudwatch_log_destination_insecure_policy/main.tf</strong>
<span>Line 87</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudwatch_log_destination_policy[test_destination_policy].access_policy does not have wildcard in 'principals' and 'actions'</span>
<span><strong>Found:</strong> aws_cloudwatch_log_destination_policy[test_destination_policy].access_policy has wildcard in 'principals' or 'actions'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">86</span><span class="code"> destination_name = aws_cloudwatch_log_destination.test_destination.name</span></div><div class="code-line error"><span class="code-line-counter">87</span><span class="code"> access_policy = data.aws_iam_policy_document.test_destination_policy.json</span></div><div class="code-line"><span class="code-line-counter">88</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">CloudWatch Metrics Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Checks if CloudWatch Metrics is Enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method_settings#metrics_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method_settings#metrics_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 55</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_method_settings[api_gw_method_sett].settings.metrics_enabled is defined and not null</span>
<span><strong>Found:</strong> aws_api_gateway_method_settings[api_gw_method_sett].settings.metrics_enabled is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">54</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">55</span><span class="code"> settings {</span></div><div class="code-line"><span class="code-line-counter">56</span><span class="code"> logging_level = "OFF"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 83</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_method_settings[api_gw_method_sett].settings.metrics_enabled is defined and not null</span>
<span><strong>Found:</strong> aws_api_gateway_method_settings[api_gw_method_sett].settings.metrics_enabled is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">82</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">83</span><span class="code"> settings {</span></div><div class="code-line"><span class="code-line-counter">84</span><span class="code"> logging_level = "OFF"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 55</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_method_settings[api_gw_method_sett].settings.metrics_enabled is defined and not null</span>
<span><strong>Found:</strong> aws_api_gateway_method_settings[api_gw_method_sett].settings.metrics_enabled is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">54</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">55</span><span class="code"> settings {</span></div><div class="code-line"><span class="code-line-counter">56</span><span class="code"> logging_level = "OFF"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 55</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_method_settings[api_gw_method_sett].settings.metrics_enabled is defined and not null</span>
<span><strong>Found:</strong> aws_api_gateway_method_settings[api_gw_method_sett].settings.metrics_enabled is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">54</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">55</span><span class="code"> settings {</span></div><div class="code-line"><span class="code-line-counter">56</span><span class="code"> logging_level = "OFF"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 55</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_method_settings[api_gw_method_sett].settings.metrics_enabled is defined and not null</span>
<span><strong>Found:</strong> aws_api_gateway_method_settings[api_gw_method_sett].settings.metrics_enabled is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">54</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">55</span><span class="code"> settings {</span></div><div class="code-line"><span class="code-line-counter">56</span><span class="code"> logging_level = "OFF"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">CloudWatch Without Retention Period Specified</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">AWS CloudWatch Log groups should have retention days specified</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudwatch_log_groups_no_retention/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'retention_in_days' is set and valid</span>
<span><strong>Found:</strong> Attribute 'retention_in_days' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_cloudwatch_log_group" "yada" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "Yada"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Cloudfront Logging Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">AWS Cloudfront distributions must be have logging enabled, which means the attribute 'logging_config' must be defined</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudfront_distribution_without_logging/main.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudfront_distribution[s3_distribution].logging_config is defined</span>
<span><strong>Found:</strong> aws_cloudfront_distribution[s3_distribution].logging_config is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code">resource "aws_cloudfront_distribution" "s3_distribution" {</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code"> origin {</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudfront_distribution[s3_distribution].logging_config is defined</span>
<span><strong>Found:</strong> aws_cloudfront_distribution[s3_distribution].logging_config is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_cloudfront_distribution" "s3_distribution" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> enabled = true</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">DOCDB Cluster Encrypted With AWS Managed Key</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">DOCDB Cluster should be encrypted with customer-managed KMS keys instead of AWS managed keys</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#kms_key_id" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#kms_key_id</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/docdb_cluster_encrypted_at_rest_using_cmk_not_customer_managed/main.tf</strong>
<span>Line 16</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> DOCDB Cluster is not encrypted with AWS managed key</span>
<span><strong>Found:</strong> DOCDB Cluster is encrypted with AWS managed key</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">15</span><span class="code"> storage_encrypted = true</span></div><div class="code-line error"><span class="code-line-counter">16</span><span class="code"> kms_key_id = data.aws_kms_key.test.arn</span></div><div class="code-line"><span class="code-line-counter">17</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Default VPC Exists</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">It isn't recommended to use resources in default VPC</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/default_vpc" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/default_vpc</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_ec2_to_default_vpc/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_default_vpc' should not exist</span>
<span><strong>Found:</strong> 'aws_default_vpc' exists</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code">resource "aws_default_vpc" "default" {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> tags = {</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">DynamoDB Table Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">AWS DynamoDB Tables should have server-side encryption</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#server_side_encryption" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#server_side_encryption</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 143</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_dynamodb_table.server_side_encryption.enabled is set to true</span>
<span><strong>Found:</strong> aws_dynamodb_table.server_side_encryption is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">142</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">143</span><span class="code">resource "aws_dynamodb_table" "basic-dynamodb-table" {</span></div><div class="code-line"><span class="code-line-counter">144</span><span class="code"> name = "GameScores"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/dynamodb_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_dynamodb_table.server_side_encryption.enabled is set to true</span>
<span><strong>Found:</strong> aws_dynamodb_table.server_side_encryption is missing</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_dynamodb_table" "basic-dynamodb-table" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "GameScores"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> billing_mode = "PROVISIONED"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 90</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_dynamodb_table.server_side_encryption.enabled is set to true</span>
<span><strong>Found:</strong> aws_dynamodb_table.server_side_encryption is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">89</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">90</span><span class="code">resource "aws_dynamodb_table" "basic-dynamodb-table" {</span></div><div class="code-line"><span class="code-line-counter">91</span><span class="code"> name = "GameScores"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/dynamodb_without_recovery_enabled/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_dynamodb_table.server_side_encryption.enabled is set to true</span>
<span><strong>Found:</strong> aws_dynamodb_table.server_side_encryption is missing</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_dynamodb_table" "basic-dynamodb-table" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "GameScores"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> billing_mode = "PROVISIONED"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">EBS Volume Encryption Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 2.2.1</sub></span>
<span class="query-description-title">Ensure EBS volume encryption is enabled</span>
<span class="cis-description-text">Elastic Compute Cloud (EC2) supports encryption at rest when using the Elastic Block Store (EBS) service. While disabled by default, forcing encryption at EBS volume creation is supported.
Encrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#encrypted" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#encrypted</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> One of 'aws_ebs_volume.encrypted' is defined</span>
<span><strong>Found:</strong> One of 'aws_ebs_volume.encrypted' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "aws_ebs_volume" "example" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> availability_zone = data.aws_availability_zones.available.names[0]</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ECR Image Tag Not Immutable</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">ECR should have an image tag be immutable</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ecr_make_tags_immutable/main.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecr_repository.foo.image_tag_mutability is 'IMMUTABLE'</span>
<span><strong>Found:</strong> aws_ecr_repository.foo.image_tag_mutability is 'MUTABLE'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "bar"</span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/ecr_not_secure_policy/main.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecr_repository.foo.image_tag_mutability is 'IMMUTABLE'</span>
<span><strong>Found:</strong> aws_ecr_repository.foo.image_tag_mutability is 'MUTABLE'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "bar"</span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ecr_use_image_scanning/main.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecr_repository.foo.image_tag_mutability is 'IMMUTABLE'</span>
<span><strong>Found:</strong> aws_ecr_repository.foo.image_tag_mutability is 'MUTABLE'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "bar"</span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ECR Repository Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">ECR (Elastic Container Registry) Repository encryption should be set</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#encryption_configuration" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#encryption_configuration</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/ecr_not_secure_policy/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attribute 'encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> The attribute 'encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_ecr_repository" "foo" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "bar"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ecr_use_image_scanning/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attribute 'encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> The attribute 'encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_ecr_repository" "foo" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "bar"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/ecr_repo_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attribute 'encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> The attribute 'encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_ecr_repository" "foo" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "bar"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "IMMUTABLE"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ecr_make_tags_immutable/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attribute 'encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> The attribute 'encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_ecr_repository" "foo" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "bar"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ElastiCache Redis Cluster Without Backup</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Backup</span></span></div><div class="query-details"><span class="query-description-title">ElastiCache Redis cluster should have 'snapshot_retention_limit' higher than 0</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#snapshot_retention_limit" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#snapshot_retention_limit</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/elasticache_automatic_backup/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'snapshot_retention_limit' is higher than 0</span>
<span><strong>Found:</strong> 'snapshot_retention_limit' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticache_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_id = "cluster"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "redis"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/elasticache_automatic_backup/main.tf</strong>
<span>Line 16</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'snapshot_retention_limit' is higher than 0</span>
<span><strong>Found:</strong> 'snapshot_retention_limit' is 0</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">15</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">16</span><span class="code"> snapshot_retention_limit = 0</span></div><div class="code-line"><span class="code-line-counter">17</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ElastiCache Replication Group Not Encrypted At Rest</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">ElastiCache Replication Group encryption should be enabled at Rest</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#at_rest_encryption_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#at_rest_encryption_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/elasticache_replication_group_not_encrypted_at_rest/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attribute 'at_rest_encryption_enabled' is set to true</span>
<span><strong>Found:</strong> The attribute 'at_rest_encryption_enabled' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticache_replication_group" "example" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> automatic_failover_enabled = true</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> availability_zones = ["us-west-2a", "us-west-2b"]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/elasticache_replication_group_not_encrypted_in_transit/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attribute 'at_rest_encryption_enabled' is set to true</span>
<span><strong>Found:</strong> The attribute 'at_rest_encryption_enabled' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_elasticache_replication_group" "example" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> automatic_failover_enabled = true</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ElastiCache Replication Group Not Encrypted At Transit</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">ElastiCache Replication Group encryption should be enabled at Transit</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#transit_encryption_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#transit_encryption_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/elasticache_replication_group_not_encrypted_in_transit/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attribute 'transit_encryption_enabled' is set to true</span>
<span><strong>Found:</strong> The attribute 'transit_encryption_enabled' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_elasticache_replication_group" "example" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> automatic_failover_enabled = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/elasticache_replication_group_not_encrypted_at_rest/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attribute 'transit_encryption_enabled' is set to true</span>
<span><strong>Found:</strong> The attribute 'transit_encryption_enabled' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticache_replication_group" "example" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> automatic_failover_enabled = true</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> availability_zones = ["us-west-2a", "us-west-2b"]</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ElasticSearch Not Encrypted At Rest</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Check if ElasticSearch encryption is disabled at Rest</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/elasticsearch_encrypt_node_to_node_disabled/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'encrypt_at_rest' is set and enabled</span>
<span><strong>Found:</strong> 'encrypt_at_rest' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_elasticsearch_domain" "example" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> domain_name = "cloudrail-non-enc-in-tran"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/elasticsearch_domain_logging_disabled/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'encrypt_at_rest' is set and enabled</span>
<span><strong>Found:</strong> 'encrypt_at_rest' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticsearch_domain" "example" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> domain_name = "example"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> elasticsearch_version = "1.5"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 107</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'encrypt_at_rest' is set and enabled</span>
<span><strong>Found:</strong> 'encrypt_at_rest' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">106</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">107</span><span class="code">resource "aws_elasticsearch_domain" "test" {</span></div><div class="code-line"><span class="code-line-counter">108</span><span class="code"> domain_name = "test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/elasticsearch_domain_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'encrypt_at_rest' is set and enabled</span>
<span><strong>Found:</strong> 'encrypt_at_rest' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_elasticsearch_domain" "es-not-secure-policy" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> domain_name = "es-not-secure-policy"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/elasticsearch_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'encrypt_at_rest' is set and enabled</span>
<span><strong>Found:</strong> 'encrypt_at_rest' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticsearch_domain" "example" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> domain_name = "example"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> elasticsearch_version = "1.5"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Elasticsearch Domain Not Encrypted Node To Node</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Elasticsearch Domain encryption should be enabled node to node</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#node_to_node_encryption" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#node_to_node_encryption</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 107</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attribute 'node_to_node_encryption' is set to true</span>
<span><strong>Found:</strong> The attribute 'node_to_node_encryption' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">106</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">107</span><span class="code">resource "aws_elasticsearch_domain" "test" {</span></div><div class="code-line"><span class="code-line-counter">108</span><span class="code"> domain_name = "test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/elasticsearch_domain_logging_disabled/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attribute 'node_to_node_encryption' is set to true</span>
<span><strong>Found:</strong> The attribute 'node_to_node_encryption' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticsearch_domain" "example" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> domain_name = "example"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> elasticsearch_version = "1.5"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/elasticsearch_domain_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attribute 'node_to_node_encryption' is set to true</span>
<span><strong>Found:</strong> The attribute 'node_to_node_encryption' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_elasticsearch_domain" "es-not-secure-policy" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> domain_name = "es-not-secure-policy"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/elasticsearch_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attribute 'node_to_node_encryption' is set to true</span>
<span><strong>Found:</strong> The attribute 'node_to_node_encryption' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticsearch_domain" "example" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> domain_name = "example"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> elasticsearch_version = "1.5"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/elasticsearch_encrypt_node_to_node_disabled/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attribute 'node_to_node_encryption' is set to true</span>
<span><strong>Found:</strong> The attribute 'node_to_node_encryption' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_elasticsearch_domain" "example" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> domain_name = "cloudrail-non-enc-in-tran"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Elasticsearch Domain With Vulnerable Policy</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Elasticsearch Domain policy should avoid wildcard in 'Action' and 'Principal'.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain_policy#access_policies" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain_policy#access_policies</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/elasticsearch_domain_not_secure_policy/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_elasticsearch_domain_policy[main].access_policies does not have wildcard in 'Action' and 'Principal'</span>
<span><strong>Found:</strong> aws_elasticsearch_domain_policy[main].access_policies has wildcard in 'Action' or 'Principal'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code"> access_policies = &lt;&lt;POLICIES</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code">{</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Elasticsearch Log is disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">AWS Elasticsearch should have logs enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#log_publishing_options" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#log_publishing_options</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/elasticsearch_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'log_publishing_options' is defined and not null</span>
<span><strong>Found:</strong> 'log_publishing_options' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticsearch_domain" "example" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> domain_name = "example"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> elasticsearch_version = "1.5"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/elasticsearch_encrypt_node_to_node_disabled/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'log_publishing_options' is defined and not null</span>
<span><strong>Found:</strong> 'log_publishing_options' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_elasticsearch_domain" "example" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> domain_name = "cloudrail-non-enc-in-tran"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/elasticsearch_domain_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'log_publishing_options' is defined and not null</span>
<span><strong>Found:</strong> 'log_publishing_options' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_elasticsearch_domain" "es-not-secure-policy" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> domain_name = "es-not-secure-policy"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/elasticsearch_domain_logging_disabled/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'log_publishing_options' is defined and not null</span>
<span><strong>Found:</strong> 'log_publishing_options' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticsearch_domain" "example" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> domain_name = "example"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> elasticsearch_version = "1.5"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 107</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'log_publishing_options' is defined and not null</span>
<span><strong>Found:</strong> 'log_publishing_options' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">106</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">107</span><span class="code">resource "aws_elasticsearch_domain" "test" {</span></div><div class="code-line"><span class="code-line-counter">108</span><span class="code"> domain_name = "test"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Elasticsearch Without IAM Authentication</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">AWS Elasticsearch should ensure IAM Authentication</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/elasticsearch_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Elasticsearch Domain has a policy associated</span>
<span><strong>Found:</strong> Elasticsearch Domain does not have a policy associated</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticsearch_domain" "example" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> domain_name = "example"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> elasticsearch_version = "1.5"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 107</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Elasticsearch Domain has a policy associated</span>
<span><strong>Found:</strong> Elasticsearch Domain does not have a policy associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">106</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">107</span><span class="code">resource "aws_elasticsearch_domain" "test" {</span></div><div class="code-line"><span class="code-line-counter">108</span><span class="code"> domain_name = "test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/elasticsearch_encrypt_node_to_node_disabled/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Elasticsearch Domain has a policy associated</span>
<span><strong>Found:</strong> Elasticsearch Domain does not have a policy associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_elasticsearch_domain" "example" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> domain_name = "cloudrail-non-enc-in-tran"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/elasticsearch_domain_logging_disabled/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Elasticsearch Domain has a policy associated</span>
<span><strong>Found:</strong> Elasticsearch Domain does not have a policy associated</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticsearch_domain" "example" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> domain_name = "example"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> elasticsearch_version = "1.5"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/elasticsearch_domain_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Elasticsearch Domain ensure IAM Authentication</span>
<span><strong>Found:</strong> Elasticsearch Domain does not ensure IAM Authentication</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_elasticsearch_domain" "es-not-secure-policy" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> domain_name = "es-not-secure-policy"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Email Alerts Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Make sure that alerts notifications are set to 'On' in the Azure Security Center Contact</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/email_notifications_for_high_severity_alerts_not_used/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_security_center_contact.example.alert_notifications' is true</span>
<span><strong>Found:</strong> 'azurerm_security_center_contact.example.alert_notifications' is false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code"> alert_notifications = false</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> alerts_to_admins = true</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Function App Client Certificates Unrequired</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Azure Function App should have 'client_cert_mode' set to required</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#client_cert_mode" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#client_cert_mode</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">9</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_latest_tls/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_win_java_isnot_latest/main.tf</strong>
<span>Line 46</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">45</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">46</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">47</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_http2/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_lin_java_isnot_latest/main.tf</strong>
<span>Line 37</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">36</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">37</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">38</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/func_app_ftps_not_required/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code">}</span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/func_app_authentication/main.tf</strong>
<span>Line 42</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">41</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">42</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">43</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_python_isnot_latest/main.tf</strong>
<span>Line 37</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">36</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">37</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">38</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/functionapp_not_use_managedidentity/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/func_app_client_cert_optional/main.tf</strong>
<span>Line 50</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is set to 'Required'</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].client_cert_mode' is not set to 'Required'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">49</span><span class="code"> storage_account_access_key = azurerm_storage_account.storacc.primary_access_key</span></div><div class="code-line error"><span class="code-line-counter">50</span><span class="code"> client_cert_mode = "Optional"</span></div><div class="code-line"><span class="code-line-counter">51</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Function App Managed Identity Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Azure Function App should have managed identity enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#identity" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#identity</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">9</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_python_isnot_latest/main.tf</strong>
<span>Line 37</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">36</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">37</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">38</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_latest_tls/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_http2/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_win_java_isnot_latest/main.tf</strong>
<span>Line 46</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">45</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">46</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">47</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/func_app_authentication/main.tf</strong>
<span>Line 42</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">41</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">42</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">43</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/functionapp_not_use_managedidentity/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_lin_java_isnot_latest/main.tf</strong>
<span>Line 37</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">36</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">37</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">38</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/func_app_client_cert_optional/main.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/func_app_ftps_not_required/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code">}</span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Glue With Vulnerable Policy</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Glue policy should avoid wildcard in 'principals' and 'actions'</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/glue_resource_policy#policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/glue_resource_policy#policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/glue_data_catalog_not_secure_policy/main.tf</strong>
<span>Line 68</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_glue_resource_policy[example].policy does not have wildcard in 'principals' and 'actions'</span>
<span><strong>Found:</strong> aws_glue_resource_policy[example].policy has wildcard in 'principals' or 'actions'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">67</span><span class="code">resource "aws_glue_resource_policy" "example" {</span></div><div class="code-line error"><span class="code-line-counter">68</span><span class="code"> policy = data.aws_iam_policy_document.glue-example-policy.json</span></div><div class="code-line"><span class="code-line-counter">69</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">IAM Access Analyzer Undefined</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">IAM Access Analyzer should be defined to identify unintentional access</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/accessanalyzer_analyzer" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/accessanalyzer_analyzer</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_accessanalyzer_analyzer' is set</span>
<span><strong>Found:</strong> 'aws_accessanalyzer_analyzer' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code">resource "aws_lb" "default" {</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> internal = false</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">IAM Policy Grants Full Permissions</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">IAM policies allow all ('*') in a statement action</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 81</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'policy.Statement.Resource' not equal '*'</span>
<span><strong>Found:</strong> 'policy.Statement.Resource' equal '*'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">80</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">81</span><span class="code"> policy = &lt;&lt;EOF</span></div><div class="code-line"><span class="code-line-counter">82</span><span class="code">{</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/iam_user_inline_policy_attach/main.tf</strong>
<span>Line 13</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'policy.Statement.Resource' not equal '*'</span>
<span><strong>Found:</strong> 'policy.Statement.Resource' equal '*'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">12</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">13</span><span class="code"> policy = &lt;&lt;EOF</span></div><div class="code-line"><span class="code-line-counter">14</span><span class="code">{</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/passrole_and_lambda_permissions_cause_priv_escalation/main.tf</strong>
<span>Line 29</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'policy.Statement.Resource' not equal '*'</span>
<span><strong>Found:</strong> 'policy.Statement.Resource' equal '*'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">28</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">29</span><span class="code"> policy = &lt;&lt;-EOF</span></div><div class="code-line"><span class="code-line-counter">30</span><span class="code"> {</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/policy-too-broad/main.tf</strong>
<span>Line 26</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'policy.Statement.Resource' not equal '*'</span>
<span><strong>Found:</strong> 'policy.Statement.Resource' equal '*'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">25</span><span class="code">resource "aws_iam_role_policy" "policy" {</span></div><div class="code-line error"><span class="code-line-counter">26</span><span class="code"> name = "policy"</span></div><div class="code-line"><span class="code-line-counter">27</span><span class="code"> role = aws_iam_role.role.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/passrole_and_lambda_permissions_cause_priv_escalation/main.tf</strong>
<span>Line 49</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'policy.Statement.Resource' not equal '*'</span>
<span><strong>Found:</strong> 'policy.Statement.Resource' equal '*'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">48</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">49</span><span class="code"> policy = &lt;&lt;-EOF</span></div><div class="code-line"><span class="code-line-counter">50</span><span class="code"> {</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">IAM Role Policy passRole Allows All</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Using the iam:passrole action with wildcards (*) in the resource can be overly permissive because it allows iam:passrole permissions on multiple resources</span><span><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html#access-analyzer-reference-policy-checks-security-warning-pass-role-with-star-in-resource" rel="noopener" target="_blank">https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html#access-analyzer-reference-policy-checks-security-warning-pass-role-with-star-in-resource</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/passrole_and_lambda_permissions_cause_priv_escalation/main.tf</strong>
<span>Line 29</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_iam_role_policy.policy.Statement.Action' iam:passrole doesn't have Resource '*'</span>
<span><strong>Found:</strong> 'aws_iam_role_policy.policy.Statement.Action' iam:passrole has Resource '*'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">28</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">29</span><span class="code"> policy = &lt;&lt;-EOF</span></div><div class="code-line"><span class="code-line-counter">30</span><span class="code"> {</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">IAM User With Access To Console</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">AWS IAM Users should not have access to console</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_login_profile" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_login_profile</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">6</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/hcl_language_complexity/using_for_each/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> each.value doesn't have aws_iam_user_login_profile</span>
<span><strong>Found:</strong> each.value has aws_iam_user_login_profile</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"> }</span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code"> name = each.value</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> path = "/"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/human_users_defined/main.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_user.iam_user_1.name doesn't have aws_iam_user_login_profile</span>
<span><strong>Found:</strong> aws_iam_user.iam_user_1.name has aws_iam_user_login_profile</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code">resource "aws_iam_user" "iam_user_1" {</span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code"> name = "iam_user_1"</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"></span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/hcl_language_complexity/using_locals/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> local.user_name doesn't have aws_iam_user_login_profile</span>
<span><strong>Found:</strong> local.user_name has aws_iam_user_login_profile</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code">locals {</span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> user_name = aws_iam_user.example.name</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/hcl_language_complexity/using_count_and_ternary_expr/main.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_user.jill.name doesn't have aws_iam_user_login_profile</span>
<span><strong>Found:</strong> aws_iam_user.jill.name has aws_iam_user_login_profile</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code">resource "aws_iam_user" "jill" {</span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code"> name = "jill"</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code"> path = "/"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/hcl_language_complexity/using_module_multi/mymodule/user.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_user.user.name doesn't have aws_iam_user_login_profile</span>
<span><strong>Found:</strong> aws_iam_user.user.name has aws_iam_user_login_profile</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"> count = var.allow_password ? 1 : 0</span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> user = aws_iam_user.user.name</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> pgp_key = var.pgp_key</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/hcl_language_complexity/using_count_and_ternary_expr/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_user.jack.name doesn't have aws_iam_user_login_profile</span>
<span><strong>Found:</strong> aws_iam_user.jack.name has aws_iam_user_login_profile</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code">resource "aws_iam_user" "jack" {</span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code"> name = "jack"</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> path = "/"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Instance With No VPC</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Instance should be configured in VPC (Virtual Private Cloud)</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">10</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 98</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'vpc_security_group_ids' is defined and not null</span>
<span><strong>Found:</strong> Attribute 'vpc_security_group_ids' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">97</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">98</span><span class="code">resource "aws_instance" "pub_ins" {</span></div><div class="code-line"><span class="code-line-counter">99</span><span class="code"> ami = "${data.aws_ami.ubuntu.id}"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 45</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'vpc_security_group_ids' is defined and not null</span>
<span><strong>Found:</strong> Attribute 'vpc_security_group_ids' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">44</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">45</span><span class="code">resource "aws_instance" "example_with_new_ami" {</span></div><div class="code-line"><span class="code-line-counter">46</span><span class="code"> ami = aws_ami.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/default_sg_in_new_vpc/main.tf</strong>
<span>Line 31</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'vpc_security_group_ids' is defined and not null</span>
<span><strong>Found:</strong> Attribute 'vpc_security_group_ids' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">30</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">31</span><span class="code">resource "aws_instance" "ec2" {</span></div><div class="code-line"><span class="code-line-counter">32</span><span class="code"> ami = "ami-07cda0db070313c52"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 93</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'vpc_security_group_ids' is defined and not null</span>
<span><strong>Found:</strong> Attribute 'vpc_security_group_ids' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">92</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">93</span><span class="code">resource "aws_instance" "example_with_ami_from_instance" {</span></div><div class="code-line"><span class="code-line-counter">94</span><span class="code"> ami = aws_ami_from_instance.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_ec2_to_default_vpc/main.tf</strong>
<span>Line 49</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'vpc_security_group_ids' is defined and not null</span>
<span><strong>Found:</strong> Attribute 'vpc_security_group_ids' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">48</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">49</span><span class="code">resource "aws_instance" "t2-instance" {</span></div><div class="code-line"><span class="code-line-counter">50</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 106</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'vpc_security_group_ids' is defined and not null</span>
<span><strong>Found:</strong> Attribute 'vpc_security_group_ids' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">105</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">106</span><span class="code">resource "aws_instance" "priv_ins" {</span></div><div class="code-line"><span class="code-line-counter">107</span><span class="code"> ami = "${data.aws_ami.ubuntu.id}"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 98</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'vpc_security_group_ids' is defined and not null</span>
<span><strong>Found:</strong> Attribute 'vpc_security_group_ids' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">97</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">98</span><span class="code">resource "aws_instance" "public-ubuntu-from-data" {</span></div><div class="code-line"><span class="code-line-counter">99</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 80</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'vpc_security_group_ids' is defined and not null</span>
<span><strong>Found:</strong> Attribute 'vpc_security_group_ids' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">79</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">80</span><span class="code">resource "aws_instance" "example_with_copied_ami" {</span></div><div class="code-line"><span class="code-line-counter">81</span><span class="code"> ami = aws_ami_copy.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ec2_ebs_not_optimized/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'vpc_security_group_ids' is defined and not null</span>
<span><strong>Found:</strong> Attribute 'vpc_security_group_ids' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "aws_instance" "web" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/ec2_without_monitoring/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'vpc_security_group_ids' is defined and not null</span>
<span><strong>Found:</strong> Attribute 'vpc_security_group_ids' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "aws_instance" "web" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Lambda Function Without Tags</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">AWS Lambda Functions must have associated tags.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/lambda_without_xray/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lambda_function[test_lambda].tags is defined and not null</span>
<span><strong>Found:</strong> aws_lambda_function[test_lambda].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code">resource "aws_lambda_function" "test_lambda" {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> filename = "lambda_function_payload.zip"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/lambda_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lambda_function[my-lambda].tags is defined and not null</span>
<span><strong>Found:</strong> aws_lambda_function[my-lambda].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_lambda_function" "my-lambda" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> filename = "~/Downloads/lambda.json.zip"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/lambda_not_in_vpc/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lambda_function[test_lambda].tags is defined and not null</span>
<span><strong>Found:</strong> aws_lambda_function[test_lambda].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code">resource "aws_lambda_function" "test_lambda" {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> filename = "lambda_function_payload.zip"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/lambda_without_explicit_log_group/main.tf</strong>
<span>Line 57</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lambda_function[test_lambda].tags is defined and not null</span>
<span><strong>Found:</strong> aws_lambda_function[test_lambda].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">56</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">57</span><span class="code">resource "aws_lambda_function" "test_lambda" {</span></div><div class="code-line"><span class="code-line-counter">58</span><span class="code"> filename = "${path.module}/Archive.zip"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Lambda With Vulnerable Policy</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">The attribute 'action' should not have wildcard</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission#action" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission#action</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/lambda_not_secure_policy/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lambda_permission[all].action does not have wildcard</span>
<span><strong>Found:</strong> aws_lambda_permission[all].action has wildcard</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"> statement_id = "AllowAllResources"</span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code"> action = "lambda:*"</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> function_name = aws_lambda_function.my-lambda.function_name</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">MSSQL Server Auditing Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Make sure that for MSSQL Servers, that 'Auditing' is set to 'On'</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/sql-server-audit-retention-30/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mssql_server.sql.extended_auditing_policy' exists</span>
<span><strong>Found:</strong> 'azurerm_mssql_server.sql.extended_auditing_policy' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code">resource "azurerm_mssql_server" "sql" {</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> name = "${local.resource_prefix}-sqlserver"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/public_access_sql_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mssql_server.my-sql-server.extended_auditing_policy' exists</span>
<span><strong>Found:</strong> 'azurerm_mssql_server.my-sql-server.extended_auditing_policy' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code">resource "azurerm_mssql_server" "my-sql-server" {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> name = "${local.resource_prefix}sqlserver"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/sql_server_audit_not_used/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mssql_server.sql.extended_auditing_policy' exists</span>
<span><strong>Found:</strong> 'azurerm_mssql_server.sql.extended_auditing_policy' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "azurerm_mssql_server" "sql" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> name = "${local.resource_prefix}-sqlserver"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/sql-server-ad-admin-not-set/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mssql_server.sql.extended_auditing_policy' exists</span>
<span><strong>Found:</strong> 'azurerm_mssql_server.sql.extended_auditing_policy' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "azurerm_mssql_server" "sql" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> name = "${local.resource_prefix}-sqlserver"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/at-rest/sql_encryption_customer_key_not_set/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mssql_server.sql.extended_auditing_policy' exists</span>
<span><strong>Found:</strong> 'azurerm_mssql_server.sql.extended_auditing_policy' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_mssql_server" "sql" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-sqlserver"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Neptune Cluster With IAM Database Authentication Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Neptune Cluster should have IAM Database Authentication enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 66</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'iam_database_authentication_enabled' is set to true</span>
<span><strong>Found:</strong> 'iam_database_authentication_enabled' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">65</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">66</span><span class="code">resource "aws_neptune_cluster" "encrypted_neptune_cluster" {</span></div><div class="code-line"><span class="code-line-counter">67</span><span class="code"> cluster_identifier = "cloudrail-test-encrypted"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Neptune Database Cluster Encryption Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Check if Neptune Cluster Storage is securely encrypted</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/neptune_cluster_no_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'storage_encrypted' should be set with value true</span>
<span><strong>Found:</strong> 'storage_encrypted' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_neptune_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "neptune-cluster-demo"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "neptune"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/neptune_cluster_no_encryption/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'storage_encrypted' should be set with value true</span>
<span><strong>Found:</strong> 'storage_encrypted' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_neptune_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "neptune-cluster-demo"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "neptune"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Policy Without Principal</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">All policies, except IAM identity-based policies, should have the 'Principal' element defined</span><span><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_principal.html" rel="noopener" target="_blank">https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_principal.html</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/glue_data_catalog_not_secure_policy/main.tf</strong>
<span>Line 68</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'Principal' is set</span>
<span><strong>Found:</strong> 'Principal' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">67</span><span class="code">resource "aws_glue_resource_policy" "example" {</span></div><div class="code-line error"><span class="code-line-counter">68</span><span class="code"> policy = data.aws_iam_policy_document.glue-example-policy.json</span></div><div class="code-line"><span class="code-line-counter">69</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/policy_missing_principal/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'Principal' is set</span>
<span><strong>Found:</strong> 'Principal' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code"> policy = &lt;&lt;EOF</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code">{</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">PostgreSQL Log Checkpoints Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Make sure that for Postgre SQL Database Server, parameter 'log_checkpoints' is set to 'ON'</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/postgresql_logcheckpoints_not_enabled/main.tf</strong>
<span>Line 33</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_configuration.example.value' should be 'ON'</span>
<span><strong>Found:</strong> 'azurerm_postgresql_configuration.example.value' is 'OFF'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">32</span><span class="code"> server_name = azurerm_postgresql_server.example.name</span></div><div class="code-line error"><span class="code-line-counter">33</span><span class="code"> value = "off"</span></div><div class="code-line"><span class="code-line-counter">34</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">PostgreSQL Log Connections Not Set</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Make sure that for PostgreSQL Database, server parameter 'log_connections' is set to 'ON'</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/postgresql_log_connections_not_enabled/main.tf</strong>
<span>Line 33</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_configuration.example.value' is 'ON'</span>
<span><strong>Found:</strong> 'azurerm_postgresql_configuration.example.value' is 'OFF'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">32</span><span class="code"> server_name = azurerm_postgresql_server.example.name</span></div><div class="code-line error"><span class="code-line-counter">33</span><span class="code"> value = "off"</span></div><div class="code-line"><span class="code-line-counter">34</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">PostgreSQL Log Disconnections Not Set</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Make sure that for PostgreSQL Database, server parameter 'log_disconnections' is set to 'ON'</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/postgresql_log_disconnections_not_enabled/main.tf</strong>
<span>Line 33</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_configuration.example.value' is 'ON'</span>
<span><strong>Found:</strong> 'azurerm_postgresql_configuration.example.value' is 'OFF'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">32</span><span class="code"> server_name = azurerm_postgresql_server.example.name</span></div><div class="code-line error"><span class="code-line-counter">33</span><span class="code"> value = "off"</span></div><div class="code-line"><span class="code-line-counter">34</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Public and Private EC2 Share Role</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Public and private EC2 istances should not share the same role.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#iam_instance_profile" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#iam_instance_profile</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 102</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Public and private instances do not share the same role</span>
<span><strong>Found:</strong> Public and private instances share the same role</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">101</span><span class="code"> subnet_id = module.vpc.public_subnets[0]</span></div><div class="code-line error"><span class="code-line-counter">102</span><span class="code"> iam_instance_profile = aws_iam_instance_profile.test_profile.name</span></div><div class="code-line"><span class="code-line-counter">103</span><span class="code"></span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">RDS Cluster With Backup Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">RDS Cluster backup retention period should be specifically defined</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#backup_retention_period" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#backup_retention_period</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/rds_retention_period_set/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_rds_cluster.backup_retention_period is defined and not null</span>
<span><strong>Found:</strong> aws_rds_cluster.backup_retention_period is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_rds_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "aurora-cluster-demo"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "aurora-mysql"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rds_cluster_encrypt_at_rest_disabled/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_rds_cluster.backup_retention_period is defined and not null</span>
<span><strong>Found:</strong> aws_rds_cluster.backup_retention_period is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_rds_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "cloudrail-test-non-encrypted"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">RDS With Backup Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Backup</span></span></div><div class="query-details"><span class="query-description-title">RDS configured without backup</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rds_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'backup_retention_period' exists</span>
<span><strong>Found:</strong> 'backup_retention_period' is missing</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_db_instance" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> allocated_storage = 10</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "mysql"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rds_without_authentication/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'backup_retention_period' exists</span>
<span><strong>Found:</strong> 'backup_retention_period' is missing</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_db_instance" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> allocated_storage = 10</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "mysql"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 113</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'backup_retention_period' exists</span>
<span><strong>Found:</strong> 'backup_retention_period' is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">112</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">113</span><span class="code">resource "aws_db_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">114</span><span class="code"> identifier = "tf-test-db"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 60</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'backup_retention_period' exists</span>
<span><strong>Found:</strong> 'backup_retention_period' is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">59</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">60</span><span class="code">resource "aws_db_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">61</span><span class="code"> instance_class = "db.t3.micro"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Redshift Cluster Logging Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Make sure Logging is enabled for Redshift Cluster</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#enable" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#enable</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 103</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_redshift_cluster.logging' is true</span>
<span><strong>Found:</strong> 'aws_redshift_cluster.logging' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">102</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">103</span><span class="code">resource "aws_redshift_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">104</span><span class="code"> cluster_identifier = "redshift-defaults-only"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/redshift_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_redshift_cluster.logging' is true</span>
<span><strong>Found:</strong> 'aws_redshift_cluster.logging' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_redshift_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "tf-redshift-cluster"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> database_name = "mydb"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_redshift_in_ec2_classic_mode/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_redshift_cluster.logging' is true</span>
<span><strong>Found:</strong> 'aws_redshift_cluster.logging' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_redshift_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "redshift-defaults-only"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/redshift_not_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_redshift_cluster.logging' is true</span>
<span><strong>Found:</strong> 'aws_redshift_cluster.logging' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_redshift_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "tf-redshift-cluster"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Redshift Cluster Without VPC</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Redshift Cluster should be configured in VPC (Virtual Private Cloud)</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#vpc_security_group_ids" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#vpc_security_group_ids</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">6</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/redshift_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster[default].vpc_security_group_ids is set</span>
<span><strong>Found:</strong> aws_redshift_cluster[default].vpc_security_group_ids is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_redshift_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "tf-redshift-cluster"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> database_name = "mydb"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/redshift_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster[default].cluster_subnet_group_name is set</span>
<span><strong>Found:</strong> aws_redshift_cluster[default].cluster_subnet_group_name is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_redshift_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "tf-redshift-cluster"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> database_name = "mydb"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/redshift_not_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster[default].vpc_security_group_ids is set</span>
<span><strong>Found:</strong> aws_redshift_cluster[default].vpc_security_group_ids is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_redshift_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "tf-redshift-cluster"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/redshift_not_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster[default].cluster_subnet_group_name is set</span>
<span><strong>Found:</strong> aws_redshift_cluster[default].cluster_subnet_group_name is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_redshift_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "tf-redshift-cluster"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_redshift_in_ec2_classic_mode/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster[test].cluster_subnet_group_name is set</span>
<span><strong>Found:</strong> aws_redshift_cluster[test].cluster_subnet_group_name is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_redshift_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "redshift-defaults-only"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_redshift_in_ec2_classic_mode/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster[test].vpc_security_group_ids is set</span>
<span><strong>Found:</strong> aws_redshift_cluster[test].vpc_security_group_ids is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_redshift_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "redshift-defaults-only"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Role Definition Allows Custom Role Creation</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Role Definition should not allow custom role creation</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_definition#actions" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_definition#actions</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/custom-role-owner-exists/main.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> azurerm_role_definition[example].permissions.actions does not allow custom role creation</span>
<span><strong>Found:</strong> azurerm_role_definition[example].permissions.actions allows custom role creation</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"> permissions {</span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code"> actions = ["*"]</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> not_actions = []</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">S3 Bucket Policy Accepts HTTP Requests</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">S3 Bucket policy should not accept HTTP Requests</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_policy#policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_policy#policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 13</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[cdn-content].policy does not accept HTTP Requests</span>
<span><strong>Found:</strong> aws_s3_bucket[cdn-content].policy accepts HTTP Requests</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">12</span><span class="code"> acl = "private"</span></div><div class="code-line error"><span class="code-line-counter">13</span><span class="code"> policy = &lt;&lt;POLICY</span></div><div class="code-line"><span class="code-line-counter">14</span><span class="code">{</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudtrail_file_log_validation_disabled/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[foo].policy does not accept HTTP Requests</span>
<span><strong>Found:</strong> aws_s3_bucket[foo].policy accepts HTTP Requests</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code"> policy = &lt;&lt;POLICY</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code">{</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudtrail_not_encrypted/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[foo].policy does not accept HTTP Requests</span>
<span><strong>Found:</strong> aws_s3_bucket[foo].policy accepts HTTP Requests</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code"> policy = &lt;&lt;POLICY</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code">{</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_policy_public_to_all_authenticated_users/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket_policy[bucket_2_policy].policy does not accept HTTP Requests</span>
<span><strong>Found:</strong> aws_s3_bucket_policy[bucket_2_policy].policy accepts HTTP Requests</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> policy = &lt;&lt;POLICY</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code">{</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudtrail_enabled_on_multi_region/main.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[foo].policy does not accept HTTP Requests</span>
<span><strong>Found:</strong> aws_s3_bucket[foo].policy accepts HTTP Requests</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code"> policy = &lt;&lt;POLICY</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code">{</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">S3 Bucket Without Versioning</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">S3 bucket should have versioning enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">19</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned_with_overriding_access_block/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-3"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_authenticated_users_canned/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/athena_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "hoge" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "hoge"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_policy_public_to_all_authenticated_users/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-policy-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudtrail_not_encrypted/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_protocol_version_is_low/main.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code">resource "aws_s3_bucket" "dist" {</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code"> bucket = "dist-cloud-test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/s3_access_logging_disabled/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "b" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "my-tf-test-bucket"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> acl = "private"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workgroups_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "cloudrail_anthena_bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "cloudrail-wg-encrypted-sse-s3"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_protocol_version_is_low/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "logging" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "dist-cloud-test-logs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/s3_bucket_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "cloudrail-non-encrypted-czx7zxchs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudtrail_file_log_validation_disabled/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudfront_distribution_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "b" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "mybucket"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> acl = "private"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/s3_bucket_object_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "cloudrail-non-encrypted-czx7zxchs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workgroups_non_encrypted/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_s3_bucket" "cloudrail_anthena_bucket_2" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> bucket = "cloudrail-wg-encrypted-sse-s3-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudfront_not_using_waf/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "b" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "mybucket"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> acl = "private"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_s3_bucket" "cdn-content" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudtrail_enabled_on_multi_region/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> bucket = "tf-test-trail"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/glue_data_catalog_not_secure_policy/main.tf</strong>
<span>Line 33</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">32</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">33</span><span class="code">resource "aws_s3_bucket" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">34</span><span class="code"> bucket = "cloudrail-glue"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">SNS Topic Encrypted With AWS Managed Key</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">SNS (Simple Notification Service) Topic should be encrypted with customer-managed KMS keys instead of AWS managed keys</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#kms_master_key_id" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#kms_master_key_id</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/sns_topic_encrypted_at_rest_with_aws_managed_key_by_key_arn/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SNS Topic is not encrypted with AWS managed key</span>
<span><strong>Found:</strong> SNS Topic is encrypted with AWS managed key</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"> name = "sns_ecnrypted"</span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code"> kms_master_key_id = data.aws_kms_key.by_alias.arn</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">SNS Topic Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">SNS (Simple Notification Service) Topic should be encrypted</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#kms_master_key_id" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#kms_master_key_id</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/tag_all_items/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SNS Topic is encrypted</span>
<span><strong>Found:</strong> SNS Topic is not encrypted</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_sns_topic" "cloudrail_1" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "sns_not_ecnrypted-1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/tag_all_items/plan.json</strong>
<span>Line 8</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SNS Topic is encrypted</span>
<span><strong>Found:</strong> SNS Topic is not encrypted</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">7</span><span class="code"> {</span></div><div class="code-line error"><span class="code-line-counter">8</span><span class="code"> "address": "aws_sns_topic.cloudrail_1",</span></div><div class="code-line"><span class="code-line-counter">9</span><span class="code"> "mode": "managed",</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/glacier_vault_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> SNS Topic is encrypted</span>
<span><strong>Found:</strong> SNS Topic is not encrypted</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_sns_topic" "aws_sns_topic" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "glacier-sns-topic"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">SQL Analysis Services Port 2383 (TCP) Is Publicly Accessible</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">Check if port 2383 on TCP is publicly accessible by checking the CIDR block range that can access it.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group doesn't openSQL Analysis Services Port 2383</span>
<span><strong>Found:</strong> aws_security_group opens SQL Analysis Services Port 2383</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group doesn't openSQL Analysis Services Port 2383</span>
<span><strong>Found:</strong> aws_security_group opens SQL Analysis Services Port 2383</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group doesn't openSQL Analysis Services Port 2383</span>
<span><strong>Found:</strong> aws_security_group opens SQL Analysis Services Port 2383</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">SQL Server Auditing Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Make sure that for SQL Servers, 'Auditing' is set to 'On'</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_server" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_server</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/sql_vulnerability_assessment_not_enabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_sql_server.sql.extended_auditing_policy' exists</span>
<span><strong>Found:</strong> 'azurerm_sql_server.sql.extended_auditing_policy' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_sql_server" "sql" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-sqlserver"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/sql_vulnerability_email_not_set/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_sql_server.sql.extended_auditing_policy' exists</span>
<span><strong>Found:</strong> 'azurerm_sql_server.sql.extended_auditing_policy' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_sql_server" "sql" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-sqlserver"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">SQS VPC Endpoint Without DNS Resolution</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">SQS VPC Endpoint should have DNS resolution enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc#enable_dns_support" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc#enable_dns_support</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 95</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'enable_dns_support' is set to true or undefined</span>
<span><strong>Found:</strong> 'enable_dns_support' is set to false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">94</span><span class="code">resource "aws_vpc_endpoint" "sqs-vpc-endpoint" {</span></div><div class="code-line error"><span class="code-line-counter">95</span><span class="code"> vpc_id = aws_vpc.main.id</span></div><div class="code-line"><span class="code-line-counter">96</span><span class="code"> service_name = "com.amazonaws.${local.region}.sqs"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Secrets Manager With Vulnerable Policy</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Secrets Manager policy should avoid wildcard in 'Principal' and 'Action'</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret_policy#policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret_policy#policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/secrets_manager_not_secure_policy/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_secretsmanager_secret_policy[example].policy does not have wildcard in 'Principal' and 'Action'</span>
<span><strong>Found:</strong> aws_secretsmanager_secret_policy[example].policy has wildcard in 'Principal' or 'Action'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> policy = &lt;&lt;POLICY</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code">{</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Secretsmanager Secret Encrypted With AWS Managed Key</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Secrets Manager secret should be encrypted with customer-managed KMS keys instead of AWS managed keys</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret#kms_key_id" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret#kms_key_id</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/secretsmanager_secrets_encrypted_at_rest_with_aws_managed_key_by_key_arn/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Secrets Manager secret is not encrypted with AWS managed key</span>
<span><strong>Found:</strong> Secrets Manager secret is encrypted with AWS managed key</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"> name = "test-cloudrail-1"</span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code"> kms_key_id = data.aws_kms_key.by_alias.arn</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Secretsmanager Secret Without KMS</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">AWS Secretmanager should use AWS KMS customer master key (CMK) to encrypt the secret values in the versions stored in the secret</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret#kms_key_id" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret#kms_key_id</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/secretsmanager_secrets_encrypted_at_rest_with_aws_managed_key_by_default/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_secretsmanager_secret.kms_key_id is defined and not null</span>
<span><strong>Found:</strong> aws_secretsmanager_secret.kms_key_id is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_secretsmanager_secret" "test" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "test-cloudrail"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/secrets_manager_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_secretsmanager_secret.kms_key_id is defined and not null</span>
<span><strong>Found:</strong> aws_secretsmanager_secret.kms_key_id is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_secretsmanager_secret" "not_secure_policy" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "not_secure_secret"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Security Center Pricing Tier Is Not Standard</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Make sure that the 'Standard' pricing tiers were selected.</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_subscription_pricing" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_subscription_pricing</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">7</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/defender_for_storage_not_used/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_security_center_subscription_pricing.example.tier' is 'Standard'</span>
<span><strong>Found:</strong> 'azurerm_security_center_subscription_pricing.example.tier' is 'Free'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code">resource "azurerm_security_center_subscription_pricing" "example" {</span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code"> tier = "Free"</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> resource_type = "StorageAccounts"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/defender_for_servers_not_used/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_security_center_subscription_pricing.example.tier' is 'Standard'</span>
<span><strong>Found:</strong> 'azurerm_security_center_subscription_pricing.example.tier' is 'Free'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code">resource "azurerm_security_center_subscription_pricing" "example" {</span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code"> tier = "Free"</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> resource_type = "VirtualMachines"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/defender_for_sql_servers_not_used/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_security_center_subscription_pricing.example.tier' is 'Standard'</span>
<span><strong>Found:</strong> 'azurerm_security_center_subscription_pricing.example.tier' is 'Free'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code">resource "azurerm_security_center_subscription_pricing" "example" {</span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code"> tier = "Free"</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> resource_type = "SqlServers"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/defender_for_app_services_disabled/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_security_center_subscription_pricing.example.tier' is 'Standard'</span>
<span><strong>Found:</strong> 'azurerm_security_center_subscription_pricing.example.tier' is 'Free'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code">resource "azurerm_security_center_subscription_pricing" "example" {</span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code"> tier = "Free"</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> resource_type = "AppServices"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/defender_for_keyvault_disabled/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_security_center_subscription_pricing.example.tier' is 'Standard'</span>
<span><strong>Found:</strong> 'azurerm_security_center_subscription_pricing.example.tier' is 'Free'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code">resource "azurerm_security_center_subscription_pricing" "example" {</span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code"> tier = "Free"</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> resource_type = "KeyVaults"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/defender_for_kubernetes_not_used/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_security_center_subscription_pricing.example.tier' is 'Standard'</span>
<span><strong>Found:</strong> 'azurerm_security_center_subscription_pricing.example.tier' is 'Free'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code">resource "azurerm_security_center_subscription_pricing" "example" {</span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code"> tier = "Free"</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> resource_type = "KubernetesService"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/defender_for_container_registry_not_used/main.tf</strong>
<span>Line 19</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_security_center_subscription_pricing.example.tier' is 'Standard'</span>
<span><strong>Found:</strong> 'azurerm_security_center_subscription_pricing.example.tier' is 'Free'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">18</span><span class="code">resource "azurerm_security_center_subscription_pricing" "example" {</span></div><div class="code-line error"><span class="code-line-counter">19</span><span class="code"> tier = "Free"</span></div><div class="code-line"><span class="code-line-counter">20</span><span class="code"> resource_type = "ContainerRegistry"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Sensitive Port Is Exposed To Wide Private Network</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">A sensitive port, such as port 23 or port 110, is open for a wide private network in either TCP or UDP protocol</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_rules/main.tf</strong>
<span>Line 19</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HTTPS (TCP:443) should not be allowed</span>
<span><strong>Found:</strong> HTTPS (TCP:443) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">18</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">19</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">20</span><span class="code"> from_port = 443</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_security_group/main.tf</strong>
<span>Line 19</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> HTTPS (TCP:443) should not be allowed</span>
<span><strong>Found:</strong> HTTPS (TCP:443) is allowed</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">18</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">19</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">20</span><span class="code"> description = "This is an inbound rule for something...."</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Storage Account Not Using Latest TLS Encryption Version</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Ensure Storage Account is using the latest version of TLS encryption</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">20</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_win_java_isnot_latest/main.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> name = "${local.resource_prefix}funcapptstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/sql_vulnerability_email_not_set/main.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[example].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[example].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code">resource "azurerm_storage_account" "example" {</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> name = "${local.resource_prefix}tststoracc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/func_app_authentication/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> name = "myfuncappstorageaccount"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/storage_account_public_access_disabled/main.tf</strong>
<span>Line 16</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">15</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">16</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">17</span><span class="code"> name = "${local.resource_prefix}tststacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/vmss_unmanaged_disks/main.tf</strong>
<span>Line 41</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">40</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">41</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">42</span><span class="code"> name = "${local.resource_prefix}tstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_latest_tls/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}funcapptstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/at-rest/storacc_encryption_not_enabled/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> name = "${local.resource_prefix}tststacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/vmss_win_diagnostic_log_disabled/main.tf</strong>
<span>Line 41</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">40</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">41</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">42</span><span class="code"> name = "${local.resource_prefix}tstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/iot_hub_diagnostic_not_enabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}tststacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_lin_java_isnot_latest/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}funcapptstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/at-rest/activitylog_storage_account_encryption_not_enabled/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> name = "${local.resource_prefix}tststacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/func_app_ftps_not_required/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code">}</span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = "myfuncappstorageaccount"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_python_isnot_latest/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}funappsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/func_app_client_cert_optional/main.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code"> name = local.resource_prefix</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/batch_diagnostic_disabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}batchstacc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/vm_unmanaged_disks/main.tf</strong>
<span>Line 42</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">41</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">42</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">43</span><span class="code"> name = "${local.resource_prefix}tstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/public_access_sql_db/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[my-storage-account].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[my-storage-account].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "azurerm_storage_account" "my-storage-account" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> name = "${local.resource_prefix}storageaccount"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/functionapp_not_use_managedidentity/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}funcapptstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_http2/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[storacc].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[storacc].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_storage_account" "storacc" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}functionapptstsa"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/sql-server-audit-retention-30/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[example].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[example].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "azurerm_storage_account" "example" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> name = "${local.resource_prefix}tststacc"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Unscanned ECR Image</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Checks if the ECR Image has been scanned</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#scan_on_push" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#scan_on_push</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ecr_use_image_scanning/main.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecr_repository[foo].image_scanning_configuration.scan_on_push is true</span>
<span><strong>Found:</strong> aws_ecr_repository[foo].image_scanning_configuration.scan_on_push is false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code"> image_scanning_configuration {</span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code"> scan_on_push = false</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">VPC FlowLogs Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">VPC hasn't got any FlowLog associated</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">19</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> vpc.enable_flow_log is set to true</span>
<span><strong>Found:</strong> vpc.enable_flow_log is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">module "vpc" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> source = "terraform-aws-modules/vpc/aws"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 26</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc1] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[vpc1] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">25</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">26</span><span class="code">resource "aws_vpc" "vpc1" {</span></div><div class="code-line"><span class="code-line-counter">27</span><span class="code"> cidr_block = "10.10.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_security_group/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[vpc] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_vpc" "vpc" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> cidr_block = local.cidr_block</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/over_exposed_vpc_peering/main.tf</strong>
<span>Line 20</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc1] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[vpc1] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">19</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">20</span><span class="code">resource "aws_vpc" "vpc1" {</span></div><div class="code-line"><span class="code-line-counter">21</span><span class="code"> cidr_block = "10.5.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/load_balancer_listener_http/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc1] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[vpc1] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_vpc" "vpc1" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cidr_block = "10.10.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 8</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[main] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[main] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">7</span><span class="code">}</span></div><div class="code-line error"><span class="code-line-counter">8</span><span class="code">resource "aws_vpc" "main" {</span></div><div class="code-line"><span class="code-line-counter">9</span><span class="code"> cidr_block = "192.168.100.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_rules/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[vpc] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_vpc" "vpc" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> cidr_block = local.cidr_block</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[external] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[external] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_vpc" "external" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cidr_block = "10.1.1.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> vpc.enable_flow_log is set to true</span>
<span><strong>Found:</strong> vpc.enable_flow_log is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">module "vpc" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> source = "terraform-aws-modules/vpc/aws"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"></span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[main] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[main] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_vpc" "main" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cidr_block = "192.168.100.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/over_exposed_vpc_peering/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc2] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[vpc2] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "aws_vpc" "vpc2" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> cidr_block = "10.7.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[nondefault] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[nondefault] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_vpc" "nondefault" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> cidr_block = "10.1.1.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/eks_logging_disabled/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[vpc] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_vpc" "vpc" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> cidr_block = "10.0.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/default_sg_in_new_vpc/main.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[vpc] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code">resource "aws_vpc" "vpc" {</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code"> cidr_block = local.cidr_block</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_unused/main.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[example] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[example] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code">resource "aws_vpc" "example" {</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"> cidr_block = "10.0.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[nondefault] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[nondefault] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_vpc" "nondefault" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> cidr_block = "10.1.1.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[nondefault] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[nondefault] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_vpc" "nondefault" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cidr_block = "10.1.1.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[nondefault] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[nondefault] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_vpc" "nondefault" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cidr_block = "10.1.1.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[main] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[main] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code">resource "aws_vpc" "main" {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> cidr_block = local.cidr_block</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">VPC Subnet Assigns Public IP</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">VPC Subnet should not assign public IP</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> vpc.map_public_ip_on_launch is set to false</span>
<span><strong>Found:</strong> vpc.map_public_ip_on_launch is set undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">module "vpc" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> source = "terraform-aws-modules/vpc/aws"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"></span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> vpc.map_public_ip_on_launch is set to false</span>
<span><strong>Found:</strong> vpc.map_public_ip_on_launch is set undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">module "vpc" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> source = "terraform-aws-modules/vpc/aws"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 13</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[public-subnet].map_public_ip_on_launch is set to false or undefined</span>
<span><strong>Found:</strong> aws_subnet[public-subnet].map_public_ip_on_launch is set to true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">12</span><span class="code"> cidr_block = "192.168.100.0/25"</span></div><div class="code-line error"><span class="code-line-counter">13</span><span class="code"> map_public_ip_on_launch = true</span></div><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">VPC Without Network Firewall</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">VPC should have a Network Firewall associated</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/networkfirewall_firewall#vpc_id" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/networkfirewall_firewall#vpc_id</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">17</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[main] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[main] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_vpc" "main" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cidr_block = "192.168.100.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/default_sg_in_new_vpc/main.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[vpc] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code">resource "aws_vpc" "vpc" {</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code"> cidr_block = local.cidr_block</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/load_balancer_listener_http/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc1] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[vpc1] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_vpc" "vpc1" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cidr_block = "10.10.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_security_group/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[vpc] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_vpc" "vpc" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> cidr_block = local.cidr_block</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[main] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[main] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code">resource "aws_vpc" "main" {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> cidr_block = local.cidr_block</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[nondefault] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[nondefault] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_vpc" "nondefault" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cidr_block = "10.1.1.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 26</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc1] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[vpc1] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">25</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">26</span><span class="code">resource "aws_vpc" "vpc1" {</span></div><div class="code-line"><span class="code-line-counter">27</span><span class="code"> cidr_block = "10.10.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[nondefault] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[nondefault] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_vpc" "nondefault" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> cidr_block = "10.1.1.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/over_exposed_vpc_peering/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc2] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[vpc2] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "aws_vpc" "vpc2" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> cidr_block = "10.7.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[external] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[external] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_vpc" "external" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cidr_block = "10.1.1.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[nondefault] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[nondefault] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_vpc" "nondefault" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cidr_block = "10.1.1.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[nondefault] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[nondefault] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_vpc" "nondefault" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> cidr_block = "10.1.1.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/over_exposed_vpc_peering/main.tf</strong>
<span>Line 20</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc1] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[vpc1] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">19</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">20</span><span class="code">resource "aws_vpc" "vpc1" {</span></div><div class="code-line"><span class="code-line-counter">21</span><span class="code"> cidr_block = "10.5.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_rules/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[vpc] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_vpc" "vpc" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> cidr_block = local.cidr_block</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_unused/main.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[example] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[example] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code">resource "aws_vpc" "example" {</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"> cidr_block = "10.0.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/eks_logging_disabled/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[vpc] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[vpc] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_vpc" "vpc" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> cidr_block = "10.0.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 8</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[main] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[main] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">7</span><span class="code">}</span></div><div class="code-line error"><span class="code-line-counter">8</span><span class="code">resource "aws_vpc" "main" {</span></div><div class="code-line"><span class="code-line-counter">9</span><span class="code"> cidr_block = "192.168.100.0/24"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Virtual Network with DDoS Protection Plan disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Availability</span></span></div><div class="query-details"><span class="query-description-title">Virtual Network should have DDoS Protection Plan enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_network#ddos_protection_plan" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_network#ddos_protection_plan</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">7</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/vmss_public_rdp_lb_opened/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_virtual_network[vnet].ddos_protection_plan' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_virtual_network[vnet].ddos_protection_plan' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "azurerm_virtual_network" "vnet" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> name = "${local.resource_prefix}-vnet"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/vmss_unmanaged_disks/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_virtual_network[vnet].ddos_protection_plan' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_virtual_network[vnet].ddos_protection_plan' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_virtual_network" "vnet" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-vnet"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/vmss_win_diagnostic_log_disabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_virtual_network[vnet].ddos_protection_plan' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_virtual_network[vnet].ddos_protection_plan' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_virtual_network" "vnet" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-vnet"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/vpn_gw_using_basic_sku/main.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_virtual_network[vnet].ddos_protection_plan' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_virtual_network[vnet].ddos_protection_plan' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code">resource "azurerm_virtual_network" "vnet" {</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code"> name = "${local.resource_prefix}-vnet"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/vm_public_rdp_lb_opened/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_virtual_network[vnet].ddos_protection_plan' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_virtual_network[vnet].ddos_protection_plan' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "azurerm_virtual_network" "vnet" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> name = "${local.resource_prefix}-vnet"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/vm_unmanaged_disks/main.tf</strong>
<span>Line 16</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_virtual_network[vnet].ddos_protection_plan' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_virtual_network[vnet].ddos_protection_plan' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">15</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">16</span><span class="code">resource "azurerm_virtual_network" "vnet" {</span></div><div class="code-line"><span class="code-line-counter">17</span><span class="code"> name = "${local.resource_prefix}-vnet"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/vm_public_rdp_nat_opened/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_virtual_network[vnet].ddos_protection_plan' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_virtual_network[vnet].ddos_protection_plan' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "azurerm_virtual_network" "vnet" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> name = "${local.resource_prefix}-vnet"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ALB Deletion Protection Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Application Load Balancer should have deletion protection enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#enable_deletion_protection" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#enable_deletion_protection</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">6</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'enable_deletion_protection' is defined and set to true</span>
<span><strong>Found:</strong> 'enable_deletion_protection' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_alb" "default" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> internal = false</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'enable_deletion_protection' is defined and set to true</span>
<span><strong>Found:</strong> 'enable_deletion_protection' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code">resource "aws_lb" "default" {</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> internal = false</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 48</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'enable_deletion_protection' is defined and set to true</span>
<span><strong>Found:</strong> 'enable_deletion_protection' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">47</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">48</span><span class="code">resource "aws_alb" "disabled" {</span></div><div class="code-line"><span class="code-line-counter">49</span><span class="code"> internal = false</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 39</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'enable_deletion_protection' is defined and set to true</span>
<span><strong>Found:</strong> 'enable_deletion_protection' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">38</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">39</span><span class="code">resource "aws_lb" "disabled" {</span></div><div class="code-line"><span class="code-line-counter">40</span><span class="code"> internal = false</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 49</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'enable_deletion_protection' is defined and set to true</span>
<span><strong>Found:</strong> 'enable_deletion_protection' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">48</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">49</span><span class="code">resource "aws_lb" "test" {</span></div><div class="code-line"><span class="code-line-counter">50</span><span class="code"> name = "test123"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/load_balancer_listener_http/main.tf</strong>
<span>Line 60</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'enable_deletion_protection' is defined and set to true</span>
<span><strong>Found:</strong> 'enable_deletion_protection' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">59</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">60</span><span class="code">resource "aws_lb" "alb_test" {</span></div><div class="code-line"><span class="code-line-counter">61</span><span class="code"> subnets = [aws_subnet.subnet1.id, aws_subnet.subnet2.id]</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">API Gateway Deployment Without API Gateway UsagePlan Associated</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">API Gateway Deployment should have API Gateway UsagePlan defined and associated.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_deployment" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_deployment</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 38</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_deployment[api_gw_deploy] has a 'aws_api_gateway_usage_plan' resource associated.</span>
<span><strong>Found:</strong> aws_api_gateway_deployment[api_gw_deploy] doesn't have a 'aws_api_gateway_usage_plan' resource associated.</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">37</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">38</span><span class="code">resource "aws_api_gateway_deployment" "api_gw_deploy" {</span></div><div class="code-line"><span class="code-line-counter">39</span><span class="code"> depends_on = [aws_api_gateway_integration.api_gw_int]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_deployment[api_gw_deploy] has a 'aws_api_gateway_usage_plan' resource associated.</span>
<span><strong>Found:</strong> aws_api_gateway_deployment[api_gw_deploy] doesn't have a 'aws_api_gateway_usage_plan' resource associated.</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_api_gateway_deployment" "api_gw_deploy" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> depends_on = [aws_api_gateway_integration.api_gw_int]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_deployment[api_gw_deploy] has a 'aws_api_gateway_usage_plan' resource associated.</span>
<span><strong>Found:</strong> aws_api_gateway_deployment[api_gw_deploy] doesn't have a 'aws_api_gateway_usage_plan' resource associated.</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_api_gateway_deployment" "api_gw_deploy" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> depends_on = [aws_api_gateway_integration.api_gw_int]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_deployment[api_gw_deploy] has a 'aws_api_gateway_usage_plan' resource associated.</span>
<span><strong>Found:</strong> aws_api_gateway_deployment[api_gw_deploy] doesn't have a 'aws_api_gateway_usage_plan' resource associated.</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_api_gateway_deployment" "api_gw_deploy" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> depends_on = [aws_api_gateway_integration.api_gw_int]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_deployment[api_gw_deploy] has a 'aws_api_gateway_usage_plan' resource associated.</span>
<span><strong>Found:</strong> aws_api_gateway_deployment[api_gw_deploy] doesn't have a 'aws_api_gateway_usage_plan' resource associated.</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_api_gateway_deployment" "api_gw_deploy" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> depends_on = [aws_api_gateway_integration.api_gw_int]</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">API Gateway Stage Without API Gateway UsagePlan Associated</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Resource Management</span></span></div><div class="query-details"><span class="query-description-title">API Gateway Stage should have API Gateway UsagePlan defined and associated.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 72</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_stage[api_gw_stage] has a 'aws_api_gateway_usage_plan' resource associated.</span>
<span><strong>Found:</strong> aws_api_gateway_stage[api_gw_stage] doesn't have a 'aws_api_gateway_usage_plan' resource associated.</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">71</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">72</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">73</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_stage[api_gw_stage] has a 'aws_api_gateway_usage_plan' resource associated.</span>
<span><strong>Found:</strong> aws_api_gateway_stage[api_gw_stage] doesn't have a 'aws_api_gateway_usage_plan' resource associated.</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_stage[api_gw_stage] has a 'aws_api_gateway_usage_plan' resource associated.</span>
<span><strong>Found:</strong> aws_api_gateway_stage[api_gw_stage] doesn't have a 'aws_api_gateway_usage_plan' resource associated.</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_stage[api_gw_stage] has a 'aws_api_gateway_usage_plan' resource associated.</span>
<span><strong>Found:</strong> aws_api_gateway_stage[api_gw_stage] doesn't have a 'aws_api_gateway_usage_plan' resource associated.</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_stage[api_gw_stage] has a 'aws_api_gateway_usage_plan' resource associated.</span>
<span><strong>Found:</strong> aws_api_gateway_stage[api_gw_stage] doesn't have a 'aws_api_gateway_usage_plan' resource associated.</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">App Service HTTP2 Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">App Service should have 'http2_enabled' enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#http2_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#http2_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">9</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/app_service_ftps_unused/main.tf</strong>
<span>Line 42</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">41</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">42</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">43</span><span class="code"> use_32_bit_worker_process = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_php_isnot_latest/main.tf</strong>
<span>Line 34</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">33</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">34</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">35</span><span class="code"> use_32_bit_worker_process = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/webapp_not_use_managedidentity/main.tf</strong>
<span>Line 34</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">33</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">34</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">35</span><span class="code"> use_32_bit_worker_process = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_lin_java_isnot_latest/main.tf</strong>
<span>Line 38</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">37</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">38</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">39</span><span class="code"> use_32_bit_worker_process = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_http2_not_enabled/main.tf</strong>
<span>Line 36</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is set to true</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is set to false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">35</span><span class="code"> use_32_bit_worker_process = true</span></div><div class="code-line error"><span class="code-line-counter">36</span><span class="code"> http2_enabled = false</span></div><div class="code-line"><span class="code-line-counter">37</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_win_java_isnot_latest/main.tf</strong>
<span>Line 38</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">37</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">38</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">39</span><span class="code"> use_32_bit_worker_process = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/app_service_authentication_missing/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].site_config' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].site_config' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/app_service_use_most_recent_supported_tls/main.tf</strong>
<span>Line 34</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">33</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">34</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">35</span><span class="code"> use_32_bit_worker_process = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/webapp_client_cert_not_enabled/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].site_config.http2_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> use_32_bit_worker_process = true</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">CloudTrail Log File Validation Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 3.2</sub></span>
<span class="query-description-title">Ensure CloudTrail log file validation is enabled</span>
<span class="cis-description-text">CloudTrail log file validation creates a digitally signed digest file containing a hash of each log that CloudTrail writes to S3. These digest files can be used to determine whether a log file was changed, deleted, or unchanged after CloudTrail delivered the log. It is recommended that file validation be enabled on all CloudTrails.
Enabling log file validation will provide additional integrity checking of CloudTrail logs.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#enable_log_file_validation" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#enable_log_file_validation</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudtrail_not_encrypted/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_cloudtrail[foobar].enable_log_file_validation' is set</span>
<span><strong>Found:</strong> 'aws_cloudtrail[foobar].enable_log_file_validation' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudtrail_enabled_on_multi_region/main.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_cloudtrail[foobar].enable_log_file_validation' is set</span>
<span><strong>Found:</strong> 'aws_cloudtrail[foobar].enable_log_file_validation' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"> name = "tf-trail-foobar"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudtrail_file_log_validation_disabled/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_cloudtrail[foobar].enable_log_file_validation' is set</span>
<span><strong>Found:</strong> 'aws_cloudtrail[foobar].enable_log_file_validation' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = local.name</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Cloudfront Without WAF</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">All AWS CloudFront distributions should be integrated with the Web Application Firewall (AWS WAF) service</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudfront_not_using_waf/main.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'web_acl_id' exists</span>
<span><strong>Found:</strong> 'web_acl_id' is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code">resource "aws_cloudfront_distribution" "s3_distribution" {</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code"> origin {</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'web_acl_id' exists</span>
<span><strong>Found:</strong> 'web_acl_id' is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_cloudfront_distribution" "s3_distribution" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> enabled = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_protocol_version_is_low/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'web_acl_id' exists</span>
<span><strong>Found:</strong> 'web_acl_id' is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_cloudfront_distribution" "s3_distribution" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> origin {</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudfront_distribution_without_logging/main.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'web_acl_id' exists</span>
<span><strong>Found:</strong> 'web_acl_id' is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code">resource "aws_cloudfront_distribution" "s3_distribution" {</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code"> origin {</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">DocDB Logging Is Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">DocDB logging should be enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#enabled_cloudwatch_logs_exports" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#enabled_cloudwatch_logs_exports</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/docdb_audit_logs_missing/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_docdb_cluster.enabled_cloudwatch_logs_exports is defined</span>
<span><strong>Found:</strong> aws_docdb_cluster.enabled_cloudwatch_logs_exports is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_docdb_cluster" "docdb" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "my-docdb-cluster"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "docdb"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/docdb_cluster_encrypted_without_kms_key/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_docdb_cluster.enabled_cloudwatch_logs_exports is defined</span>
<span><strong>Found:</strong> aws_docdb_cluster.enabled_cloudwatch_logs_exports is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_docdb_cluster" "test1" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "my-docdb-cluster-test1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/docdb_clusters_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_docdb_cluster.enabled_cloudwatch_logs_exports is defined</span>
<span><strong>Found:</strong> aws_docdb_cluster.enabled_cloudwatch_logs_exports is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_docdb_cluster" "docdb" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "my-docdb-cluster"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/docdb_cluster_encrypted_at_rest_using_cmk_not_customer_managed/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_docdb_cluster.enabled_cloudwatch_logs_exports is defined</span>
<span><strong>Found:</strong> aws_docdb_cluster.enabled_cloudwatch_logs_exports is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "aws_docdb_cluster" "test2" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> cluster_identifier = "my-docdb-cluster-test2"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">EC2 Instance Using Default Security Group</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">EC2 instances should not use default security group(s)</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#security_groups" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#security_groups</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 83</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[inst1].vpc_security_group_ids is not using default security group</span>
<span><strong>Found:</strong> aws_instance[inst1].vpc_security_group_ids is using at least one default security group</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">82</span><span class="code">resource "aws_instance" "inst1" {</span></div><div class="code-line error"><span class="code-line-counter">83</span><span class="code"> vpc_security_group_ids = [aws_default_security_group.dsg.id]</span></div><div class="code-line"><span class="code-line-counter">84</span><span class="code"> subnet_id = aws_subnet.subnet1.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_security_group/main.tf</strong>
<span>Line 67</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[ec2].vpc_security_group_ids is not using default security group</span>
<span><strong>Found:</strong> aws_instance[ec2].vpc_security_group_ids is using at least one default security group</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">66</span><span class="code"> subnet_id = aws_subnet.subnet.id</span></div><div class="code-line error"><span class="code-line-counter">67</span><span class="code"> vpc_security_group_ids = [aws_security_group.default.id]</span></div><div class="code-line"><span class="code-line-counter">68</span><span class="code"></span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 109</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[inst3].vpc_security_group_ids is not using default security group</span>
<span><strong>Found:</strong> aws_instance[inst3].vpc_security_group_ids is using at least one default security group</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">108</span><span class="code">resource "aws_instance" "inst3" {</span></div><div class="code-line error"><span class="code-line-counter">109</span><span class="code"> vpc_security_group_ids = [aws_default_security_group.dsg.id]</span></div><div class="code-line"><span class="code-line-counter">110</span><span class="code"> subnet_id = aws_subnet.subnet1.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 96</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[inst2].vpc_security_group_ids is not using default security group</span>
<span><strong>Found:</strong> aws_instance[inst2].vpc_security_group_ids is using at least one default security group</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">95</span><span class="code">resource "aws_instance" "inst2" {</span></div><div class="code-line error"><span class="code-line-counter">96</span><span class="code"> vpc_security_group_ids = [aws_default_security_group.dsg.id]</span></div><div class="code-line"><span class="code-line-counter">97</span><span class="code"> subnet_id = aws_subnet.subnet1.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_rules/main.tf</strong>
<span>Line 65</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[ec2].vpc_security_group_ids is not using default security group</span>
<span><strong>Found:</strong> aws_instance[ec2].vpc_security_group_ids is using at least one default security group</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">64</span><span class="code"> subnet_id = aws_subnet.subnet.id</span></div><div class="code-line error"><span class="code-line-counter">65</span><span class="code"> vpc_security_group_ids = [aws_security_group.default.id]</span></div><div class="code-line"><span class="code-line-counter">66</span><span class="code"></span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">EC2 Instance Using Default VPC</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">EC2 Instances should not be configured under a default VPC network</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#subnet_id" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#subnet_id</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 143</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[public_ins].subnet_id is not associated with a default VPC</span>
<span><strong>Found:</strong> aws_instance[public_ins].subnet_id is associated with a default VPC</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">142</span><span class="code"> vpc_security_group_ids = [aws_security_group.publicly_accessible_sg.id]</span></div><div class="code-line error"><span class="code-line-counter">143</span><span class="code"> subnet_id = aws_subnet.nondefault_1.id</span></div><div class="code-line"><span class="code-line-counter">144</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 151</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[public_ins].subnet_id is not associated with a default VPC</span>
<span><strong>Found:</strong> aws_instance[public_ins].subnet_id is associated with a default VPC</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">150</span><span class="code"> vpc_security_group_ids = [aws_security_group.publicly_accessible_sg.id]</span></div><div class="code-line error"><span class="code-line-counter">151</span><span class="code"> subnet_id = aws_subnet.nondefault_1.id</span></div><div class="code-line"><span class="code-line-counter">152</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 136</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[public_ins].subnet_id is not associated with a default VPC</span>
<span><strong>Found:</strong> aws_instance[public_ins].subnet_id is associated with a default VPC</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">135</span><span class="code"> vpc_security_group_ids = [aws_security_group.publicly_accessible_sg.id]</span></div><div class="code-line error"><span class="code-line-counter">136</span><span class="code"> subnet_id = aws_subnet.nondefault_1.id</span></div><div class="code-line"><span class="code-line-counter">137</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_ec2_to_default_vpc/main.tf</strong>
<span>Line 52</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[t2-instance].subnet_id is not associated with a default VPC</span>
<span><strong>Found:</strong> aws_instance[t2-instance].subnet_id is associated with a default VPC</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">51</span><span class="code"> instance_type = "t2.micro"</span></div><div class="code-line error"><span class="code-line-counter">52</span><span class="code"> subnet_id = aws_subnet.default-subnet.id</span></div><div class="code-line"><span class="code-line-counter">53</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ECR Repository Without Policy</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">ECR Repository should have Policies attached to it</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository_policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository_policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/ecr_not_secure_policy/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecr_repository[foo] has policies attached</span>
<span><strong>Found:</strong> aws_ecr_repository[foo] doesn't have policies attached</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_ecr_repository" "foo" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "bar"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ecr_make_tags_immutable/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecr_repository[foo] has policies attached</span>
<span><strong>Found:</strong> aws_ecr_repository[foo] doesn't have policies attached</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_ecr_repository" "foo" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "bar"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ecr_use_image_scanning/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecr_repository[foo] has policies attached</span>
<span><strong>Found:</strong> aws_ecr_repository[foo] doesn't have policies attached</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_ecr_repository" "foo" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "bar"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/ecr_repo_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecr_repository[foo] has policies attached</span>
<span><strong>Found:</strong> aws_ecr_repository[foo] doesn't have policies attached</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_ecr_repository" "foo" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "bar"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "IMMUTABLE"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ECS Cluster with Container Insights Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">ECS Cluster should enable container insights</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_cluster#setting" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_cluster#setting</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ecs_cluster_container_insights/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_ecs_cluster[foo].setting.name' is set to 'containerInsights' and 'aws_ecs_cluster[foo].setting.value' is set to 'enabled'</span>
<span><strong>Found:</strong> 'aws_ecs_cluster[foo].setting.name' is not set to 'containerInsights' and/or 'aws_ecs_cluster[foo].setting.value' is not set to 'enabled'</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_ecs_cluster" "foo" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "white-hart"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"></span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">EKS cluster logging is not enabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Amazon EKS control plane logging is not enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#enabled_cluster_log_types" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#enabled_cluster_log_types</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/eks_logging_disabled/main.tf</strong>
<span>Line 19</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'enabled_cluster_log_types' is defined and not null</span>
<span><strong>Found:</strong> 'enabled_cluster_log_types' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">18</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">19</span><span class="code">resource "aws_eks_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">20</span><span class="code"> name = "test"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ElastiCache Using Default Port</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">ElastiCache should not use the default port (an attacker can easily guess the port). For engine set to Redis, the default port is 6379. The Memcached default port is 11211</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#port" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#port</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/elasticache_automatic_backup/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_elasticache_cluster.port is defined and not null</span>
<span><strong>Found:</strong> aws_elasticache_cluster.port is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "aws_elasticache_cluster" "disabled" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> cluster_id = "cluster"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/elasticache_automatic_backup/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_elasticache_cluster.port is defined and not null</span>
<span><strong>Found:</strong> aws_elasticache_cluster.port is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticache_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_id = "cluster"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "redis"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ElastiCache Without VPC</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">ElastiCache should be launched in a Virtual Private Cloud (VPC)</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#subnet_group_name" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#subnet_group_name</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/elasticache_automatic_backup/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_elasticache_cluster[default].subnet_group_name' is defined and not null'</span>
<span><strong>Found:</strong> 'aws_elasticache_cluster[default].subnet_group_name' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticache_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_id = "cluster"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "redis"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/elasticache_automatic_backup/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_elasticache_cluster[disabled].subnet_group_name' is defined and not null'</span>
<span><strong>Found:</strong> 'aws_elasticache_cluster[disabled].subnet_group_name' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "aws_elasticache_cluster" "disabled" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> cluster_id = "cluster"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Function App HTTP2 Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Function App should have 'http2_enabled' enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#http2_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#http2_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">9</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_python_isnot_latest/main.tf</strong>
<span>Line 51</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config.http2_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config.http2_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">50</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">51</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">52</span><span class="code"> linux_fx_version = "Python|3.8"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/func_app_client_cert_optional/main.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/functionapp_not_use_managedidentity/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_http2/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config.http2_enabled' is set to true</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config.http2_enabled' is set to false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"> site_config {</span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code"> http2_enabled = false</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/func_app_ftps_not_required/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config.http2_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config.http2_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"> storage_account_access_key = azurerm_storage_account.storacc.primary_access_key</span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> ftps_state = "AllAllowed"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/func_app_not_using_latest_tls/main.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config.http2_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config.http2_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> min_tls_version = 1.1</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_win_java_isnot_latest/main.tf</strong>
<span>Line 60</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config.http2_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config.http2_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">59</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">60</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">61</span><span class="code"> java_version = "1.8"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/func_app_authentication/main.tf</strong>
<span>Line 42</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">41</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">42</span><span class="code">resource "azurerm_function_app" "functionapp" {</span></div><div class="code-line"><span class="code-line-counter">43</span><span class="code"> name = "${local.resource_prefix}-functionapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/functionapp_lin_java_isnot_latest/main.tf</strong>
<span>Line 51</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_function_app[functionapp].site_config.http2_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_function_app[functionapp].site_config.http2_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">50</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">51</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">52</span><span class="code"> linux_fx_version = "JAVA|8"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Global Accelerator Flow Logs Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Global Accelerator should have flow logs enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/globalaccelerator_accelerator#flow_logs_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/globalaccelerator_accelerator#flow_logs_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/globalaccelerator_accelerator_no_flow_logs/main.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_globalaccelerator_accelerator[{{example}}].flow_logs_enabled is defined and not null</span>
<span><strong>Found:</strong> aws_globalaccelerator_accelerator[{{example}}].flow_logs_enabled is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code"> attributes {</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"> #flow_logs_enabled = true</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">IAM Policies Attached To User</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">IAM policies should be attached only to groups or roles</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_policy_attachment" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_policy_attachment</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/iam_user_managed_policy_direct_attachment/main.tf</strong>
<span>Line 29</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'user' is redundant</span>
<span><strong>Found:</strong> 'user' exists</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">28</span><span class="code">resource "aws_iam_user_policy_attachment" "managed-policy-attach" {</span></div><div class="code-line error"><span class="code-line-counter">29</span><span class="code"> user = aws_iam_user.user-1.name</span></div><div class="code-line"><span class="code-line-counter">30</span><span class="code"> policy_arn = aws_iam_policy.managed-policy.arn</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/iam_user_inline_policy_attach/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'user' is redundant</span>
<span><strong>Found:</strong> 'user' exists</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"> name = "inline-policy"</span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code"> user = aws_iam_user.user-1.name</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"></span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">IAM Policy Grants 'AssumeRole' Permission Across All Services</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">IAM role allows All services or principals to assume it</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/role_assume_policy_principal_all/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'assume_role_policy.Statement.Principal' doesn't contain '*'</span>
<span><strong>Found:</strong> 'assume_role_policy.Statement.Principal' contains '*'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code"> assume_role_policy = &lt;&lt;EOF</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> {</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Lambda Functions Without X-Ray Tracing</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">AWS Lambda functions should have TracingConfig enabled. For this, property 'tracing_Config.mode' should have the value 'Active'</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function#tracing_config" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function#tracing_config</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/lambda_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lambda_function[my-lambda].tracing_config is defined and not null</span>
<span><strong>Found:</strong> aws_lambda_function[my-lambda].tracing_config is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_lambda_function" "my-lambda" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> filename = "~/Downloads/lambda.json.zip"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/lambda_without_xray/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lambda_function[test_lambda].tracing_config is defined and not null</span>
<span><strong>Found:</strong> aws_lambda_function[test_lambda].tracing_config is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code">resource "aws_lambda_function" "test_lambda" {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> filename = "lambda_function_payload.zip"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/lambda_not_in_vpc/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lambda_function[test_lambda].tracing_config is defined and not null</span>
<span><strong>Found:</strong> aws_lambda_function[test_lambda].tracing_config is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code">resource "aws_lambda_function" "test_lambda" {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> filename = "lambda_function_payload.zip"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/lambda_without_explicit_log_group/main.tf</strong>
<span>Line 57</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lambda_function[test_lambda].tracing_config is defined and not null</span>
<span><strong>Found:</strong> aws_lambda_function[test_lambda].tracing_config is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">56</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">57</span><span class="code">resource "aws_lambda_function" "test_lambda" {</span></div><div class="code-line"><span class="code-line-counter">58</span><span class="code"> filename = "${path.module}/Archive.zip"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Lambda Permission Misconfigured</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">Lambda permission may be misconfigured if the action field is not filled in by 'lambda:InvokeFunction'</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/lambda_not_secure_policy/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lambda_permission[name].action is 'lambda:InvokeFunction'%!(EXTRA string=all)</span>
<span><strong>Found:</strong> aws_lambda_permission[name].action is all%!(EXTRA string=lambda:*)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"> statement_id = "AllowAllResources"</span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code"> action = "lambda:*"</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> function_name = aws_lambda_function.my-lambda.function_name</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Open Access To Resources Through API</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Open access to back-end resources through API</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 26</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'authorization' is not equal 'NONE'</span>
<span><strong>Found:</strong> 'authorization' is equal 'NONE'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">25</span><span class="code"> http_method = "GET"</span></div><div class="code-line error"><span class="code-line-counter">26</span><span class="code"> authorization = "NONE"</span></div><div class="code-line"><span class="code-line-counter">27</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 26</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'authorization' is not equal 'NONE'</span>
<span><strong>Found:</strong> 'authorization' is equal 'NONE'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">25</span><span class="code"> http_method = "GET"</span></div><div class="code-line error"><span class="code-line-counter">26</span><span class="code"> authorization = "NONE"</span></div><div class="code-line"><span class="code-line-counter">27</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 26</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'authorization' is not equal 'NONE'</span>
<span><strong>Found:</strong> 'authorization' is equal 'NONE'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">25</span><span class="code"> http_method = "GET"</span></div><div class="code-line error"><span class="code-line-counter">26</span><span class="code"> authorization = "NONE"</span></div><div class="code-line"><span class="code-line-counter">27</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 54</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'authorization' is not equal 'NONE'</span>
<span><strong>Found:</strong> 'authorization' is equal 'NONE'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">53</span><span class="code"> http_method = "GET"</span></div><div class="code-line error"><span class="code-line-counter">54</span><span class="code"> authorization = "NONE"</span></div><div class="code-line"><span class="code-line-counter">55</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 26</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'authorization' is not equal 'NONE'</span>
<span><strong>Found:</strong> 'authorization' is equal 'NONE'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">25</span><span class="code"> http_method = "GET"</span></div><div class="code-line error"><span class="code-line-counter">26</span><span class="code"> authorization = "NONE"</span></div><div class="code-line"><span class="code-line-counter">27</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">PostgreSQL Server Infrastructure Encryption Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">PostgreSQL Server Infrastructure Encryption should be enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#infrastructure_encryption_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#infrastructure_encryption_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/postgresql_log_connections_not_enabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server[example].infrastructure_encryption_enabled' is defined and set to true</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server[example].infrastructure_encryption_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_postgresql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-postgresql-server"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/postgresql_log_disconnections_not_enabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server[example].infrastructure_encryption_enabled' is defined and set to true</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server[example].infrastructure_encryption_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_postgresql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-postgresql-server"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/logging/postgresql_logcheckpoints_not_enabled/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server[example].infrastructure_encryption_enabled' is defined and set to true</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server[example].infrastructure_encryption_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_postgresql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-postgresql-server"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/postgresql_not_forcing_ssl/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server[example].infrastructure_encryption_enabled' is defined and set to true</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server[example].infrastructure_encryption_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "azurerm_postgresql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "${local.resource_prefix}-postgresql-server"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Redshift Using Default Port</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">Redshift should not use the default port (5439) because an attacker can easily guess the port</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#port" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#port</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/redshift_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster.port is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_cluster.port is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_redshift_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "tf-redshift-cluster"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> database_name = "mydb"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/redshift_not_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster.port is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_cluster.port is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_redshift_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "tf-redshift-cluster"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_redshift_in_ec2_classic_mode/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster.port is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_cluster.port is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_redshift_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "redshift-defaults-only"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 103</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster.port is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_cluster.port is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">102</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">103</span><span class="code">resource "aws_redshift_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">104</span><span class="code"> cluster_identifier = "redshift-defaults-only"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">S3 Bucket Logging Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">S3 bucket without logging</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">18</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudtrail_file_log_validation_disabled/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/glue_data_catalog_not_secure_policy/main.tf</strong>
<span>Line 33</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">32</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">33</span><span class="code">resource "aws_s3_bucket" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">34</span><span class="code"> bucket = "cloudrail-glue"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_authenticated_users_canned/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/athena_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "hoge" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "hoge"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_s3_bucket" "cdn-content" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned_with_overriding_access_block/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-3"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudfront_not_using_waf/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "b" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "mybucket"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> acl = "private"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/s3_bucket_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "cloudrail-non-encrypted-czx7zxchs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/s3_bucket_object_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "cloudrail-non-encrypted-czx7zxchs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudfront_distribution_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "b" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "mybucket"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> acl = "private"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workgroups_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "cloudrail_anthena_bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "cloudrail-wg-encrypted-sse-s3"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_protocol_version_is_low/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "logging" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "dist-cloud-test-logs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/s3_access_logging_disabled/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "b" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "my-tf-test-bucket"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> acl = "private"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workgroups_non_encrypted/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_s3_bucket" "cloudrail_anthena_bucket_2" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> bucket = "cloudrail-wg-encrypted-sse-s3-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudtrail_enabled_on_multi_region/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> bucket = "tf-test-trail"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_policy_public_to_all_authenticated_users/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-policy-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudtrail_not_encrypted/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-1"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">S3 Bucket Public ACL Overridden By Public Access Block</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 2.1.5</sub></span>
<span class="query-description-title">Ensure that S3 Buckets are configured with 'Block public access (bucket settings)'</span>
<span class="cis-description-text">Amazon S3 provides Block public access (bucket settings) and Block public access (account settings) to help you manage public access to Amazon S3 resources. By default, S3 buckets and objects are created with public access disabled. However, an IAM principal with sufficient S3 permissions can enable public access at the bucket and/or object level. While enabled, Block public access (bucket settings) prevents an individual bucket, and its contained objects, from becoming publicly accessible. Similarly, Block public access (account settings) prevents all buckets, and contained objects, from becoming publicly accessible across the entire account.
Amazon S3 Block public access (bucket settings) prevents the accidental or malicious public exposure of data contained within the respective bucket(s). Amazon S3 Block public access (account settings) prevents the accidental or malicious public exposure of data contained within all buckets of the respective AWS account. Whether blocking public access to all or some buckets is an organizational decision that should be based on data sensitivity, least privilege, and use case.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned_with_overriding_access_block/main.tf</strong>
<span>Line 7</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> S3 Bucket public ACL is not overridden by S3 bucket Public Access Block</span>
<span><strong>Found:</strong> S3 Bucket public ACL is overridden by S3 bucket Public Access Block</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-3"</span></div><div class="code-line error"><span class="code-line-counter">7</span><span class="code"> acl = "public-read-write"</span></div><div class="code-line"><span class="code-line-counter">8</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned/main.tf</strong>
<span>Line 7</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> S3 Bucket public ACL is not overridden by S3 bucket Public Access Block</span>
<span><strong>Found:</strong> S3 Bucket public ACL is overridden by S3 bucket Public Access Block</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-1"</span></div><div class="code-line error"><span class="code-line-counter">7</span><span class="code"> acl = "public-read"</span></div><div class="code-line"><span class="code-line-counter">8</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Shield Advanced Not In Use</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">AWS Shield Advanced should be used for Amazon Route 53 hosted zone, AWS Global Accelerator accelerator, Elastic IP Address, Elastic Load Balancing, and Amazon CloudFront Distribution to protect these resources against robust DDoS attacks</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/shield_protection#resource_arn" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/shield_protection#resource_arn</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">10</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 39</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lb has shield advanced associated</span>
<span><strong>Found:</strong> aws_lb does not have shield advanced associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">38</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">39</span><span class="code">resource "aws_lb" "disabled" {</span></div><div class="code-line"><span class="code-line-counter">40</span><span class="code"> internal = false</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 49</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lb has shield advanced associated</span>
<span><strong>Found:</strong> aws_lb does not have shield advanced associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">48</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">49</span><span class="code">resource "aws_lb" "test" {</span></div><div class="code-line"><span class="code-line-counter">50</span><span class="code"> name = "test123"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudfront_distribution_without_logging/main.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudfront_distribution has shield advanced associated</span>
<span><strong>Found:</strong> aws_cloudfront_distribution does not have shield advanced associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code">resource "aws_cloudfront_distribution" "s3_distribution" {</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code"> origin {</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/globalaccelerator_accelerator_no_flow_logs/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_globalaccelerator_accelerator has shield advanced associated</span>
<span><strong>Found:</strong> aws_globalaccelerator_accelerator does not have shield advanced associated</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_globalaccelerator_accelerator" "example" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "Example"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> ip_address_type = "IPV4"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 56</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_eip has shield advanced associated</span>
<span><strong>Found:</strong> aws_eip does not have shield advanced associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">55</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">56</span><span class="code">resource "aws_eip" "allocate-ip-to-nat-gw" {</span></div><div class="code-line"><span class="code-line-counter">57</span><span class="code"> vpc = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudfront_distribution has shield advanced associated</span>
<span><strong>Found:</strong> aws_cloudfront_distribution does not have shield advanced associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_cloudfront_distribution" "s3_distribution" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> enabled = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lb has shield advanced associated</span>
<span><strong>Found:</strong> aws_lb does not have shield advanced associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code">resource "aws_lb" "default" {</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> internal = false</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_protocol_version_is_low/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudfront_distribution has shield advanced associated</span>
<span><strong>Found:</strong> aws_cloudfront_distribution does not have shield advanced associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_cloudfront_distribution" "s3_distribution" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> origin {</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/load_balancer_listener_http/main.tf</strong>
<span>Line 60</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lb has shield advanced associated</span>
<span><strong>Found:</strong> aws_lb does not have shield advanced associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">59</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">60</span><span class="code">resource "aws_lb" "alb_test" {</span></div><div class="code-line"><span class="code-line-counter">61</span><span class="code"> subnets = [aws_subnet.subnet1.id, aws_subnet.subnet2.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudfront_not_using_waf/main.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudfront_distribution has shield advanced associated</span>
<span><strong>Found:</strong> aws_cloudfront_distribution does not have shield advanced associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code">resource "aws_cloudfront_distribution" "s3_distribution" {</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code"> origin {</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">App Service Authentication Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Azure App Service authentication settings should be enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">9</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_lin_java_isnot_latest/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].auth_settings' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].auth_settings' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_php_isnot_latest/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].auth_settings' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].auth_settings' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/app_service_authentication_missing/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].auth_settings' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].auth_settings' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_win_java_isnot_latest/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].auth_settings' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].auth_settings' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/app_service_use_most_recent_supported_tls/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].auth_settings' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].auth_settings' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/webapp_client_cert_not_enabled/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].auth_settings' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].auth_settings' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/webapp_http2_not_enabled/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].auth_settings' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].auth_settings' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/encryption/in-transit/app_service_ftps_unused/main.tf</strong>
<span>Line 36</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].auth_settings' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].auth_settings' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">35</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">36</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">37</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/iam/webapp_not_use_managedidentity/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[webapp].auth_settings' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[webapp].auth_settings' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "azurerm_app_service" "webapp" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> name = "${local.resource_prefix}-webapp"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">DynamoDB Table Point In Time Recovery Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">It's considered a best practice to have point in time recovery enabled for DynamoDB Table</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#point_in_time_recovery" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#point_in_time_recovery</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 90</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_dynamodb_table.point_in_time_recovery.enabled is enabled</span>
<span><strong>Found:</strong> aws_dynamodb_table.point_in_time_recovery is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">89</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">90</span><span class="code">resource "aws_dynamodb_table" "basic-dynamodb-table" {</span></div><div class="code-line"><span class="code-line-counter">91</span><span class="code"> name = "GameScores"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/dynamodb_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_dynamodb_table.point_in_time_recovery.enabled is enabled</span>
<span><strong>Found:</strong> aws_dynamodb_table.point_in_time_recovery is missing</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_dynamodb_table" "basic-dynamodb-table" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "GameScores"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> billing_mode = "PROVISIONED"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 143</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_dynamodb_table.point_in_time_recovery.enabled is enabled</span>
<span><strong>Found:</strong> aws_dynamodb_table.point_in_time_recovery is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">142</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">143</span><span class="code">resource "aws_dynamodb_table" "basic-dynamodb-table" {</span></div><div class="code-line"><span class="code-line-counter">144</span><span class="code"> name = "GameScores"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/dynamodb_without_recovery_enabled/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_dynamodb_table.point_in_time_recovery.enabled is enabled</span>
<span><strong>Found:</strong> aws_dynamodb_table.point_in_time_recovery is missing</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_dynamodb_table" "basic-dynamodb-table" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "GameScores"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> billing_mode = "PROVISIONED"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">EC2 Instance Monitoring Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">EC2 Instance should have detailed monitoring enabled. With detailed monitoring enabled data is available in 1-minute periods</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#monitoring" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#monitoring</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">21</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 138</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=public_ins)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=public_ins)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">137</span><span class="code">// This instance is can potentially be used to hop into the DB</span></div><div class="code-line error"><span class="code-line-counter">138</span><span class="code">resource "aws_instance" "public_ins" {</span></div><div class="code-line"><span class="code-line-counter">139</span><span class="code"> ami = "ami-0130bec6e5047f596"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/default_sg_in_new_vpc/main.tf</strong>
<span>Line 31</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=ec2)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=ec2)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">30</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">31</span><span class="code">resource "aws_instance" "ec2" {</span></div><div class="code-line"><span class="code-line-counter">32</span><span class="code"> ami = "ami-07cda0db070313c52"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 146</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=public_ins)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=public_ins)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">145</span><span class="code">// This instance is can potentially be used to hop into the DB</span></div><div class="code-line error"><span class="code-line-counter">146</span><span class="code">resource "aws_instance" "public_ins" {</span></div><div class="code-line"><span class="code-line-counter">147</span><span class="code"> ami = "ami-0130bec6e5047f596"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 80</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=example_with_copied_ami)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=example_with_copied_ami)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">79</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">80</span><span class="code">resource "aws_instance" "example_with_copied_ami" {</span></div><div class="code-line"><span class="code-line-counter">81</span><span class="code"> ami = aws_ami_copy.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 93</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=example_with_ami_from_instance)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=example_with_ami_from_instance)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">92</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">93</span><span class="code">resource "aws_instance" "example_with_ami_from_instance" {</span></div><div class="code-line"><span class="code-line-counter">94</span><span class="code"> ami = aws_ami_from_instance.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_ec2_to_default_vpc/main.tf</strong>
<span>Line 49</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=t2-instance)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=t2-instance)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">48</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">49</span><span class="code">resource "aws_instance" "t2-instance" {</span></div><div class="code-line"><span class="code-line-counter">50</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=public_ins)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=public_ins)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code">// This instance is can potentially be used to hop into the DB</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code">resource "aws_instance" "public_ins" {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> ami = "ami-0130bec6e5047f596"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_rules/main.tf</strong>
<span>Line 61</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=ec2)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=ec2)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">60</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">61</span><span class="code">resource "aws_instance" "ec2" {</span></div><div class="code-line"><span class="code-line-counter">62</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 95</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=inst2)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=inst2)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">94</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">95</span><span class="code">resource "aws_instance" "inst2" {</span></div><div class="code-line"><span class="code-line-counter">96</span><span class="code"> vpc_security_group_ids = [aws_default_security_group.dsg.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_security_group/main.tf</strong>
<span>Line 63</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=ec2)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=ec2)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">62</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">63</span><span class="code">resource "aws_instance" "ec2" {</span></div><div class="code-line"><span class="code-line-counter">64</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 87</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=test-ec2-instance)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=test-ec2-instance)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">86</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">87</span><span class="code">resource "aws_instance" "test-ec2-instance" {</span></div><div class="code-line"><span class="code-line-counter">88</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 45</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=example_with_new_ami)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=example_with_new_ami)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">44</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">45</span><span class="code">resource "aws_instance" "example_with_new_ami" {</span></div><div class="code-line"><span class="code-line-counter">46</span><span class="code"> ami = aws_ami.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 136</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=test)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=test)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">135</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">136</span><span class="code">resource "aws_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">137</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 108</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=inst3)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=inst3)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">107</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">108</span><span class="code">resource "aws_instance" "inst3" {</span></div><div class="code-line"><span class="code-line-counter">109</span><span class="code"> vpc_security_group_ids = [aws_default_security_group.dsg.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/ec2_without_monitoring/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=web)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=web)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "aws_instance" "web" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 83</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=test)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=test)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">82</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">83</span><span class="code">resource "aws_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">84</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ec2_ebs_not_optimized/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=web)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=web)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "aws_instance" "web" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 106</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=priv_ins)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=priv_ins)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">105</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">106</span><span class="code">resource "aws_instance" "priv_ins" {</span></div><div class="code-line"><span class="code-line-counter">107</span><span class="code"> ami = "${data.aws_ami.ubuntu.id}"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 82</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=inst1)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=inst1)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">81</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">82</span><span class="code">resource "aws_instance" "inst1" {</span></div><div class="code-line"><span class="code-line-counter">83</span><span class="code"> vpc_security_group_ids = [aws_default_security_group.dsg.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 98</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=public-ubuntu-from-data)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=public-ubuntu-from-data)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">97</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">98</span><span class="code">resource "aws_instance" "public-ubuntu-from-data" {</span></div><div class="code-line"><span class="code-line-counter">99</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 98</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=pub_ins)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=pub_ins)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">97</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">98</span><span class="code">resource "aws_instance" "pub_ins" {</span></div><div class="code-line"><span class="code-line-counter">99</span><span class="code"> ami = "${data.aws_ami.ubuntu.id}"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">EC2 Not EBS Optimized</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs_optimized" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs_optimized</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">21</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_rules/main.tf</strong>
<span>Line 61</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">60</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">61</span><span class="code">resource "aws_instance" "ec2" {</span></div><div class="code-line"><span class="code-line-counter">62</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 136</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">135</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">136</span><span class="code">resource "aws_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">137</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_ec2_to_default_vpc/main.tf</strong>
<span>Line 49</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">48</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">49</span><span class="code">resource "aws_instance" "t2-instance" {</span></div><div class="code-line"><span class="code-line-counter">50</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/default_sg_in_new_vpc/main.tf</strong>
<span>Line 31</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">30</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">31</span><span class="code">resource "aws_instance" "ec2" {</span></div><div class="code-line"><span class="code-line-counter">32</span><span class="code"> ami = "ami-07cda0db070313c52"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code">// This instance is can potentially be used to hop into the DB</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code">resource "aws_instance" "public_ins" {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> ami = "ami-0130bec6e5047f596"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 87</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">86</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">87</span><span class="code">resource "aws_instance" "test-ec2-instance" {</span></div><div class="code-line"><span class="code-line-counter">88</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 95</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">94</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">95</span><span class="code">resource "aws_instance" "inst2" {</span></div><div class="code-line"><span class="code-line-counter">96</span><span class="code"> vpc_security_group_ids = [aws_default_security_group.dsg.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ec2_ebs_not_optimized/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "aws_instance" "web" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 93</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">92</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">93</span><span class="code">resource "aws_instance" "example_with_ami_from_instance" {</span></div><div class="code-line"><span class="code-line-counter">94</span><span class="code"> ami = aws_ami_from_instance.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 98</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">97</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">98</span><span class="code">resource "aws_instance" "public-ubuntu-from-data" {</span></div><div class="code-line"><span class="code-line-counter">99</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/ec2_without_monitoring/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "aws_instance" "web" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 80</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">79</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">80</span><span class="code">resource "aws_instance" "example_with_copied_ami" {</span></div><div class="code-line"><span class="code-line-counter">81</span><span class="code"> ami = aws_ami_copy.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_security_group/main.tf</strong>
<span>Line 63</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">62</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">63</span><span class="code">resource "aws_instance" "ec2" {</span></div><div class="code-line"><span class="code-line-counter">64</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 106</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">105</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">106</span><span class="code">resource "aws_instance" "priv_ins" {</span></div><div class="code-line"><span class="code-line-counter">107</span><span class="code"> ami = "${data.aws_ami.ubuntu.id}"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 45</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">44</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">45</span><span class="code">resource "aws_instance" "example_with_new_ami" {</span></div><div class="code-line"><span class="code-line-counter">46</span><span class="code"> ami = aws_ami.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 98</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">97</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">98</span><span class="code">resource "aws_instance" "pub_ins" {</span></div><div class="code-line"><span class="code-line-counter">99</span><span class="code"> ami = "${data.aws_ami.ubuntu.id}"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 146</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">145</span><span class="code">// This instance is can potentially be used to hop into the DB</span></div><div class="code-line error"><span class="code-line-counter">146</span><span class="code">resource "aws_instance" "public_ins" {</span></div><div class="code-line"><span class="code-line-counter">147</span><span class="code"> ami = "ami-0130bec6e5047f596"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 83</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">82</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">83</span><span class="code">resource "aws_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">84</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 108</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">107</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">108</span><span class="code">resource "aws_instance" "inst3" {</span></div><div class="code-line"><span class="code-line-counter">109</span><span class="code"> vpc_security_group_ids = [aws_default_security_group.dsg.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 138</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">137</span><span class="code">// This instance is can potentially be used to hop into the DB</span></div><div class="code-line error"><span class="code-line-counter">138</span><span class="code">resource "aws_instance" "public_ins" {</span></div><div class="code-line"><span class="code-line-counter">139</span><span class="code"> ami = "ami-0130bec6e5047f596"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 82</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">81</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">82</span><span class="code">resource "aws_instance" "inst1" {</span></div><div class="code-line"><span class="code-line-counter">83</span><span class="code"> vpc_security_group_ids = [aws_default_security_group.dsg.id]</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">ELB Access Logging Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">ELB should have logging enabled to help on error investigation</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elb#enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elb#enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/elb_without_access_logs/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_elb[{{test}}].access_logs' is defined and not null</span>
<span><strong>Found:</strong> 'aws_elb[{{test}}].access_logs' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elb" "test" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "test-lb-tf"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> availability_zones = ["us-west-2a", "us-west-2b", "us-west-2c"]</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">Name Is Not Snake Case</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">All names should follow snake case pattern.</span><span><a href="https://www.terraform.io/docs/extend/best-practices/naming.html#naming" rel="noopener" target="_blank">https://www.terraform.io/docs/extend/best-practices/naming.html#naming</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">63</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/iam_user_managed_policy_direct_attachment/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'managed-policy-attach' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "aws_iam_user_policy_attachment" "managed-policy-attach" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> user = aws_iam_user.user-1.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 112</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'internet-gateway' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">111</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">112</span><span class="code">resource "aws_internet_gateway" "internet-gateway" {</span></div><div class="code-line"><span class="code-line-counter">113</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/role_assume_policy_principal_all/main.tf</strong>
<span>Line 4</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'over-privilege-role1' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">3</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">4</span><span class="code">resource "aws_iam_role" "over-privilege-role1" {</span></div><div class="code-line"><span class="code-line-counter">5</span><span class="code"> name = "over-privilege-role"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_ec2_to_default_vpc/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'default-subnet' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_subnet" "default-subnet" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> vpc_id = aws_default_vpc.default.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/dynamodb_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'basic-dynamodb-table' is not in snake case</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_dynamodb_table" "basic-dynamodb-table" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "GameScores"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> billing_mode = "PROVISIONED"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/passrole_and_lambda_permissions_cause_priv_escalation/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'allow-policy-1' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code">resource "aws_iam_role_policy" "allow-policy-1" {</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> name = "allow-policy-1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'cdn-content' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_s3_bucket_public_access_block" "cdn-content" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> bucket = aws_s3_bucket.cdn-content.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/iam_user_managed_policy_direct_attachment/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'managed-policy' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "aws_iam_policy" "managed-policy" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> name = "managed-policy"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/role_assume_policy_principal_all/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'over-privilege-role2' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource "aws_iam_role" "over-privilege-role2" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> name = "over-privilege-role"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'public-subnet' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_subnet" "public-subnet" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 103</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'test-queue' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">102</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">103</span><span class="code">resource "aws_sqs_queue" "test-queue" {</span></div><div class="code-line"><span class="code-line-counter">104</span><span class="code"> name = "test-queue"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/dax_cluster_not_encrypted/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'cloudrail-test' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code">resource "aws_dax_cluster" "cloudrail-test" {</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> cluster_name = "non-encrypt"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 66</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'private-rtb' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">65</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">66</span><span class="code">resource "aws_route_table" "private-rtb" {</span></div><div class="code-line"><span class="code-line-counter">67</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 27</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'public-rtb' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">26</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">27</span><span class="code">resource "aws_route_table" "public-rtb" {</span></div><div class="code-line"><span class="code-line-counter">28</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_dms/main.tf</strong>
<span>Line 27</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'dms-cloudwatch-logs-role-AmazonDMSCloudWatchLogsRole' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">26</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">27</span><span class="code">resource "aws_iam_role_policy_attachment" "dms-cloudwatch-logs-role-AmazonDMSCloudWatchLogsRole" {</span></div><div class="code-line"><span class="code-line-counter">28</span><span class="code"> policy_arn = "arn:aws:iam::aws:policy/service-role/AmazonDMSCloudWatchLogsRole"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/dynamodb_without_recovery_enabled/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'basic-dynamodb-table' is not in snake case</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_dynamodb_table" "basic-dynamodb-table" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "GameScores"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> billing_mode = "PROVISIONED"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/iam_user_managed_policy_direct_attachment/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'user-1' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_iam_user" "user-1" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "user-1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 143</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'basic-dynamodb-table' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">142</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">143</span><span class="code">resource "aws_dynamodb_table" "basic-dynamodb-table" {</span></div><div class="code-line"><span class="code-line-counter">144</span><span class="code"> name = "GameScores"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/lambda_not_secure_policy/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'my-lambda-alias' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_lambda_alias" "my-lambda-alias" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> name = "v1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 47</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'private-subnet-nat-gw' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">46</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">47</span><span class="code">resource "aws_nat_gateway" "private-subnet-nat-gw" {</span></div><div class="code-line"><span class="code-line-counter">48</span><span class="code"> allocation_id = aws_eip.allocate-ip-to-nat-gw.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/passrole_and_lambda_permissions_cause_priv_escalation/main.tf</strong>
<span>Line 45</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'allow-policy-2' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">44</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">45</span><span class="code">resource "aws_iam_role_policy" "allow-policy-2" {</span></div><div class="code-line"><span class="code-line-counter">46</span><span class="code"> name = "allow-policy-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 33</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'public-rtb-assoc' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">32</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">33</span><span class="code">resource "aws_route_table_association" "public-rtb-assoc" {</span></div><div class="code-line"><span class="code-line-counter">34</span><span class="code"> subnet_id = aws_subnet.public-subnet.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 13</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'private-subnet' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">12</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">13</span><span class="code">resource "aws_subnet" "private-subnet" {</span></div><div class="code-line"><span class="code-line-counter">14</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_dms/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'dms-vpc-role' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_iam_role" "dms-vpc-role" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> assume_role_policy = data.aws_iam_policy_document.dms_assume_role.json</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 90</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'basic-dynamodb-table' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">89</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">90</span><span class="code">resource "aws_dynamodb_table" "basic-dynamodb-table" {</span></div><div class="code-line"><span class="code-line-counter">91</span><span class="code"> name = "GameScores"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 87</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'test-ec2-instance' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">86</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">87</span><span class="code">resource "aws_instance" "test-ec2-instance" {</span></div><div class="code-line"><span class="code-line-counter">88</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_ec2_to_default_vpc/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'default-route-table-assoc' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">resource "aws_route_table_association" "default-route-table-assoc" {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> subnet_id = aws_subnet.default-subnet.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/public_access_sql_db/main.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'my-sql-database' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code">resource "azurerm_sql_database" "my-sql-database" {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> name = "${local.resource_prefix}sqldatabase"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned_with_overriding_access_block/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'public-bucket' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-3"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/lambda_not_secure_policy/main.tf</strong>
<span>Line 13</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'lambda-role' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">12</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">13</span><span class="code">resource "aws_iam_role" "lambda-role" {</span></div><div class="code-line"><span class="code-line-counter">14</span><span class="code"> name = "lambda-role"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/lambda_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'my-lambda' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_lambda_function" "my-lambda" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> filename = "~/Downloads/lambda.json.zip"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_policy_public_to_all_authenticated_users/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'public-bucket' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-policy-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 61</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'private-rtb-assoc' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">60</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">61</span><span class="code">resource "aws_route_table_association" "private-rtb-assoc" {</span></div><div class="code-line"><span class="code-line-counter">62</span><span class="code"> subnet_id = aws_subnet.private-subnet.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 45</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'public-rtb-assoc' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">44</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">45</span><span class="code">resource "aws_route_table_association" "public-rtb-assoc" {</span></div><div class="code-line"><span class="code-line-counter">46</span><span class="code"> subnet_id = aws_subnet.public-subnet.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'private-rtb' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource "aws_route_table" "private-rtb" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 50</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'public-internet-sg' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">49</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">50</span><span class="code">resource "aws_security_group" "public-internet-sg" {</span></div><div class="code-line"><span class="code-line-counter">51</span><span class="code"> name = "public-internet-sg"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'allow-public-outbound-nacl' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "aws_network_acl" "allow-public-outbound-nacl" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_dms/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'dms-access-for-endpoint-AmazonDMSRedshiftS3Role' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code">resource "aws_iam_role_policy_attachment" "dms-access-for-endpoint-AmazonDMSRedshiftS3Role" {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> policy_arn = "arn:aws:iam::aws:policy/service-role/AmazonDMSRedshiftS3Role"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/public_access_sql_db/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'my-storage-account' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "azurerm_storage_account" "my-storage-account" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> name = "${local.resource_prefix}storageaccount"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/elasticsearch_domain_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'es-not-secure-policy' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_elasticsearch_domain" "es-not-secure-policy" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> domain_name = "es-not-secure-policy"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_authenticated_users_canned/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'public-bucket' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/codbuild_using_aws_key/main.tf</strong>
<span>Line 29</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'project-cloudrail-test' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">28</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">29</span><span class="code">resource "aws_codebuild_project" "project-cloudrail-test" {</span></div><div class="code-line"><span class="code-line-counter">30</span><span class="code"> name = "project-cloudrail-test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/public_access_sql_db/main.tf</strong>
<span>Line 16</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'tests-resource-group' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">15</span><span class="code">}</span></div><div class="code-line error"><span class="code-line-counter">16</span><span class="code">resource "azurerm_resource_group" "tests-resource-group" {</span></div><div class="code-line"><span class="code-line-counter">17</span><span class="code"> name = "${local.resource_prefix}resourcegroup"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudwatch_groups_not_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'cloudrail-test' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_cloudwatch_log_group" "cloudrail-test" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> retention_in_days = 1</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_ec2_to_default_vpc/main.tf</strong>
<span>Line 49</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 't2-instance' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">48</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">49</span><span class="code">resource "aws_instance" "t2-instance" {</span></div><div class="code-line"><span class="code-line-counter">50</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 94</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'sqs-vpc-endpoint' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">93</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">94</span><span class="code">resource "aws_vpc_endpoint" "sqs-vpc-endpoint" {</span></div><div class="code-line"><span class="code-line-counter">95</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_dms/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'dms-access-for-endpoint' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code">resource "aws_iam_role" "dms-access-for-endpoint" {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> assume_role_policy = data.aws_iam_policy_document.dms_assume_role.json</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 56</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'allocate-ip-to-nat-gw' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">55</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">56</span><span class="code">resource "aws_eip" "allocate-ip-to-nat-gw" {</span></div><div class="code-line"><span class="code-line-counter">57</span><span class="code"> vpc = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 20</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'public-rtb' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">19</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">20</span><span class="code">resource "aws_route_table" "public-rtb" {</span></div><div class="code-line"><span class="code-line-counter">21</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 38</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'private-subnet' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">37</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">38</span><span class="code">resource "aws_subnet" "private-subnet" {</span></div><div class="code-line"><span class="code-line-counter">39</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 30</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'dynamodb-vpce-gw' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">29</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">30</span><span class="code">resource "aws_vpc_endpoint" "dynamodb-vpce-gw" {</span></div><div class="code-line"><span class="code-line-counter">31</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'public-subnet' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_subnet" "public-subnet" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/iam_user_inline_policy_attach/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'user-1' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_iam_user" "user-1" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "user-1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 98</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'public-ubuntu-from-data' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">97</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">98</span><span class="code">resource "aws_instance" "public-ubuntu-from-data" {</span></div><div class="code-line"><span class="code-line-counter">99</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_dms/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'dms-cloudwatch-logs-role' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource "aws_iam_role" "dms-cloudwatch-logs-role" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> assume_role_policy = data.aws_iam_policy_document.dms_assume_role.json</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_dms/main.tf</strong>
<span>Line 37</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'dms-vpc-role-AmazonDMSVPCManagementRole' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">36</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">37</span><span class="code">resource "aws_iam_role_policy_attachment" "dms-vpc-role-AmazonDMSVPCManagementRole" {</span></div><div class="code-line"><span class="code-line-counter">38</span><span class="code"> policy_arn = "arn:aws:iam::aws:policy/service-role/AmazonDMSVPCManagementRole"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'public-bucket' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 80</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'allow-public-outbound-nacl' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">79</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">80</span><span class="code">resource "aws_network_acl" "allow-public-outbound-nacl" {</span></div><div class="code-line"><span class="code-line-counter">81</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 98</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'allow-public-outbound-sg' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">97</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">98</span><span class="code">resource "aws_security_group" "allow-public-outbound-sg" {</span></div><div class="code-line"><span class="code-line-counter">99</span><span class="code"> name = "allow-public-outbound-sg"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_ec2_to_default_vpc/main.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'default-route-table' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code">resource "aws_route_table" "default-route-table" {</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> vpc_id = aws_default_vpc.default.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'cdn-content' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_s3_bucket" "cdn-content" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 53</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'allow-public-outbound-sg' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">52</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">53</span><span class="code">resource "aws_security_group" "allow-public-outbound-sg" {</span></div><div class="code-line"><span class="code-line-counter">54</span><span class="code"> name = "allow-public-outbound-sg"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/networking/public_access_sql_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'my-sql-server' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code">resource "azurerm_mssql_server" "my-sql-server" {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> name = "${local.resource_prefix}sqlserver"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">Neptune Logging Is Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Neptune logging should be enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#enable_cloudwatch_logs_exports" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#enable_cloudwatch_logs_exports</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 66</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_neptune_cluster.enable_cloudwatch_logs_exports is defined</span>
<span><strong>Found:</strong> aws_neptune_cluster.enable_cloudwatch_logs_exports is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">65</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">66</span><span class="code">resource "aws_neptune_cluster" "encrypted_neptune_cluster" {</span></div><div class="code-line"><span class="code-line-counter">67</span><span class="code"> cluster_identifier = "cloudrail-test-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/neptune_cluster_no_encryption/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_neptune_cluster.enable_cloudwatch_logs_exports is defined</span>
<span><strong>Found:</strong> aws_neptune_cluster.enable_cloudwatch_logs_exports is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_neptune_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "neptune-cluster-demo"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "neptune"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/neptune_cluster_no_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_neptune_cluster.enable_cloudwatch_logs_exports is defined</span>
<span><strong>Found:</strong> aws_neptune_cluster.enable_cloudwatch_logs_exports is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_neptune_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "neptune-cluster-demo"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "neptune"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">RDS Without Logging</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">RDS does not have any kind of logger</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#enabled_cloudwatch_logs_exports" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#enabled_cloudwatch_logs_exports</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 60</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'enabled_cloudwatch_logs_exports' is defined</span>
<span><strong>Found:</strong> 'enabled_cloudwatch_logs_exports' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">59</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">60</span><span class="code">resource "aws_db_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">61</span><span class="code"> instance_class = "db.t3.micro"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 113</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'enabled_cloudwatch_logs_exports' is defined</span>
<span><strong>Found:</strong> 'enabled_cloudwatch_logs_exports' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">112</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">113</span><span class="code">resource "aws_db_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">114</span><span class="code"> identifier = "tf-test-db"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rds_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'enabled_cloudwatch_logs_exports' is defined</span>
<span><strong>Found:</strong> 'enabled_cloudwatch_logs_exports' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_db_instance" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> allocated_storage = 10</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "mysql"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rds_without_authentication/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'enabled_cloudwatch_logs_exports' is defined</span>
<span><strong>Found:</strong> 'enabled_cloudwatch_logs_exports' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_db_instance" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> allocated_storage = 10</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "mysql"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">Resource Not Using Tags</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">AWS services resource tags are an essential part of managing components</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/guides/resource-tagging" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/guides/resource-tagging</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">266</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/ecs_task_definition_not_encrypted_in_transit/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecs_task_definition[{{service}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_ecs_task_definition[{{service}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "aws_ecs_task_definition" "service" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> family = "cloudrail-test-encryption"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 30</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc_endpoint[{{dynamodb-vpce-gw}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc_endpoint[{{dynamodb-vpce-gw}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">29</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">30</span><span class="code">resource "aws_vpc_endpoint" "dynamodb-vpce-gw" {</span></div><div class="code-line"><span class="code-line-counter">31</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 84</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_route_table[{{nondefault_1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_route_table[{{nondefault_1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">83</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">84</span><span class="code">resource aws_route_table "nondefault_1" {</span></div><div class="code-line"><span class="code-line-counter">85</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudtrail_enabled_on_multi_region/main.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[{{foobar}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_cloudtrail[{{foobar}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"> name = "tf-trail-foobar"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 103</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_cluster[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">102</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">103</span><span class="code">resource "aws_redshift_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">104</span><span class="code"> cluster_identifier = "redshift-defaults-only"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 63</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{nondefault_1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{nondefault_1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">62</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">63</span><span class="code">resource "aws_subnet" "nondefault_1" {</span></div><div class="code-line"><span class="code-line-counter">64</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 56</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_eip[{{allocate-ip-to-nat-gw}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_eip[{{allocate-ip-to-nat-gw}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">55</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">56</span><span class="code">resource "aws_eip" "allocate-ip-to-nat-gw" {</span></div><div class="code-line"><span class="code-line-counter">57</span><span class="code"> vpc = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned_with_overriding_access_block/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{public-bucket}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[{{public-bucket}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-3"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/s3_bucket_object_non_encrypted/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket_object[{{object}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket_object[{{object}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_s3_bucket_object" "object" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> bucket = aws_s3_bucket.cloudrail.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/ecr_not_secure_policy/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecr_repository[{{foo}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_ecr_repository[{{foo}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_ecr_repository" "foo" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "bar"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 63</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_default_security_group[{{dsg}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_default_security_group[{{dsg}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">62</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">63</span><span class="code">resource "aws_default_security_group" "dsg" {</span></div><div class="code-line"><span class="code-line-counter">64</span><span class="code"> vpc_id = aws_vpc.vpc1.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 74</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{nondefault_2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{nondefault_2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">73</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">74</span><span class="code">resource "aws_subnet" "nondefault_2" {</span></div><div class="code-line"><span class="code-line-counter">75</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workspace_root_volume_not_encrypted_at_rest/main.tf</strong>
<span>Line 61</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{workspaces_default}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{workspaces_default}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">60</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">61</span><span class="code">resource "aws_iam_role" "workspaces_default" {</span></div><div class="code-line"><span class="code-line-counter">62</span><span class="code"> name = "workspaces_DefaultRole"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{nondefault}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc[{{nondefault}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_vpc" "nondefault" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cidr_block = "10.1.1.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/sns_topic_encrypted_at_rest_with_aws_managed_key_by_key_arn/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_sns_topic[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_sns_topic[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "aws_sns_topic" "test" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> name = "sns_ecnrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudfront_distribution[{{s3_distribution}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_cloudfront_distribution[{{s3_distribution}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_cloudfront_distribution" "s3_distribution" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> enabled = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workgroups_non_encrypted/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{cloudrail_anthena_bucket_2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[{{cloudrail_anthena_bucket_2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_s3_bucket" "cloudrail_anthena_bucket_2" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> bucket = "cloudrail-wg-encrypted-sse-s3-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/lambda_without_explicit_log_group/main.tf</strong>
<span>Line 29</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_policy[{{lambda_logging}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_policy[{{lambda_logging}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">28</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">29</span><span class="code">resource "aws_iam_policy" "lambda_logging" {</span></div><div class="code-line"><span class="code-line-counter">30</span><span class="code"> name = "lambda_logging"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 107</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_internet_gateway[{{igw}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_internet_gateway[{{igw}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">106</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">107</span><span class="code">resource "aws_internet_gateway" "igw" {</span></div><div class="code-line"><span class="code-line-counter">108</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 26</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{vpc1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc[{{vpc1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">25</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">26</span><span class="code">resource "aws_vpc" "vpc1" {</span></div><div class="code-line"><span class="code-line-counter">27</span><span class="code"> cidr_block = "10.10.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/lambda_not_in_vpc/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{iam_for_lambda}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{iam_for_lambda}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_iam_role" "iam_for_lambda" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "iam_for_lambda"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"></span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/elasticache_replication_group_not_encrypted_in_transit/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_elasticache_replication_group[{{example}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_elasticache_replication_group[{{example}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_elasticache_replication_group" "example" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> automatic_failover_enabled = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/load_balancer_listener_http/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{subnet1}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_subnet[{{subnet1}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"> availability_zone_id = data.aws_availability_zones.available.zone_ids[0]</span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> Name = "subnet1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_authenticated_users_canned/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{public-bucket}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[{{public-bucket}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudtrail_not_encrypted/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[{{foobar}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_cloudtrail[{{foobar}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/kms_key_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_kms_key[{{not_secure_policy}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_kms_key[{{not_secure_policy}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_kms_key" "not_secure_policy" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> description = "KMS key + not_secure_policy"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/human_users_defined/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_user[{{iam_user_2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_user[{{iam_user_2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "aws_iam_user" "iam_user_2" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "iam_user_2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 95</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{inst2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{inst2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">94</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">95</span><span class="code">resource "aws_instance" "inst2" {</span></div><div class="code-line"><span class="code-line-counter">96</span><span class="code"> vpc_security_group_ids = [aws_default_security_group.dsg.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 82</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{inst1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{inst1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">81</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">82</span><span class="code">resource "aws_instance" "inst1" {</span></div><div class="code-line"><span class="code-line-counter">83</span><span class="code"> vpc_security_group_ids = [aws_default_security_group.dsg.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 19</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ebs_volume[{{example}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_ebs_volume[{{example}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">18</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">19</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">20</span><span class="code"> Name = "HelloWorld"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudfront_not_using_waf/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{b}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_s3_bucket[{{b}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> Name = "My bucket"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{subnet2}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_subnet[{{subnet2}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> Name = "subnet2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/hcl_language_complexity/using_count_and_ternary_expr/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_user[{{jill}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_user[{{jill}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource "aws_iam_user" "jill" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> name = "jill"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/ecr_repo_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecr_repository[{{foo}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_ecr_repository[{{foo}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_ecr_repository" "foo" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "bar"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "IMMUTABLE"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/elb_without_access_logs/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_elb[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_elb[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elb" "test" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "test-lb-tf"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> availability_zones = ["us-west-2a", "us-west-2b", "us-west-2c"]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_unused/main.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{example}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc[{{example}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code">resource "aws_vpc" "example" {</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"> cidr_block = "10.0.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workspace_user_volume_not_encrypted_at_rest/main.tf</strong>
<span>Line 61</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{workspaces_default}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{workspaces_default}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">60</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">61</span><span class="code">resource "aws_iam_role" "workspaces_default" {</span></div><div class="code-line"><span class="code-line-counter">62</span><span class="code"> name = "workspaces_DefaultRole"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 136</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">135</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">136</span><span class="code">resource "aws_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">137</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 51</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_nat_gateway[{{private-subnet-nat-gw}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_nat_gateway[{{private-subnet-nat-gw}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">50</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">51</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">52</span><span class="code"> Name = "gw NAT"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/cloudwatch_log_destination_insecure_policy/main.tf</strong>
<span>Line 29</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{iam_for_cloudwatch}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{iam_for_cloudwatch}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">28</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">29</span><span class="code">resource "aws_iam_role" "iam_for_cloudwatch" {</span></div><div class="code-line"><span class="code-line-counter">30</span><span class="code"> name = "iam_for_cloudwatch"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 84</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_route_table[{{nondefault_1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_route_table[{{nondefault_1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">83</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">84</span><span class="code">resource aws_route_table "nondefault_1" {</span></div><div class="code-line"><span class="code-line-counter">85</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/iam_user_inline_policy_attach/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_user[{{user-1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_user[{{user-1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_iam_user" "user-1" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "user-1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/role_assume_policy_principal_all/main.tf</strong>
<span>Line 4</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{over-privilege-role1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{over-privilege-role1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">3</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">4</span><span class="code">resource "aws_iam_role" "over-privilege-role1" {</span></div><div class="code-line"><span class="code-line-counter">5</span><span class="code"> name = "over-privilege-role"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 92</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{esdomain}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{esdomain}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">91</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">92</span><span class="code">resource "aws_security_group" "esdomain" {</span></div><div class="code-line"><span class="code-line-counter">93</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_rules/main.tf</strong>
<span>Line 38</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{subnet}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{subnet}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">37</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">38</span><span class="code">resource "aws_subnet" "subnet" {</span></div><div class="code-line"><span class="code-line-counter">39</span><span class="code"> vpc_id = aws_vpc.vpc.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 143</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_dynamodb_table[{{basic-dynamodb-table}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_dynamodb_table[{{basic-dynamodb-table}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">142</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">143</span><span class="code">resource "aws_dynamodb_table" "basic-dynamodb-table" {</span></div><div class="code-line"><span class="code-line-counter">144</span><span class="code"> name = "GameScores"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 38</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_internet_gateway[{{igw}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_internet_gateway[{{igw}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">37</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">38</span><span class="code">resource "aws_internet_gateway" "igw" {</span></div><div class="code-line"><span class="code-line-counter">39</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 20</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{nondefault_1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{nondefault_1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">19</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">20</span><span class="code">resource "aws_subnet" "nondefault_1" {</span></div><div class="code-line"><span class="code-line-counter">21</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/codbuild_using_aws_key/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{codebuild}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{codebuild}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"># No policy attached to this role because it is for testing purposes</span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_iam_role" "codebuild" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> name = "codebuild-cloudrail-test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 74</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{nondefault_2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{nondefault_2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">73</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">74</span><span class="code">resource "aws_subnet" "nondefault_2" {</span></div><div class="code-line"><span class="code-line-counter">75</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/kms_uses_rotation/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_kms_key[{{a}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_kms_key[{{a}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_kms_key" "a" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> description = "KMS key 1"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> deletion_window_in_days = 10</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/ec2_without_monitoring/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{web}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_instance[{{web}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> Name = "HelloWorld"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/lambda_not_secure_policy/main.tf</strong>
<span>Line 13</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{lambda-role}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{lambda-role}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">12</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">13</span><span class="code">resource "aws_iam_role" "lambda-role" {</span></div><div class="code-line"><span class="code-line-counter">14</span><span class="code"> name = "lambda-role"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{main}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc[{{main}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_vpc" "main" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cidr_block = "192.168.100.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workspace_user_volume_not_encrypted_at_rest/main.tf</strong>
<span>Line 47</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_workspaces_directory[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_workspaces_directory[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">46</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">47</span><span class="code">resource "aws_workspaces_directory" "test" {</span></div><div class="code-line"><span class="code-line-counter">48</span><span class="code"> directory_id = aws_directory_service_directory.test.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 114</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{publicly_accessible_sg}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{publicly_accessible_sg}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">113</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">114</span><span class="code">resource "aws_security_group" "publicly_accessible_sg" {</span></div><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/eks_logging_disabled/main.tf</strong>
<span>Line 19</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_eks_cluster[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_eks_cluster[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">18</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">19</span><span class="code">resource "aws_eks_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">20</span><span class="code"> name = "test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/glue_data_catalog_not_secure_policy/main.tf</strong>
<span>Line 33</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{cloudrail}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[{{cloudrail}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">32</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">33</span><span class="code">resource "aws_s3_bucket" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">34</span><span class="code"> bucket = "cloudrail-glue"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/over_exposed_vpc_peering/main.tf</strong>
<span>Line 45</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{subnet2_2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{subnet2_2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">44</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">45</span><span class="code">resource "aws_subnet" "subnet2_2" {</span></div><div class="code-line"><span class="code-line-counter">46</span><span class="code"> vpc_id = aws_vpc.vpc2.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/policy_missing_principal/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_kms_key[{{secure_policy}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_kms_key[{{secure_policy}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_kms_key" "secure_policy" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> description = "KMS key + secure_policy"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 75</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_route_table[{{private-rtb}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_route_table[{{private-rtb}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">74</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">75</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">76</span><span class="code"> Name = "private-rtb"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 108</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{inst3}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{inst3}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">107</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">108</span><span class="code">resource "aws_instance" "inst3" {</span></div><div class="code-line"><span class="code-line-counter">109</span><span class="code"> vpc_security_group_ids = [aws_default_security_group.dsg.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{main}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc[{{main}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code">resource "aws_vpc" "main" {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> cidr_block = local.cidr_block</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/over_exposed_vpc_peering/main.tf</strong>
<span>Line 162</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_route_table[{{subnet2_1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_route_table[{{subnet2_1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">161</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">162</span><span class="code">resource "aws_route_table" "subnet2_1" {</span></div><div class="code-line"><span class="code-line-counter">163</span><span class="code"> vpc_id = aws_vpc.vpc2.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 75</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ami_copy[{{example}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_ami_copy[{{example}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">74</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">75</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">76</span><span class="code"> Name = "HelloWorld"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/docdb_cluster_encrypted_without_kms_key/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_docdb_cluster[{{test1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_docdb_cluster[{{test1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_docdb_cluster" "test1" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "my-docdb-cluster-test1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/s3_bucket_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{cloudrail}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[{{cloudrail}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "cloudrail-non-encrypted-czx7zxchs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/elasticache_replication_group_not_encrypted_at_rest/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_elasticache_replication_group[{{example}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_elasticache_replication_group[{{example}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticache_replication_group" "example" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> automatic_failover_enabled = true</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> availability_zones = ["us-west-2a", "us-west-2b"]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 146</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{public_ins}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{public_ins}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">145</span><span class="code">// This instance is can potentially be used to hop into the DB</span></div><div class="code-line error"><span class="code-line-counter">146</span><span class="code">resource "aws_instance" "public_ins" {</span></div><div class="code-line"><span class="code-line-counter">147</span><span class="code"> ami = "ami-0130bec6e5047f596"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_dms/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{dms-vpc-role}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{dms-vpc-role}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_iam_role" "dms-vpc-role" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> assume_role_policy = data.aws_iam_policy_document.dms_assume_role.json</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 83</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">82</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">83</span><span class="code">resource "aws_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">84</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_rules/main.tf</strong>
<span>Line 61</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{ec2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{ec2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">60</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">61</span><span class="code">resource "aws_instance" "ec2" {</span></div><div class="code-line"><span class="code-line-counter">62</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 26</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{nondefault_2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{nondefault_2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">25</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">26</span><span class="code">resource "aws_subnet" "nondefault_2" {</span></div><div class="code-line"><span class="code-line-counter">27</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudfront_distribution_without_logging/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{b}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_s3_bucket[{{b}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> Name = "My bucket"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{free}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{free}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_security_group" "free" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> vpc_id = aws_vpc.external.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_ec2_to_default_vpc/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{default-subnet}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{default-subnet}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_subnet" "default-subnet" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> vpc_id = aws_default_vpc.default.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/tag_all_items/main.tf</strong>
<span>Line 7</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_sns_topic[{{cloudrail_1}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_sns_topic[{{cloudrail_1}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "sns_not_ecnrypted-1"</span></div><div class="code-line error"><span class="code-line-counter">7</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">8</span><span class="code"> Name = "Sns Topic Cloudrail Test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_ec2_to_default_vpc/main.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_route_table[{{default-route-table}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_route_table[{{default-route-table}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code">resource "aws_route_table" "default-route-table" {</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> vpc_id = aws_default_vpc.default.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/load_balancer_listener_http/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{vpc1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc[{{vpc1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_vpc" "vpc1" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cidr_block = "10.10.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/elasticsearch_domain_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_elasticsearch_domain[{{es-not-secure-policy}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_elasticsearch_domain[{{es-not-secure-policy}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_elasticsearch_domain" "es-not-secure-policy" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> domain_name = "es-not-secure-policy"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workspace_root_volume_not_encrypted_at_rest/main.tf</strong>
<span>Line 76</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_workspaces_workspace[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_workspaces_workspace[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">75</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">76</span><span class="code">resource "aws_workspaces_workspace" "test" {</span></div><div class="code-line"><span class="code-line-counter">77</span><span class="code"> directory_id = aws_workspaces_directory.test.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 48</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_network_acl[{{allow-public-outbound-nacl}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_network_acl[{{allow-public-outbound-nacl}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">47</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">48</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">49</span><span class="code"> Name = "allow-public-outbound-nacl"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 80</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{example_with_copied_ami}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{example_with_copied_ami}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">79</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">80</span><span class="code">resource "aws_instance" "example_with_copied_ami" {</span></div><div class="code-line"><span class="code-line-counter">81</span><span class="code"> ami = aws_ami_copy.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/neptune_cluster_no_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_neptune_cluster[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_neptune_cluster[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_neptune_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "neptune-cluster-demo"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "neptune"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{external}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_vpc[{{external}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"> enable_dns_hostnames = "true"</span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> Name = "external-vpc"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 138</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{public_ins}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{public_ins}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">137</span><span class="code">// This instance is can potentially be used to hop into the DB</span></div><div class="code-line error"><span class="code-line-counter">138</span><span class="code">resource "aws_instance" "public_ins" {</span></div><div class="code-line"><span class="code-line-counter">139</span><span class="code"> ami = "ami-0130bec6e5047f596"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 97</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_db_subnet_group[{{db}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_db_subnet_group[{{db}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">96</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">97</span><span class="code">resource "aws_db_subnet_group" "db" {</span></div><div class="code-line"><span class="code-line-counter">98</span><span class="code"> name = "rds_db"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_rules/main.tf</strong>
<span>Line 33</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{default}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_security_group[{{default}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">32</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">33</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">34</span><span class="code"> Name = "example_rule_with_descriptions"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_rest_api[{{api_gw}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_api_gateway_rest_api[{{api_gw}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_api_gateway_rest_api" "api_gw" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "api-gw-cache-non-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/glacier_vault_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_sns_topic[{{aws_sns_topic}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_sns_topic[{{aws_sns_topic}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_sns_topic" "aws_sns_topic" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "glacier-sns-topic"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/secrets_manager_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_secretsmanager_secret[{{not_secure_policy}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_secretsmanager_secret[{{not_secure_policy}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_secretsmanager_secret" "not_secure_policy" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "not_secure_secret"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/default_sg_in_new_vpc/main.tf</strong>
<span>Line 26</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{subnet}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_subnet[{{subnet}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">25</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">26</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">27</span><span class="code"> Name = local.test_name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 50</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{public-internet-sg}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{public-internet-sg}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">49</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">50</span><span class="code">resource "aws_security_group" "public-internet-sg" {</span></div><div class="code-line"><span class="code-line-counter">51</span><span class="code"> name = "public-internet-sg"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{nondefault}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc[{{nondefault}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_vpc" "nondefault" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> cidr_block = "10.1.1.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 107</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_elasticsearch_domain[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_elasticsearch_domain[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">106</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">107</span><span class="code">resource "aws_elasticsearch_domain" "test" {</span></div><div class="code-line"><span class="code-line-counter">108</span><span class="code"> domain_name = "test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/sqs_queue_not_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_sqs_queue[{{cloudrail}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_sqs_queue[{{cloudrail}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_sqs_queue" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "sqs_non_encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/hcl_language_complexity/using_count_and_ternary_expr/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_user[{{jack}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_user[{{jack}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_iam_user" "jack" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> name = "jack"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/role_assume_policy_principal_all/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{over-privilege-role2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{over-privilege-role2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource "aws_iam_role" "over-privilege-role2" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> name = "over-privilege-role"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/glacier_vault_not_secure_policy/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_glacier_vault[{{not_secure_archive}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_glacier_vault[{{not_secure_archive}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "aws_glacier_vault" "not_secure_archive" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> name = "not_secure_archive"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_ec2_to_default_vpc/main.tf</strong>
<span>Line 49</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{t2-instance}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{t2-instance}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">48</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">49</span><span class="code">resource "aws_instance" "t2-instance" {</span></div><div class="code-line"><span class="code-line-counter">50</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_db_subnet_group[{{nondefault}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_db_subnet_group[{{nondefault}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_db_subnet_group" nondefault {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> name = "nondefault"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{public-subnet}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_subnet[{{public-subnet}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> Name = "public-subnet"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/cloudwatch_log_destination_insecure_policy/main.tf</strong>
<span>Line 49</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_kinesis_stream[{{kinesis_for_cloudwatch}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_kinesis_stream[{{kinesis_for_cloudwatch}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">48</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">49</span><span class="code">resource "aws_kinesis_stream" "kinesis_for_cloudwatch" {</span></div><div class="code-line"><span class="code-line-counter">50</span><span class="code"> name = "kinesis_for_cloudwatch"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/tag_all_items/main.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_sqs_queue[{{cloudrail}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_sqs_queue[{{cloudrail}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"> name = "sqs_non_encrypted"</span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code"> Name = "Sqs Cloudrail Test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/redshift_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster[{{default}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_cluster[{{default}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_redshift_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "tf-redshift-cluster"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> database_name = "mydb"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workgroups_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{cloudrail_anthena_bucket}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[{{cloudrail_anthena_bucket}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "cloudrail_anthena_bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "cloudrail-wg-encrypted-sse-s3"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 31</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_network_acl[{{ec2_nacl}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_network_acl[{{ec2_nacl}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">30</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">31</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">32</span><span class="code"> Name = "main"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{private-subnet}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_subnet[{{private-subnet}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> Name = "private-subnet"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudtrail_file_log_validation_disabled/main.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudtrail[{{foobar}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_cloudtrail[{{foobar}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">resource "aws_cloudtrail" "foobar" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> name = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/default_sg_in_new_vpc/main.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{vpc}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_vpc[{{vpc}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> Name = local.test_name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/over_exposed_vpc_peering/main.tf</strong>
<span>Line 92</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc_peering_connection[{{this}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc_peering_connection[{{this}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">91</span><span class="code">##########################</span></div><div class="code-line error"><span class="code-line-counter">92</span><span class="code">resource "aws_vpc_peering_connection" "this" {</span></div><div class="code-line"><span class="code-line-counter">93</span><span class="code"> provider = aws.this</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/tag_all_items/plan.json</strong>
<span>Line 55</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_sqs_queue[{{cloudrail}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_sqs_queue[{{cloudrail}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">54</span><span class="code"> "redrive_policy": null,</span></div><div class="code-line error"><span class="code-line-counter">55</span><span class="code"> "tags": {</span></div><div class="code-line"><span class="code-line-counter">56</span><span class="code"> "Name": "Sqs Cloudrail Test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/secretsmanager_secrets_encrypted_at_rest_with_aws_managed_key_by_default/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_secretsmanager_secret[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_secretsmanager_secret[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_secretsmanager_secret" "test" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "test-cloudrail"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_rest_api[{{api_gw}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_api_gateway_rest_api[{{api_gw}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_api_gateway_rest_api" "api_gw" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "api-gw-cache-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/iam_user_managed_policy_direct_attachment/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_policy[{{managed-policy}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_policy[{{managed-policy}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "aws_iam_policy" "managed-policy" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> name = "managed-policy"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_security_group/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{vpc}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc[{{vpc}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_vpc" "vpc" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> cidr_block = local.cidr_block</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/rds_retention_period_set/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_rds_cluster[{{default}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_rds_cluster[{{default}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_rds_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "aurora-cluster-demo"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "aurora-mysql"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_rest_api[{{api_gw}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_api_gateway_rest_api[{{api_gw}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_api_gateway_rest_api" "api_gw" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "api-gw-cache-non-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 88</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ami_from_instance[{{example}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_ami_from_instance[{{example}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">87</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">88</span><span class="code">resource "aws_ami_from_instance" "example" {</span></div><div class="code-line"><span class="code-line-counter">89</span><span class="code"> name = "terraform-example3"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 102</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{public-ubuntu-from-data}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_instance[{{public-ubuntu-from-data}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">101</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">102</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">103</span><span class="code"> Name = "public-ubuntu-from-data"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/glue_data_catalog_not_secure_policy/main.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{cloudrail_glue_iam}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{cloudrail_glue_iam}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code">resource "aws_iam_role" "cloudrail_glue_iam" {</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code"> name = "cloudrail_glue_iam"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_route_table[{{public-rtb}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_route_table[{{public-rtb}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> Name = "public-rtb"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 53</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{allow-public-outbound-sg}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{allow-public-outbound-sg}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">52</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">53</span><span class="code">resource "aws_security_group" "allow-public-outbound-sg" {</span></div><div class="code-line"><span class="code-line-counter">54</span><span class="code"> name = "allow-public-outbound-sg"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/eks_logging_disabled/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{vpc}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc[{{vpc}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_vpc" "vpc" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> cidr_block = "10.0.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 49</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lb[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_lb[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">48</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">49</span><span class="code">resource "aws_lb" "test" {</span></div><div class="code-line"><span class="code-line-counter">50</span><span class="code"> name = "test123"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_security_group/main.tf</strong>
<span>Line 63</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{ec2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{ec2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">62</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">63</span><span class="code">resource "aws_instance" "ec2" {</span></div><div class="code-line"><span class="code-line-counter">64</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 50</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{test_role}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{test_role}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">49</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">50</span><span class="code">resource "aws_iam_role" "test_role" {</span></div><div class="code-line"><span class="code-line-counter">51</span><span class="code"> name = "test_role"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/lambda_without_xray/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{iam_for_lambda}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{iam_for_lambda}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_iam_role" "iam_for_lambda" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "iam_for_lambda"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"></span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 60</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_db_instance[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_db_instance[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">59</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">60</span><span class="code">resource "aws_db_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">61</span><span class="code"> instance_class = "db.t3.micro"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/globalaccelerator_accelerator_no_flow_logs/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_globalaccelerator_accelerator[{{example}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_globalaccelerator_accelerator[{{example}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_globalaccelerator_accelerator" "example" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "Example"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> ip_address_type = "IPV4"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 98</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{allow-public-outbound-sg}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{allow-public-outbound-sg}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">97</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">98</span><span class="code">resource "aws_security_group" "allow-public-outbound-sg" {</span></div><div class="code-line"><span class="code-line-counter">99</span><span class="code"> name = "allow-public-outbound-sg"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_dms/main.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{dms-cloudwatch-logs-role}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{dms-cloudwatch-logs-role}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource "aws_iam_role" "dms-cloudwatch-logs-role" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> assume_role_policy = data.aws_iam_policy_document.dms_assume_role.json</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 90</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_dynamodb_table[{{basic-dynamodb-table}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_dynamodb_table[{{basic-dynamodb-table}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">89</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">90</span><span class="code">resource "aws_dynamodb_table" "basic-dynamodb-table" {</span></div><div class="code-line"><span class="code-line-counter">91</span><span class="code"> name = "GameScores"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 66</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_neptune_cluster[{{encrypted_neptune_cluster}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_neptune_cluster[{{encrypted_neptune_cluster}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">65</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">66</span><span class="code">resource "aws_neptune_cluster" "encrypted_neptune_cluster" {</span></div><div class="code-line"><span class="code-line-counter">67</span><span class="code"> cluster_identifier = "cloudrail-test-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rest_api_without_authorization/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_stage[{{api_gw_stage}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_api_gateway_stage[{{api_gw_stage}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_unused/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{allow_tls}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_security_group[{{allow_tls}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> Name = "allow_tls"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rds_cluster_encrypt_at_rest_disabled/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_rds_cluster[{{default}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_rds_cluster[{{default}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_rds_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "cloudrail-test-non-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 34</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{subnet1}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_subnet[{{subnet1}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">33</span><span class="code"> availability_zone_id = data.aws_availability_zones.available.zone_ids[0]</span></div><div class="code-line error"><span class="code-line-counter">34</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">35</span><span class="code"> Name = "subnet1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 63</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_network_acl[{{redshift_eni2_nacl}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_network_acl[{{redshift_eni2_nacl}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">62</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">63</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">64</span><span class="code"> Name = "main"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/elasticache_automatic_backup/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_elasticache_cluster[{{disabled}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_elasticache_cluster[{{disabled}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "aws_elasticache_cluster" "disabled" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> cluster_id = "cluster"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 93</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{example_with_ami_from_instance}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{example_with_ami_from_instance}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">92</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">93</span><span class="code">resource "aws_instance" "example_with_ami_from_instance" {</span></div><div class="code-line"><span class="code-line-counter">94</span><span class="code"> ami = aws_ami_from_instance.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudwatch_groups_not_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_cloudwatch_log_group[{{cloudrail-test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_cloudwatch_log_group[{{cloudrail-test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_cloudwatch_log_group" "cloudrail-test" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> retention_in_days = 1</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workspace_root_volume_not_encrypted_at_rest/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_directory_service_directory[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_directory_service_directory[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_directory_service_directory" "test" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> name = "corp.notexample.com"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/alb_use_http/main.tf</strong>
<span>Line 56</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lb_target_group[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_lb_target_group[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">55</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">56</span><span class="code">resource "aws_lb_target_group" "test" {</span></div><div class="code-line"><span class="code-line-counter">57</span><span class="code"> port = 80</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/neptune_cluster_no_encryption/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_neptune_cluster[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_neptune_cluster[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_neptune_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "neptune-cluster-demo"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "neptune"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 42</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{private-subnet}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_subnet[{{private-subnet}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">41</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">42</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">43</span><span class="code"> Name = "private-subnet"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 45</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{example_with_new_ami}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{example_with_new_ami}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">44</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">45</span><span class="code">resource "aws_instance" "example_with_new_ami" {</span></div><div class="code-line"><span class="code-line-counter">46</span><span class="code"> ami = aws_ami.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_security_group/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{default}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_security_group[{{default}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> Name = "example_rule_with_descriptions"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/lambda_without_explicit_log_group/main.tf</strong>
<span>Line 57</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lambda_function[{{test_lambda}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_lambda_function[{{test_lambda}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">56</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">57</span><span class="code">resource "aws_lambda_function" "test_lambda" {</span></div><div class="code-line"><span class="code-line-counter">58</span><span class="code"> filename = "${path.module}/Archive.zip"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 47</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{free_1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{free_1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">46</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">47</span><span class="code">resource "aws_subnet" "free_1" {</span></div><div class="code-line"><span class="code-line-counter">48</span><span class="code"> vpc_id = aws_vpc.external.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/load_balancer_listener_http/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_internet_gateway[{{igw1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_internet_gateway[{{igw1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_internet_gateway" "igw1" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> vpc_id = aws_vpc.vpc1.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/eks_logging_disabled/main.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{subnet1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{subnet1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code">resource "aws_subnet" "subnet1" {</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code"> cidr_block = "10.0.0.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 80</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_internet_gateway[{{igw}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_internet_gateway[{{igw}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">79</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">80</span><span class="code">resource "aws_internet_gateway" "igw" {</span></div><div class="code-line"><span class="code-line-counter">81</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_dms/main.tf</strong>
<span>Line 67</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_dms_replication_instance[{{test}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_dms_replication_instance[{{test}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">66</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">67</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">68</span><span class="code"> Name = "test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/tag_all_items/plan.json</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_sns_topic[{{cloudrail_1}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_sns_topic[{{cloudrail_1}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"> "sqs_success_feedback_sample_rate": null,</span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code"> "tags": {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> "Name": "Sns Topic Cloudrail Test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/passrole_and_lambda_permissions_cause_priv_escalation/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{role}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{role}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_iam_role" "role" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "role"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 106</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{priv_ins}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{priv_ins}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">105</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">106</span><span class="code">resource "aws_instance" "priv_ins" {</span></div><div class="code-line"><span class="code-line-counter">107</span><span class="code"> ami = "${data.aws_ami.ubuntu.id}"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workspace_user_volume_not_encrypted_at_rest/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_directory_service_directory[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_directory_service_directory[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_directory_service_directory" "test" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> name = "corp.notexample.com"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/iam_user_managed_policy_direct_attachment/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_user[{{user-1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_user[{{user-1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_iam_user" "user-1" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "user-1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/default_sg_in_new_vpc/main.tf</strong>
<span>Line 36</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{ec2}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_instance[{{ec2}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">35</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">36</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">37</span><span class="code"> Name = local.test_name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_acl_public_all_users_canned/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{public-bucket}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[{{public-bucket}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-acl-1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_dms/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{dms-access-for-endpoint}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{dms-access-for-endpoint}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code">resource "aws_iam_role" "dms-access-for-endpoint" {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> assume_role_policy = data.aws_iam_policy_document.dms_assume_role.json</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 98</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{pub_ins}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{pub_ins}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">97</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">98</span><span class="code">resource "aws_instance" "pub_ins" {</span></div><div class="code-line"><span class="code-line-counter">99</span><span class="code"> ami = "${data.aws_ami.ubuntu.id}"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/lambda_without_explicit_log_group/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{iam_for_lambda}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{iam_for_lambda}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "aws_iam_role" "iam_for_lambda" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> name = "iam_for_lambda"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rds_without_logging/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_db_instance[{{default}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_db_instance[{{default}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_db_instance" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> allocated_storage = 10</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "mysql"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 113</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_db_instance[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_db_instance[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">112</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">113</span><span class="code">resource "aws_db_instance" "test" {</span></div><div class="code-line"><span class="code-line-counter">114</span><span class="code"> identifier = "tf-test-db"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/codbuild_using_aws_key/main.tf</strong>
<span>Line 29</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_codebuild_project[{{project-cloudrail-test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_codebuild_project[{{project-cloudrail-test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">28</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">29</span><span class="code">resource "aws_codebuild_project" "project-cloudrail-test" {</span></div><div class="code-line"><span class="code-line-counter">30</span><span class="code"> name = "project-cloudrail-test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 68</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{nondefault_1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{nondefault_1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">67</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">68</span><span class="code">resource "aws_subnet" "nondefault_1" {</span></div><div class="code-line"><span class="code-line-counter">69</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 76</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_neptune_cluster_instance[{{neptune_instance}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_neptune_cluster_instance[{{neptune_instance}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">75</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">76</span><span class="code">resource "aws_neptune_cluster_instance" "neptune_instance" {</span></div><div class="code-line"><span class="code-line-counter">77</span><span class="code"> count = 2</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 103</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_sqs_queue[{{test-queue}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_sqs_queue[{{test-queue}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">102</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">103</span><span class="code">resource "aws_sqs_queue" "test-queue" {</span></div><div class="code-line"><span class="code-line-counter">104</span><span class="code"> name = "test-queue"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/human_users_defined/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_user[{{iam_user_1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_user[{{iam_user_1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_iam_user" "iam_user_1" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "iam_user_1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 115</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_internet_gateway[{{internet-gateway}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_internet_gateway[{{internet-gateway}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">114</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">115</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">116</span><span class="code"> Name = "internet-gateway"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/lambda_not_in_vpc/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lambda_function[{{test_lambda}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_lambda_function[{{test_lambda}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code">resource "aws_lambda_function" "test_lambda" {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> filename = "lambda_function_payload.zip"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ec2_ebs_not_optimized/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{web}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_instance[{{web}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> Name = "HelloWorld"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 97</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_subnet_group[{{nondefault}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_subnet_group[{{nondefault}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">96</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">97</span><span class="code">resource "aws_redshift_subnet_group" nondefault {</span></div><div class="code-line"><span class="code-line-counter">98</span><span class="code"> name = "nondefault"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/s3_bucket_object_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{cloudrail}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[{{cloudrail}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "cloudrail" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "cloudrail-non-encrypted-czx7zxchs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/load_balancer_listener_http/main.tf</strong>
<span>Line 36</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_route_table[{{rt1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_route_table[{{rt1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">35</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">36</span><span class="code">resource "aws_route_table" "rt1" {</span></div><div class="code-line"><span class="code-line-counter">37</span><span class="code"> vpc_id = aws_vpc.vpc1.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/elasticache_automatic_backup/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_elasticache_cluster[{{default}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_elasticache_cluster[{{default}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticache_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_id = "cluster"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "redis"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 59</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_db_subnet_group[{{free}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_db_subnet_group[{{free}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">58</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">59</span><span class="code">resource "aws_db_subnet_group" free {</span></div><div class="code-line"><span class="code-line-counter">60</span><span class="code"> name = "free"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/efs_not_secure_policy/main.tf</strong>
<span>Line 8</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_efs_file_system[{{not_secure}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_efs_file_system[{{not_secure}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">7</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">8</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">9</span><span class="code"> Name = "NotSecure"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_internet_gateway[{{igw}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_internet_gateway[{{igw}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code">resource "aws_internet_gateway" "igw" {</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code"> vpc_id = aws_vpc.external.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_route_table[{{private-rtb}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_route_table[{{private-rtb}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> Name = "private-rtb"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/athena_not_encrypted/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{hoge}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[{{hoge}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "hoge" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> bucket = "hoge"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workspace_user_volume_not_encrypted_at_rest/main.tf</strong>
<span>Line 76</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_workspaces_workspace[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_workspaces_workspace[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">75</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">76</span><span class="code">resource "aws_workspaces_workspace" "test" {</span></div><div class="code-line"><span class="code-line-counter">77</span><span class="code"> directory_id = aws_workspaces_directory.test.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{nondefault}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{nondefault}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "aws_security_group" "nondefault" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/hcl_language_complexity/using_locals/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_user[{{example}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_user[{{example}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_iam_user" "example" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "example"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/redshift_not_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster[{{default}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_cluster[{{default}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_redshift_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "tf-redshift-cluster"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-authentication/rds_without_authentication/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_db_instance[{{default}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_db_instance[{{default}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_db_instance" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> allocated_storage = 10</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "mysql"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 8</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{main}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc[{{main}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">7</span><span class="code">}</span></div><div class="code-line error"><span class="code-line-counter">8</span><span class="code">resource "aws_vpc" "main" {</span></div><div class="code-line"><span class="code-line-counter">9</span><span class="code"> cidr_block = "192.168.100.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_dms/main.tf</strong>
<span>Line 50</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_dms_replication_subnet_group[{{test}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_dms_replication_subnet_group[{{test}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">49</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">50</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">51</span><span class="code"> Name = "test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 69</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{nondefault_2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{nondefault_2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">68</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">69</span><span class="code">resource "aws_subnet" "nondefault_2" {</span></div><div class="code-line"><span class="code-line-counter">70</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/deploy_redshift_in_ec2_classic_mode/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_redshift_cluster[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_redshift_cluster[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_redshift_cluster" "test" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "redshift-defaults-only"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/hcl_language_complexity/using_module_multi/mymodule/user.tf</strong>
<span>Line 13</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_user[{{user}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_user[{{user}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">12</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">13</span><span class="code">resource "aws_iam_user" "user" {</span></div><div class="code-line"><span class="code-line-counter">14</span><span class="code"> name = var.user_name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/cloudtrail_enabled_on_multi_region/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{foo}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[{{foo}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> bucket = "tf-test-trail"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workgroups_non_encrypted/main.tf</strong>
<span>Line 45</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_athena_workgroup[{{cloudrail_wg_2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_athena_workgroup[{{cloudrail_wg_2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">44</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">45</span><span class="code">resource "aws_athena_workgroup" "cloudrail_wg_2" {</span></div><div class="code-line"><span class="code-line-counter">46</span><span class="code"> name = "cloudrail-wg-encrypted-sse-s3-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/load_balancer_listener_http/main.tf</strong>
<span>Line 27</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{subnet2}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_subnet[{{subnet2}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">26</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">27</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">28</span><span class="code"> Name = "subnet2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 29</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_route_table[{{rt}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_route_table[{{rt}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">28</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">29</span><span class="code">resource "aws_route_table" "rt" {</span></div><div class="code-line"><span class="code-line-counter">30</span><span class="code"> vpc_id = aws_vpc.external.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_security_group/main.tf</strong>
<span>Line 40</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{subnet}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{subnet}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">39</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">40</span><span class="code">resource "aws_subnet" "subnet" {</span></div><div class="code-line"><span class="code-line-counter">41</span><span class="code"> vpc_id = aws_vpc.vpc.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 42</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_route_table[{{nondefault}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_route_table[{{nondefault}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">41</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">42</span><span class="code">resource "aws_route_table" "nondefault" {</span></div><div class="code-line"><span class="code-line-counter">43</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 80</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_internet_gateway[{{igw}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_internet_gateway[{{igw}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">79</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">80</span><span class="code">resource "aws_internet_gateway" "igw" {</span></div><div class="code-line"><span class="code-line-counter">81</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/eks_logging_disabled/main.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{eksrole}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{eksrole}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code">resource "aws_iam_role" "eksrole" {</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"> assume_role_policy = ""</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/load_balancer_listener_http/main.tf</strong>
<span>Line 54</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lb_target_group[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_lb_target_group[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">53</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">54</span><span class="code">resource "aws_lb_target_group" "test" {</span></div><div class="code-line"><span class="code-line-counter">55</span><span class="code"> vpc_id = aws_vpc.vpc1.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ecr_use_image_scanning/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecr_repository[{{foo}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_ecr_repository[{{foo}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_ecr_repository" "foo" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "bar"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ecs_cluster_container_insights/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecs_cluster[{{foo}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_ecs_cluster[{{foo}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_ecs_cluster" "foo" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "white-hart"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"></span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/s3_bucket_policy_public_to_all_authenticated_users/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{public-bucket}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[{{public-bucket}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_s3_bucket" "public-bucket" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "bucket-with-public-policy-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/over_exposed_vpc_peering/main.tf</strong>
<span>Line 30</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{subnet1_2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{subnet1_2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">29</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">30</span><span class="code">resource "aws_subnet" "subnet1_2" {</span></div><div class="code-line"><span class="code-line-counter">31</span><span class="code"> vpc_id = aws_vpc.vpc1.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/policy-too-broad/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{role}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{role}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_iam_role" "role" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "role"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_rest_api[{{api_gw}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_api_gateway_rest_api[{{api_gw}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_api_gateway_rest_api" "api_gw" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "api-gw-cache-non-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/rest_api_cache_non_encrypted/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_stage[{{api_gw_stage}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_api_gateway_stage[{{api_gw_stage}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_protocol_version_is_low/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{logging}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_s3_bucket[{{logging}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> Name = "dist-cloud-test-logs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/api_gateway_no_xray/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_stage[{{api_gw_stage}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_api_gateway_stage[{{api_gw_stage}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 36</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_network_acl[{{ec2_nacl}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_network_acl[{{ec2_nacl}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">35</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">36</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">37</span><span class="code"> Name = "main"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/rest_api_not_secure_policy/main.tf</strong>
<span>Line 72</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_stage[{{api_gw_stage}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_api_gateway_stage[{{api_gw_stage}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">71</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">72</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">73</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/over_exposed_vpc_peering/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{subnet1_1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{subnet1_1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code">resource "aws_subnet" "subnet1_1" {</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> vpc_id = aws_vpc.vpc1.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/cloudtrail_file_log_validation_disabled/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{foo}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[{{foo}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_rest_api[{{api_gw}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_api_gateway_rest_api[{{api_gw}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_api_gateway_rest_api" "api_gw" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> name = "api-gw-cache-non-encrypted"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 103</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{db}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{db}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">102</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">103</span><span class="code">resource "aws_security_group" "db" {</span></div><div class="code-line"><span class="code-line-counter">104</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_protocol_version_is_low/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{dist}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_s3_bucket[{{dist}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> Name = "dist-cloud-test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{nondefault}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc[{{nondefault}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_vpc" "nondefault" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cidr_block = "10.1.1.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/load_balancer_listener_http/main.tf</strong>
<span>Line 60</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lb[{{alb_test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_lb[{{alb_test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">59</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">60</span><span class="code">resource "aws_lb" "alb_test" {</span></div><div class="code-line"><span class="code-line-counter">61</span><span class="code"> subnets = [aws_subnet.subnet1.id, aws_subnet.subnet2.id]</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/iam-entities/public_and_private_ec2_same_role/main.tf</strong>
<span>Line 71</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_instance_profile[{{test_profile}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_instance_profile[{{test_profile}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">70</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">71</span><span class="code">resource "aws_iam_instance_profile" "test_profile" {</span></div><div class="code-line"><span class="code-line-counter">72</span><span class="code"> name = "test_profile"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 129</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{publicly_accessible_sg}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{publicly_accessible_sg}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">128</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">129</span><span class="code">resource "aws_security_group" "publicly_accessible_sg" {</span></div><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/ecs_task_definition_not_encrypted_in_transit/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_efs_file_system[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_efs_file_system[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_efs_file_system" "test" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> creation_token = "cloudrail-test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/over_exposed_vpc_peering/main.tf</strong>
<span>Line 40</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{subnet2_1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{subnet2_1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">39</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">40</span><span class="code">resource "aws_subnet" "subnet2_1" {</span></div><div class="code-line"><span class="code-line-counter">41</span><span class="code"> vpc_id = aws_vpc.vpc2.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/elasticsearch_encrypt_node_to_node_disabled/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_elasticsearch_domain[{{example}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_elasticsearch_domain[{{example}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_elasticsearch_domain" "example" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> domain_name = "cloudrail-non-enc-in-tran"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/dax_cluster_not_encrypted/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_dax_cluster[{{cloudrail-test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_dax_cluster[{{cloudrail-test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code">resource "aws_dax_cluster" "cloudrail-test" {</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> cluster_name = "non-encrypt"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 75</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_internet_gateway[{{igw}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_internet_gateway[{{igw}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">74</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">75</span><span class="code">resource "aws_internet_gateway" "igw" {</span></div><div class="code-line"><span class="code-line-counter">76</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 58</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_network_acl[{{redshift_eni2_nacl}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_network_acl[{{redshift_eni2_nacl}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">57</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">58</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">59</span><span class="code"> Name = "main"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/docdb_clusters_non_encrypted/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_docdb_cluster[{{docdb}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_docdb_cluster[{{docdb}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_docdb_cluster" "docdb" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> cluster_identifier = "my-docdb-cluster"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{nondefault}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc[{{nondefault}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_vpc" "nondefault" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> cidr_block = "10.1.1.0/24"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 68</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{nondefault_1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{nondefault_1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">67</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">68</span><span class="code">resource "aws_subnet" "nondefault_1" {</span></div><div class="code-line"><span class="code-line-counter">69</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/dax_cluster_not_encrypted/main.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_role[{{dax}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_role[{{dax}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code"># No policy attached to this role because it is for testing purposes</span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code">resource "aws_iam_role" "dax" {</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"> name = "dynamodb-dax-cloudrail-test"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/cloudtrail_not_encrypted/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{foo}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[{{foo}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_s3_bucket" "foo" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workgroups_non_encrypted/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_athena_workgroup[{{cloudrail_wg}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_athena_workgroup[{{cloudrail_wg}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_athena_workgroup" "cloudrail_wg" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> name = "cloudrail-wg-encrypted-sse-s3"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 32</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ami[{{example}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_ami[{{example}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">31</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">32</span><span class="code">resource "aws_ami" "example" {</span></div><div class="code-line"><span class="code-line-counter">33</span><span class="code"> name = "terraform-example"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 40</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_route_table[{{public-rtb}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_route_table[{{public-rtb}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">39</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">40</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">41</span><span class="code"> Name = "public-rtb"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 94</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc_endpoint[{{sqs-vpc-endpoint}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc_endpoint[{{sqs-vpc-endpoint}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">93</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">94</span><span class="code">resource "aws_vpc_endpoint" "sqs-vpc-endpoint" {</span></div><div class="code-line"><span class="code-line-counter">95</span><span class="code"> vpc_id = aws_vpc.main.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/secretsmanager_secrets_encrypted_at_rest_with_aws_managed_key_by_key_arn/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_secretsmanager_secret[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_secretsmanager_secret[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "aws_secretsmanager_secret" "test" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> name = "test-cloudrail-1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/cloudfront_distribution_not_encrypted/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[{{cdn-content}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[{{cdn-content}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_s3_bucket" "cdn-content" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> bucket = local.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/docdb_cluster_encrypted_at_rest_using_cmk_not_customer_managed/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_docdb_cluster[{{test2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_docdb_cluster[{{test2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "aws_docdb_cluster" "test2" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> cluster_identifier = "my-docdb-cluster-test2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/using_public_amis/main.tf</strong>
<span>Line 27</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ebs_snapshot[{{example_snapshot}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_ebs_snapshot[{{example_snapshot}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">26</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">27</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">28</span><span class="code"> Name = "HelloWorld_snap"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{public-subnet}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_subnet[{{public-subnet}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> Name = "public-subnet"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/workspace_root_volume_not_encrypted_at_rest/main.tf</strong>
<span>Line 47</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_workspaces_directory[{{test}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_workspaces_directory[{{test}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">46</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">47</span><span class="code">resource "aws_workspaces_directory" "test" {</span></div><div class="code-line"><span class="code-line-counter">48</span><span class="code"> directory_id = aws_directory_service_directory.test.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 93</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_network_acl[{{allow-public-outbound-nacl}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_network_acl[{{allow-public-outbound-nacl}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">92</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">93</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">94</span><span class="code"> Name = "allow-public-outbound-nacl"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 53</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{free_2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_subnet[{{free_2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">52</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">53</span><span class="code">resource "aws_subnet" "free_2" {</span></div><div class="code-line"><span class="code-line-counter">54</span><span class="code"> vpc_id = aws_vpc.external.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/at-rest/sagemaker_not_encrypted/main.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_sagemaker_notebook_instance[{{ni}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_sagemaker_notebook_instance[{{ni}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> Name = "foo"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_rules/main.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{vpc}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc[{{vpc}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code">resource "aws_vpc" "vpc" {</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> cidr_block = local.cidr_block</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/hcl_language_complexity/using_for_each/main.tf</strong>
<span>Line 4</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_iam_user[{{example}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_iam_user[{{example}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">3</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">4</span><span class="code">resource "aws_iam_user" "example" {</span></div><div class="code-line"><span class="code-line-counter">5</span><span class="code"> for_each = {</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/over_exposed_vpc_peering/main.tf</strong>
<span>Line 103</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc_peering_connection_accepter[{{peer_accepter}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc_peering_connection_accepter[{{peer_accepter}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">102</span><span class="code">######################################</span></div><div class="code-line error"><span class="code-line-counter">103</span><span class="code">resource "aws_vpc_peering_connection_accepter" "peer_accepter" {</span></div><div class="code-line"><span class="code-line-counter">104</span><span class="code"> provider = aws.peer</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 87</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{test-ec2-instance}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{test-ec2-instance}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">86</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">87</span><span class="code">resource "aws_instance" "test-ec2-instance" {</span></div><div class="code-line"><span class="code-line-counter">88</span><span class="code"> ami = data.aws_ami.ubuntu.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/rest_api_no_access_logging/main.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_api_gateway_stage[{{api_gw_stage}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_api_gateway_stage[{{api_gw_stage}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code">resource "aws_api_gateway_stage" "api_gw_stage" {</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> stage_name = "prod"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/config_aggregator_all_regions/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_config_configuration_aggregator[{{organization}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_config_configuration_aggregator[{{organization}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_config_configuration_aggregator" "organization" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"></span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> name = "example"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/lambda_without_xray/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lambda_function[{{test_lambda}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_lambda_function[{{test_lambda}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code">resource "aws_lambda_function" "test_lambda" {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> filename = "lambda_function_payload.zip"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/ecr_make_tags_immutable/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecr_repository[{{foo}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_ecr_repository[{{foo}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_ecr_repository" "foo" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "bar"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[{{public_ins}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_instance[{{public_ins}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code">// This instance is can potentially be used to hop into the DB</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code">resource "aws_instance" "public_ins" {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> ami = "ami-0130bec6e5047f596"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/logging/docdb_audit_logs_missing/main.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_docdb_cluster[{{docdb}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_docdb_cluster[{{docdb}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_docdb_cluster" "docdb" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = "my-docdb-cluster"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "docdb"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/over_exposed_vpc_peering/main.tf</strong>
<span>Line 35</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{vpc2}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc[{{vpc2}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">34</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">35</span><span class="code">resource "aws_vpc" "vpc2" {</span></div><div class="code-line"><span class="code-line-counter">36</span><span class="code"> cidr_block = "10.7.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 121</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{publicly_accessible_sg}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{publicly_accessible_sg}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">120</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">121</span><span class="code">resource "aws_security_group" "publicly_accessible_sg" {</span></div><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/lambda_not_secure_policy/main.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lambda_function[{{my-lambda}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_lambda_function[{{my-lambda}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">resource "aws_lambda_function" "my-lambda" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> filename = "~/Downloads/lambda.json.zip"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/over_exposed_vpc_peering/main.tf</strong>
<span>Line 20</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[{{vpc1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_vpc[{{vpc1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">19</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">20</span><span class="code">resource "aws_vpc" "vpc1" {</span></div><div class="code-line"><span class="code-line-counter">21</span><span class="code"> cidr_block = "10.5.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 79</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_route_table[{{nondefault_1}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_route_table[{{nondefault_1}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">78</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">79</span><span class="code">resource aws_route_table "nondefault_1" {</span></div><div class="code-line"><span class="code-line-counter">80</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/iam/resource-policies/glue_data_catalog_not_secure_policy/main.tf</strong>
<span>Line 38</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_glue_crawler[{{cloudrail_table_crawler}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_glue_crawler[{{cloudrail_table_crawler}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">37</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">38</span><span class="code">resource "aws_glue_crawler" "cloudrail_table_crawler" {</span></div><div class="code-line"><span class="code-line-counter">39</span><span class="code"> database_name = aws_glue_catalog_database.cloudrail_table_database.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 39</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lb[{{disabled}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_lb[{{disabled}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">38</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">39</span><span class="code">resource "aws_lb" "disabled" {</span></div><div class="code-line"><span class="code-line-counter">40</span><span class="code"> internal = false</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 63</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_network_acl[{{redshift_eni2_nacl}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_network_acl[{{redshift_eni2_nacl}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">62</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">63</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">64</span><span class="code"> Name = "main"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/alb_drop_http_headers/main.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lb[{{default}}].tags is defined and not null</span>
<span><strong>Found:</strong> aws_lb[{{default}}].tags is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code">resource "aws_lb" "default" {</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> internal = false</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 36</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_network_acl[{{ec2_nacl}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_network_acl[{{ec2_nacl}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">35</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">36</span><span class="code"> tags = {</span></div><div class="code-line"><span class="code-line-counter">37</span><span class="code"> Name = "main"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">SQL Server Alert Email Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">SQL Server alert email should be enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#email_account_admins" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#email_account_admins</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/azure/best-practices/sql_vulnerability_email_not_set/main.tf</strong>
<span>Line 38</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mssql_server_security_alert_policy[example].email_account_admins' is defined</span>
<span><strong>Found:</strong> 'azurerm_mssql_server_security_alert_policy[example].email_account_admins' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">37</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">38</span><span class="code">resource "azurerm_mssql_server_security_alert_policy" "example" {</span></div><div class="code-line"><span class="code-line-counter">39</span><span class="code"> resource_group_name = azurerm_resource_group.rg.name</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">Security Group Not Used</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Security group must be used or not declared</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_unused/main.tf</strong>
<span>Line 7</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_security_group[allow_tls]' is used</span>
<span><strong>Found:</strong> 'aws_security_group[allow_tls]' is not used</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">6</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">7</span><span class="code">resource "aws_security_group" "allow_tls" {</span></div><div class="code-line"><span class="code-line-counter">8</span><span class="code"> name = "allow_tls"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 92</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_security_group[esdomain]' is used</span>
<span><strong>Found:</strong> 'aws_security_group[esdomain]' is not used</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">91</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">92</span><span class="code">resource "aws_security_group" "esdomain" {</span></div><div class="code-line"><span class="code-line-counter">93</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">Security Group Rules Without Description</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">It's considered a best practice for all rules in AWS Security Group to have a description</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group#description" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group#description</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">17</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 94</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{esdomain}}].ingress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{esdomain}}].ingress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">93</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">94</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">95</span><span class="code"> from_port = 443</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 131</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{publicly_accessible_sg}}].ingress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{publicly_accessible_sg}}].ingress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">131</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">132</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_unused/main.tf</strong>
<span>Line 20</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{allow_tls}}].egress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{allow_tls}}].egress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">19</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">20</span><span class="code"> egress {</span></div><div class="code-line"><span class="code-line-counter">21</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 137</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{publicly_accessible_sg}}].egress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{publicly_accessible_sg}}].egress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">136</span><span class="code"> }</span></div><div class="code-line error"><span class="code-line-counter">137</span><span class="code"> egress {</span></div><div class="code-line"><span class="code-line-counter">138</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{publicly_accessible_sg}}].ingress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{publicly_accessible_sg}}].ingress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 62</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{public-internet-sg}}].ingress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{public-internet-sg}}].ingress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">61</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">62</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">63</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_rules/main.tf</strong>
<span>Line 19</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{default}}].ingress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{default}}].ingress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">18</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">19</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">20</span><span class="code"> from_port = 443</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 105</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{db}}].ingress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{db}}].ingress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">104</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">105</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">106</span><span class="code"> from_port = 3306</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_rules/main.tf</strong>
<span>Line 26</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{default}}].egress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{default}}].egress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">25</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">26</span><span class="code"> egress {</span></div><div class="code-line"><span class="code-line-counter">27</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/encryption/in-transit/vpc_has_only_dynamodb_vpce_gw_connection/main.tf</strong>
<span>Line 103</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{allow-public-outbound-sg}}].egress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{allow-public-outbound-sg}}].egress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">102</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">103</span><span class="code"> egress {</span></div><div class="code-line"><span class="code-line-counter">104</span><span class="code"> from_port = 443</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/dynamodb-vpce-exist-without-routeassociation/main.tf</strong>
<span>Line 58</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{allow-public-outbound-sg}}].egress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{allow-public-outbound-sg}}].egress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">57</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">58</span><span class="code"> egress {</span></div><div class="code-line"><span class="code-line-counter">59</span><span class="code"> from_port = 443</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/vpc-endpoints/sqs-vpc-endpoint-without-dns-resolution/main.tf</strong>
<span>Line 55</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{public-internet-sg}}].egress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{public-internet-sg}}].egress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">54</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">55</span><span class="code"> egress {</span></div><div class="code-line"><span class="code-line-counter">56</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{free}}].ingress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{free}}].ingress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 129</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{publicly_accessible_sg}}].egress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{publicly_accessible_sg}}].egress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">128</span><span class="code"> }</span></div><div class="code-line error"><span class="code-line-counter">129</span><span class="code"> egress {</span></div><div class="code-line"><span class="code-line-counter">130</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 123</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{publicly_accessible_sg}}].ingress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{publicly_accessible_sg}}].ingress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div><div class="code-line error"><span class="code-line-counter">123</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">124</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{nondefault}}].ingress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{nondefault}}].ingress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> from_port = 0</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 122</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{publicly_accessible_sg}}].egress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{publicly_accessible_sg}}].egress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">121</span><span class="code"> }</span></div><div class="code-line error"><span class="code-line-counter">122</span><span class="code"> egress {</span></div><div class="code-line"><span class="code-line-counter">123</span><span class="code"> from_port = 0</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">Security Group Without Description</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">It's considered a best practice for AWS Security Group to have a description</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group#description" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group#description</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">9</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 92</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{esdomain}}] description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{esdomain}}] description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">91</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">92</span><span class="code">resource "aws_security_group" "esdomain" {</span></div><div class="code-line"><span class="code-line-counter">93</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_rules/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{default}}] description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{default}}] description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "aws_security_group" "default" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "examplerulename"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_domain/main.tf</strong>
<span>Line 121</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{publicly_accessible_sg}}] description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{publicly_accessible_sg}}] description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">120</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">121</span><span class="code">resource "aws_security_group" "publicly_accessible_sg" {</span></div><div class="code-line"><span class="code-line-counter">122</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/publicly_accessible_neptune_db/main.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{free}}] description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{free}}] description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code">resource "aws_security_group" "free" {</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> vpc_id = aws_vpc.external.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 129</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{publicly_accessible_sg}}] description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{publicly_accessible_sg}}] description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">128</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">129</span><span class="code">resource "aws_security_group" "publicly_accessible_sg" {</span></div><div class="code-line"><span class="code-line-counter">130</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/best-practices/security_group_no_description_for_security_group/main.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{default}}] description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{default}}] description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">resource "aws_security_group" "default" {</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> name = "examplerulename"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_redshift/main.tf</strong>
<span>Line 114</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{publicly_accessible_sg}}] description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{publicly_accessible_sg}}] description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">113</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">114</span><span class="code">resource "aws_security_group" "publicly_accessible_sg" {</span></div><div class="code-line"><span class="code-line-counter">115</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/rds-vpc-controlled-public/main.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{nondefault}}] description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{nondefault}}] description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "aws_security_group" "nondefault" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/aws/networking/public_ec2_points_to_private_rds/main.tf</strong>
<span>Line 103</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{db}}] description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{db}}] description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">102</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">103</span><span class="code">resource "aws_security_group" "db" {</span></div><div class="code-line"><span class="code-line-counter">104</span><span class="code"> vpc_id = aws_vpc.nondefault.id</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">Variable Without Description</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">All variables should contain a valid description.</span><span><a href="https://www.terraform.io/docs/language/values/variables.html#input-variable-documentation" rel="noopener" target="_blank">https://www.terraform.io/docs/language/values/variables.html#input-variable-documentation</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/hcl_language_complexity/using_module_multi/mymodule/user.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'description' is defined and not null</span>
<span><strong>Found:</strong> 'description' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">variable "pgp_key" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> type = string</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/hcl_language_complexity/using_module_multi/mymodule/user.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'description' is defined and not null</span>
<span><strong>Found:</strong> 'description' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">variable "allow_password" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> type = bool</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code">}</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: test-cases/terraform/hcl_language_complexity/using_module_multi/mymodule/user.tf</strong>
<span>Line 5</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'description' is defined and not null</span>
<span><strong>Found:</strong> 'description' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">5</span><span class="code">variable "user_name" {</span></div><div class="code-line"><span class="code-line-counter">6</span><span class="code"> type = string</span></div></div></div></details></div></div><hr class="separator"><div class="kics-message">KICS is open and will always stay such. Both the scanning engine and the security queries are clear and open for the software development community.</div><div class="love">Spread the love:</div><div class="social-networks"><a href="https://github.com/Checkmarx/kics/" rel="noopener" target="_blank"><div><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
    <g fill="none" fill-rule="evenodd">
        <g fill="#626264" fill-rule="nonzero">
            <g>
                <g>
                    <path d="M13.172 19.5c2-.688 3.633-1.898 4.898-3.633 1.266-1.734 1.899-3.695 1.899-5.883 0-1.312-.25-2.586-.75-3.82S18 3.844 17.062 2.906C16.125 1.97 15.04 1.25 13.806.75 12.57.25 11.297 0 9.985 0c-1.313 0-2.587.25-3.82.75-1.235.5-2.321 1.219-3.259 2.156C1.97 3.844 1.25 4.93.75 6.164.25 7.398 0 8.672 0 9.984c0 2.188.633 4.149 1.898 5.883 1.266 1.735 2.915 2.945 4.946 3.633.218.031.383-.008.492-.117.11-.11.164-.242.164-.399v-1.687c-1.156.25-2.063.094-2.719-.469-.294-.214-.497-.463-.608-.746l-.048-.145c-.125-.343-.297-.64-.516-.89-.125-.188-.265-.328-.421-.422L3 14.485c-.25-.188-.375-.329-.375-.422 0-.094.078-.141.234-.141l.235-.047c.406.031.781.219 1.125.563.15.124.26.25.33.374l.045.094c.406.656.937 1.016 1.593 1.078.407.032.86-.046 1.36-.234.062-.594.266-1.047.61-1.36-1.376-.156-2.407-.53-3.095-1.124-.968-.813-1.453-2.079-1.453-3.797 0-1.031.344-1.922 1.032-2.672-.125-.281-.188-.594-.188-.938-.062-.562.031-1.14.281-1.734h.282c.25 0 .546.063.89.188.5.187 1.032.468 1.594.843.781-.218 1.61-.328 2.484-.328.875 0 1.704.11 2.485.328.812-.531 1.515-.86 2.11-.984.26-.052.455-.072.585-.059l.07.012c.25.594.344 1.172.282 1.734 0 .344-.063.657-.188.938.688.75 1.031 1.64 1.031 2.672 0 1.75-.484 3.015-1.453 3.797-.719.593-1.75.968-3.094 1.125.438.406.657 1.03.657 1.875v2.718c0 .157.054.29.164.399.11.11.289.148.539.117z" transform="translate(-358 -1497) translate(0 1332) translate(358 165)"/>
                </g>
            </g>
        </g>
    </g>
</svg></div></a></div><div class="report-header-footer"><span class="footer-text">The KICS project is powered by&nbsp;<a href="https://www.checkmarx.com/" class="checkmarx" rel="noopener" target="_blank">Checkmarx</a>, global leader of Application Security Testing</span></div></div></body></html>